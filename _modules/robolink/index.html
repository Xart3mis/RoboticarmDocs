<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>robolink &mdash; Roboticarm  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../" class="icon icon-home"> Roboticarm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/">main module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/">modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Roboticarm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../">Module code</a> &raquo;</li>
      <li>robolink</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for robolink</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2015-2020 - RoboDK Inc. - https://robodk.com/</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1"># http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------</span>
<span class="c1"># --------------- DESCRIPTION ----------------</span>
<span class="c1"># This file defines the following two classes:</span>
<span class="c1">#     Robolink()</span>
<span class="c1">#     Item()</span>
<span class="c1"># These classes are the objects used to interact with RoboDK and create macros.</span>
<span class="c1"># An item is an object in the RoboDK tree (it can be either a robot, an object, a tool, a frame, a program, ...).</span>
<span class="c1"># Items can be retrieved from the RoboDK station using the Robolink() object (such as Robolink.Item() method)</span>
<span class="c1">#</span>
<span class="c1"># In this document: pose = transformation matrix = homogeneous matrix = 4x4 matrix</span>
<span class="c1">#</span>
<span class="c1"># More information about the RoboDK API for Python here:</span>
<span class="c1">#     https://robodk.com/doc/en/RoboDK-API.html</span>
<span class="c1">#     https://robodk.com/doc/en/PythonAPI/index.html</span>
<span class="c1">#</span>
<span class="c1"># More information about RoboDK post processors here:</span>
<span class="c1">#     https://robodk.com/help#PostProcessor</span>
<span class="c1">#</span>
<span class="c1"># Visit the Matrix and Quaternions FAQ for more information about pose/homogeneous transformations</span>
<span class="c1">#     http://www.j3d.org/matrix_faq/matrfaq_latest.html</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------</span>


<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">robodk</span> <span class="k">as</span> <span class="nn">robodk</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">sys</span>  <span class="c1"># Only used to detect python version using sys.version_info</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="c1"># Tree item types</span>
<span class="n">ITEM_TYPE_STATION</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ITEM_TYPE_ROBOT</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ITEM_TYPE_FRAME</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ITEM_TYPE_TOOL</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ITEM_TYPE_OBJECT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ITEM_TYPE_TARGET</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ITEM_TYPE_PROGRAM</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">ITEM_TYPE_INSTRUCTION</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">ITEM_TYPE_PROGRAM_PYTHON</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ITEM_TYPE_MACHINING</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">ITEM_TYPE_BALLBARVALIDATION</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">ITEM_TYPE_CALIBPROJECT</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">ITEM_TYPE_VALID_ISO9283</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">ITEM_TYPE_FOLDER</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">ITEM_TYPE_ROBOT_ARM</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">ITEM_TYPE_CAMERA</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">ITEM_TYPE_GENERIC</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ITEM_TYPE_ROBOT_AXES</span> <span class="o">=</span> <span class="mi">21</span>

<span class="c1"># Instruction types</span>
<span class="n">INS_TYPE_INVALID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">INS_TYPE_MOVE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">INS_TYPE_MOVEC</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">INS_TYPE_CHANGESPEED</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">INS_TYPE_CHANGEFRAME</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">INS_TYPE_CHANGETOOL</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">INS_TYPE_CHANGEROBOT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">INS_TYPE_PAUSE</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">INS_TYPE_EVENT</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">INS_TYPE_CODE</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">INS_TYPE_PRINT</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Move types</span>
<span class="n">MOVE_TYPE_INVALID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">MOVE_TYPE_JOINT</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MOVE_TYPE_LINEAR</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MOVE_TYPE_CIRCULAR</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">MOVE_TYPE_LINEARSEARCH</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Such as ABB&#39;s SearchL function</span>


<span class="c1"># Station parameters request</span>
<span class="n">PATH_OPENSTATION</span> <span class="o">=</span> <span class="s2">&quot;PATH_OPENSTATION&quot;</span>
<span class="n">FILE_OPENSTATION</span> <span class="o">=</span> <span class="s2">&quot;FILE_OPENSTATION&quot;</span>
<span class="n">PATH_DESKTOP</span> <span class="o">=</span> <span class="s2">&quot;PATH_DESKTOP&quot;</span>

<span class="c1"># Script execution types</span>
<span class="c1"># performs the simulation moving the robot (default)</span>
<span class="n">RUNMODE_SIMULATE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># performs a quick check to validate the robot movements</span>
<span class="n">RUNMODE_QUICKVALIDATE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">RUNMODE_MAKE_ROBOTPROG</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># makes the robot program</span>
<span class="c1"># makes the robot program and updates it to the robot</span>
<span class="n">RUNMODE_MAKE_ROBOTPROG_AND_UPLOAD</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># makes the robot program and starts it on the robot (independently from the PC)</span>
<span class="n">RUNMODE_MAKE_ROBOTPROG_AND_START</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># moves the real robot from the PC (PC is the client, the robot behaves like a server)</span>
<span class="n">RUNMODE_RUN_ROBOT</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Program execution type</span>
<span class="n">PROGRAM_RUN_ON_SIMULATOR</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Set the program to run on the simulator</span>
<span class="n">PROGRAM_RUN_ON_ROBOT</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Set the program to run on the robot</span>

<span class="c1"># Robot connection status</span>
<span class="n">ROBOTCOM_PROBLEMS</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">ROBOTCOM_DISCONNECTED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">ROBOTCOM_NOT_CONNECTED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ROBOTCOM_READY</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ROBOTCOM_WORKING</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ROBOTCOM_WAITING</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ROBOTCOM_UNKNOWN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>

<span class="c1"># TCP calibration methods</span>
<span class="n">CALIBRATE_TCP_BY_POINT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CALIBRATE_TCP_BY_PLANE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CALIBRATE_TCP_BY_PLANE_SCARA</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Reference frame calibration methods</span>
<span class="c1"># Calibrate by 3 points: [X, X+, Y+] (p1 on X axis)</span>
<span class="n">CALIBRATE_FRAME_3P_P1_ON_X</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Calibrate by 3 points: [Origin, X+, XY+] (p1 is origin)</span>
<span class="n">CALIBRATE_FRAME_3P_P1_ORIGIN</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CALIBRATE_FRAME_6P</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Calibrate by 6 points</span>
<span class="n">CALIBRATE_TURNTABLE</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Calibrate turntable</span>
<span class="n">CALIBRATE_TURNTABLE_2X</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Calibrate a 2 axis turntable</span>


<span class="c1"># projection types (for AddCurve)</span>
<span class="n">PROJECTION_NONE</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># No curve projection</span>
<span class="n">PROJECTION_CLOSEST</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># The projection will be the closest point on the surface</span>
<span class="n">PROJECTION_ALONG_NORMAL</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># The projection will be done along the normal.</span>
<span class="c1"># The projection will be done along the normal. Furthermore, the normal will be recalculated according to the surface normal.</span>
<span class="n">PROJECTION_ALONG_NORMAL_RECALC</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># The projection will be the closest point on the surface and the normals will be recalculated</span>
<span class="n">PROJECTION_CLOSEST_RECALC</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># The normals are recalculated according to the surface normal of the closest projection. The points are not changed.</span>
<span class="n">PROJECTION_RECALC</span> <span class="o">=</span> <span class="mi">5</span>


<span class="c1"># Euler type</span>
<span class="n">JOINT_FORMAT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Using joints (not poses)</span>
<span class="n">EULER_RX_RYp_RZpp</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># generic</span>
<span class="n">EULER_RZ_RYp_RXpp</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># ABB RobotStudio</span>
<span class="n">EULER_RZ_RYp_RZpp</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Kawasaki, Adept, Staubli</span>
<span class="n">EULER_RZ_RXp_RZpp</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># CATIA, SolidWorks</span>
<span class="n">EULER_RX_RY_RZ</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Fanuc, Kuka, Motoman, Nachi</span>
<span class="n">EULER_RZ_RY_RX</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># CRS</span>
<span class="n">EULER_QUEATERNION</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># ABB Rapid</span>

<span class="c1"># State of the RoboDK window</span>
<span class="n">WINDOWSTATE_HIDDEN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">WINDOWSTATE_SHOW</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">WINDOWSTATE_MINIMIZED</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">WINDOWSTATE_NORMAL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">WINDOWSTATE_MAXIMIZED</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">WINDOWSTATE_FULLSCREEN</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">WINDOWSTATE_CINEMA</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">WINDOWSTATE_FULLSCREEN_CINEMA</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">WINDOWSTATE_VIDEO</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Instruction program call type:</span>
<span class="n">INSTRUCTION_CALL_PROGRAM</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">INSTRUCTION_INSERT_CODE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">INSTRUCTION_START_THREAD</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">INSTRUCTION_COMMENT</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">INSTRUCTION_SHOW_MESSAGE</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Object selection features</span>
<span class="n">FEATURE_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FEATURE_SURFACE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FEATURE_CURVE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">FEATURE_POINT</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">FEATURE_SURFACE_PREVIEW</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">FEATURE_MESH</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Spray gun simulation:</span>
<span class="n">SPRAY_OFF</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SPRAY_ON</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Collision checking state</span>
<span class="n">COLLISION_OFF</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">COLLISION_ON</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># RoboDK Window Flags</span>
<span class="n">FLAG_ROBODK_TREE_ACTIVE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FLAG_ROBODK_3DVIEW_ACTIVE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">FLAG_ROBODK_LEFT_CLICK</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">FLAG_ROBODK_RIGHT_CLICK</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">FLAG_ROBODK_DOUBLE_CLICK</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">FLAG_ROBODK_MENU_ACTIVE</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">FLAG_ROBODK_MENUFILE_ACTIVE</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">FLAG_ROBODK_MENUEDIT_ACTIVE</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">FLAG_ROBODK_MENUPROGRAM_ACTIVE</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">FLAG_ROBODK_MENUTOOLS_ACTIVE</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">FLAG_ROBODK_MENUUTILITIES_ACTIVE</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">FLAG_ROBODK_MENUCONNECT_ACTIVE</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">FLAG_ROBODK_WINDOWKEYS_ACTIVE</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">FLAG_ROBODK_TREE_VISIBLE</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="n">FLAG_ROBODK_REFERENCES_VISIBLE</span> <span class="o">=</span> <span class="mi">16384</span>
<span class="n">FLAG_ROBODK_STATUSBAR_VISIBLE</span> <span class="o">=</span> <span class="mi">32768</span>
<span class="n">FLAG_ROBODK_NONE</span> <span class="o">=</span> <span class="mh">0x00</span>
<span class="n">FLAG_ROBODK_ALL</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
<span class="n">FLAG_ROBODK_MENU_ACTIVE_ALL</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">FLAG_ROBODK_MENU_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUFILE_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUEDIT_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUPROGRAM_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUTOOLS_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUUTILITIES_ACTIVE</span>
    <span class="o">|</span> <span class="n">FLAG_ROBODK_MENUCONNECT_ACTIVE</span>
<span class="p">)</span>

<span class="c1"># RoboDK Item Flags</span>
<span class="n">FLAG_ITEM_SELECTABLE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FLAG_ITEM_EDITABLE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">FLAG_ITEM_DRAGALLOWED</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">FLAG_ITEM_DROPALLOWED</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">FLAG_ITEM_ENABLED</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">FLAG_ITEM_AUTOTRISTATE</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">FLAG_ITEM_NOCHILDREN</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">FLAG_ITEM_USERTRISTATE</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">FLAG_ITEM_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FLAG_ITEM_ALL</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Robot types</span>
<span class="n">MAKE_ROBOT_1R</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MAKE_ROBOT_2R</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MAKE_ROBOT_3R</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">MAKE_ROBOT_1T</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">MAKE_ROBOT_2T</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">MAKE_ROBOT_3T</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">MAKE_ROBOT_6DOF</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">MAKE_ROBOT_7DOF</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">MAKE_ROBOT_SCARA</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># Path Error bit mask</span>
<span class="n">ERROR_KINEMATIC</span> <span class="o">=</span> <span class="mb">0b001</span>  <span class="c1"># One or more points is not reachable</span>
<span class="n">ERROR_PATH_LIMIT</span> <span class="o">=</span> <span class="mb">0b010</span>  <span class="c1"># The path reaches the limit of joint axes</span>
<span class="n">ERROR_PATH_SINGULARITY</span> <span class="o">=</span> <span class="mb">0b100</span>  <span class="c1"># The robot reached a singularity point</span>
<span class="c1"># The robot is too close to a singularity. Lower the singularity tolerance to allow the robot to continue.</span>
<span class="n">ERROR_PATH_NEARSINGULARITY</span> <span class="o">=</span> <span class="mb">0b1000</span>
<span class="n">ERROR_COLLISION</span> <span class="o">=</span> <span class="mb">0b100000</span>  <span class="c1"># Collision detected</span>

<span class="c1"># Interactive selection option (for 3D mouse behavior and setInteractiveMode)</span>
<span class="n">SELECT_RESET</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SELECT_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SELECT_RECTANGLE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">SELECT_ROTATE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">SELECT_ZOOM</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">SELECT_PAN</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">SELECT_MOVE</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">SELECT_MOVE_SHIFT</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">SELECT_MOVE_CLEAR</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Bit masks to show specific reference frames and customize the display of references (for picking references with the 3D mouse and setInteractiveMode)</span>
<span class="n">DISPLAY_REF_DEFAULT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">DISPLAY_REF_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">DISPLAY_REF_TX</span> <span class="o">=</span> <span class="mb">0b001</span>
<span class="n">DISPLAY_REF_TY</span> <span class="o">=</span> <span class="mb">0b010</span>
<span class="n">DISPLAY_REF_TZ</span> <span class="o">=</span> <span class="mb">0b100</span>
<span class="n">DISPLAY_REF_RX</span> <span class="o">=</span> <span class="mb">0b001000</span>
<span class="n">DISPLAY_REF_RY</span> <span class="o">=</span> <span class="mb">0b010000</span>
<span class="n">DISPLAY_REF_RZ</span> <span class="o">=</span> <span class="mb">0b100000</span>
<span class="n">DISPLAY_REF_PXY</span> <span class="o">=</span> <span class="mb">0b001000000</span>
<span class="n">DISPLAY_REF_PXZ</span> <span class="o">=</span> <span class="mb">0b010000000</span>
<span class="n">DISPLAY_REF_PYZ</span> <span class="o">=</span> <span class="mb">0b100000000</span>


<span class="n">VISIBLE_REFERENCE_DEFAULT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">VISIBLE_REFERENCE_ON</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">VISIBLE_REFERENCE_OFF</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">VISIBLE_ROBOT_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">VISIBLE_ROBOT_FLANGE</span> <span class="o">=</span> <span class="mh">0x01</span>
<span class="n">VISIBLE_ROBOT_AXIS_Base_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
<span class="n">VISIBLE_ROBOT_AXIS_Base_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span>
<span class="n">VISIBLE_ROBOT_AXIS_1_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span>
<span class="n">VISIBLE_ROBOT_AXIS_1_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span>
<span class="n">VISIBLE_ROBOT_AXIS_2_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>
<span class="n">VISIBLE_ROBOT_AXIS_2_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span>
<span class="n">VISIBLE_ROBOT_AXIS_3_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span>
<span class="n">VISIBLE_ROBOT_AXIS_3_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span>
<span class="n">VISIBLE_ROBOT_AXIS_4_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">9</span>
<span class="n">VISIBLE_ROBOT_AXIS_4_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span>
<span class="n">VISIBLE_ROBOT_AXIS_5_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span>
<span class="n">VISIBLE_ROBOT_AXIS_5_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span>
<span class="n">VISIBLE_ROBOT_AXIS_6_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span>
<span class="n">VISIBLE_ROBOT_AXIS_6_REF</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span>
<span class="n">VISIBLE_ROBOT_AXIS_7_3D</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span>
<span class="n">VISIBLE_ROBOT_AXIS_7_REF</span> <span class="o">=</span> <span class="mh">0x02</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>
<span class="n">VISIBLE_ROBOT_DEFAULT</span> <span class="o">=</span> <span class="mh">0x2AAAAAAB</span>
<span class="n">VISIBLE_ROBOT_ALL</span> <span class="o">=</span> <span class="mh">0x7FFFFFFF</span>
<span class="n">VISIBLE_ROBOT_ALL_REFS</span> <span class="o">=</span> <span class="mh">0x15555555</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">minor</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">:</span>
    <span class="c1"># To be added in the future. Requires Python 3.6 or later</span>
    <span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">IntFlag</span>
    <span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">IntEnum</span>

<div class="viewcode-block" id="InstructionListJointsFlags"><a class="viewcode-back" href="../../robolink/#robolink.InstructionListJointsFlags">[docs]</a>    <span class="k">class</span> <span class="nc">InstructionListJointsFlags</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;InstructionListJoints output flag&quot;&quot;&quot;</span>

        <span class="n">Position</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Speed</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">SpeedAndAcceleration</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">TimeBased</span> <span class="o">=</span> <span class="mi">4</span></div>

<div class="viewcode-block" id="PathErrorFlags"><a class="viewcode-back" href="../../robolink/#robolink.PathErrorFlags">[docs]</a>    <span class="k">class</span> <span class="nc">PathErrorFlags</span><span class="p">(</span><span class="n">IntFlag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Error flags returned by InstructionListJoints&quot;&quot;&quot;</span>

        <span class="c1"># none of the flags is set -&gt; No Error</span>
        <span class="n">NoError</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># One or more points is not reachable</span>
        <span class="n">Kinematic</span> <span class="o">=</span> <span class="mh">0x1</span>  <span class="c1"># 0b0000_0000_0001</span>

        <span class="c1"># The robot reaches the limit of joint axes trying to make a linear movement between 2 valid points</span>
        <span class="n">PathLimit</span> <span class="o">=</span> <span class="mh">0x2</span>  <span class="c1"># 0b0000_0000_0010</span>

        <span class="c1"># Error code reporting is innacurate due to large axis move. Reduce the time step or the robot speed</span>
        <span class="c1"># This error flag is never combined with other error flags.</span>
        <span class="c1"># This flag will appear with time based simulations and it means the path is feasible but RoboDK is unable to calculate it with the current time step</span>
        <span class="n">InnacurateDueToLargeAxisMove</span> <span class="o">=</span> <span class="mh">0x800</span>  <span class="c1"># error code 20</span>

        <span class="c1"># The robot reached a singularity point</span>
        <span class="n">PathSingularity</span> <span class="o">=</span> <span class="mh">0x4</span>  <span class="c1"># 0b0000_0000_0100</span>

        <span class="c1"># The robot is close to a singularity.</span>
        <span class="c1"># Lower the singularity tolerance to allow the robot to continue.</span>
        <span class="c1"># If you get this error flag it means you may be able to go through the singularity if you lower the tolerances in Tools-Options-Motion</span>
        <span class="n">PathNearSingularity</span> <span class="o">=</span> <span class="mh">0x8</span>  <span class="c1"># 0b0000_0000_1000</span>

        <span class="c1"># A movement can&#39;t involve an exact rotation of 180 deg around a unique axis. The rotation is ambiguous and has infinite solutions.</span>
        <span class="n">PathFlipAxis</span> <span class="o">=</span> <span class="mh">0x10</span>  <span class="c1"># 0b0000_0001_0000</span>

        <span class="c1"># Collision detected</span>
        <span class="n">Collision</span> <span class="o">=</span> <span class="mh">0x20</span>  <span class="c1"># 0b0000_0010_0000</span>

        <span class="c1"># The robot reached a Wrist singularity: Joint 5 is too close to 0 deg</span>
        <span class="n">WristSingularity</span> <span class="o">=</span> <span class="mh">0x40</span>  <span class="c1"># 0b0000_0100_0000</span>

        <span class="c1"># The robot reached an Elbow singularity: Joint 3 is fully extended</span>
        <span class="n">ElbowSingularity</span> <span class="o">=</span> <span class="mh">0x80</span>  <span class="c1"># 0b0000_1000_0000</span>

        <span class="c1"># The robot reached a Shoulder singularity: the wrist is too close to axis 1</span>
        <span class="n">ShoulderSingularity</span> <span class="o">=</span> <span class="mh">0x100</span>  <span class="c1"># 0b0001_0000_0000</span>

        <span class="c1"># Target not reachable or invalid</span>
        <span class="n">PathInvalidTarget</span> <span class="o">=</span> <span class="mh">0x200</span>  <span class="c1"># 0b0010_0000_0000</span>

        <span class="c1"># A circular movement is not valid because it does not define an arc. Make sure to properly separate all points and make sure they are not along one line.</span>
        <span class="n">InvalidArcMove</span> <span class="o">=</span> <span class="mh">0x400</span>  <span class="c1"># 0b00100_0000_0000</span></div>

<div class="viewcode-block" id="ConvertErrorCodeToJointErrorType"><a class="viewcode-back" href="../../robolink/#robolink.ConvertErrorCodeToJointErrorType">[docs]</a>    <span class="k">def</span> <span class="nf">ConvertErrorCodeToJointErrorType</span><span class="p">(</span><span class="n">evalue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert error number returned by InstructionListJoints() to PathErrorFlags&quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">NoError</span>
        <span class="n">evalue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">evalue</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">evalue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">flags</span>

        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">evalue</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="c1"># This error flag is never combined with other error flags.</span>
            <span class="c1"># This flag will appear with time based simulations and it means the path is feasible but RoboDK is unable to calculate</span>
            <span class="k">return</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">InnacurateDueToLargeAxisMove</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">1000000000</span> <span class="o">&gt;</span> <span class="mi">99999999</span><span class="p">:</span>
            <span class="c1"># Non reachable target</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">InvalidArcMove</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">100000000</span> <span class="o">&gt;</span> <span class="mi">9999999</span><span class="p">:</span>
            <span class="c1"># Non reachable target</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathInvalidTarget</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">10000000</span> <span class="o">&gt;</span> <span class="mi">999999</span><span class="p">:</span>
            <span class="c1"># &quot;The robot can&#39;t make a rotation so close to 180 deg. (the rotation axis is not properly defined</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathFlipAxis</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">1000000</span> <span class="o">&gt;</span> <span class="mi">99999</span><span class="p">:</span>
            <span class="c1"># Collision detected.</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">Collision</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">:</span>
            <span class="c1"># Joint 5 crosses 0 degrees. This is a singularity and it is not allowed for a linear move.</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">WristSingularity</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathSingularity</span>

        <span class="k">elif</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">&gt;</span> <span class="mi">3999</span><span class="p">:</span>
                <span class="c1"># The robot is too close to the front/back singularity (wrist close to axis 1).</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">ShoulderSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathNearSingularity</span>

            <span class="k">elif</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">&gt;</span> <span class="mi">1999</span><span class="p">:</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">ElbowSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathNearSingularity</span>
                <span class="c1"># Joint 3 is too close the elbow singularity.</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Joint 5 is too close to a singularity (0 degrees).</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">WristSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathSingularity</span>
                <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathNearSingularity</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># There is no solution available to complete the path.</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">PathLimit</span>

        <span class="k">if</span> <span class="n">evalue</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
            <span class="c1"># The robot can&#39;t make a linear movement because of joint limits or the target is out of reach. Consider a Joint move instead.</span>
            <span class="c1"># flags |= PathErrorFlags.PathLimit</span>
            <span class="n">flags</span> <span class="o">|=</span> <span class="n">PathErrorFlags</span><span class="o">.</span><span class="n">Kinematic</span>

        <span class="k">return</span> <span class="n">flags</span></div>


<div class="viewcode-block" id="TargetReachError"><a class="viewcode-back" href="../../robolink/#robolink.TargetReachError">[docs]</a><span class="k">class</span> <span class="nc">TargetReachError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unable to reach desired target or destination error.&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="StoppedError"><a class="viewcode-back" href="../../robolink/#robolink.StoppedError">[docs]</a><span class="k">class</span> <span class="nc">StoppedError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The user stopped the operation by selecting Escape key or moving the robot&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="InputError"><a class="viewcode-back" href="../../robolink/#robolink.InputError">[docs]</a><span class="k">class</span> <span class="nc">InputError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Invalid input parameters provided to the API. Provide input as stated in the documentation.&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="LicenseError"><a class="viewcode-back" href="../../robolink/#robolink.LicenseError">[docs]</a><span class="k">class</span> <span class="nc">LicenseError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Invalid RoboDK license to use the requested feature.&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="RoboDKInstallFound"><a class="viewcode-back" href="../../robolink/#robolink.RoboDKInstallFound">[docs]</a><span class="k">def</span> <span class="nf">RoboDKInstallFound</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Check if RoboDK is installed&quot;&quot;&quot;</span>
    <span class="n">path_install</span> <span class="o">=</span> <span class="n">getPathRoboDK</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_install</span><span class="p">)</span></div>


<div class="viewcode-block" id="getPathRoboDK"><a class="viewcode-back" href="../../robolink/#robolink.getPathRoboDK">[docs]</a><span class="k">def</span> <span class="nf">getPathRoboDK</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;RoboDK&#39;s executable/binary file&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span> <span class="k">as</span> <span class="n">_platform</span>

    <span class="k">if</span> <span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;linux&quot;</span> <span class="ow">or</span> <span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;linux2&quot;</span><span class="p">:</span>
        <span class="c1"># Ubuntu, Linux or Debian</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/RoboDK/bin/RoboDK&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
        <span class="c1"># MacOS</span>
        <span class="c1"># self.APPLICATION_DIR = &quot;/Applications/RoboDK.app/Contents/MacOS/RoboDK&quot;</span>
        <span class="n">path_app</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/Applications/RoboDK.app/Contents/MacOS/RoboDK&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_app</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">path_app</span>
        <span class="c1"># default install directory</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/RoboDK/RoboDK.app/Contents/MacOS/RoboDK&quot;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Windows assumed</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">_winreg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">winreg</span> <span class="k">as</span> <span class="nn">_winreg</span>

        <span class="c1"># Try to get the value from the Windows registry:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># if True:</span>
            <span class="c1"># Open the key and return the handle object.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hKey</span> <span class="o">=</span> <span class="n">_winreg</span><span class="o">.</span><span class="n">OpenKey</span><span class="p">(</span>
                    <span class="n">_winreg</span><span class="o">.</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span>
                    <span class="s2">&quot;SOFTWARE</span><span class="se">\\</span><span class="s2">RoboDK&quot;</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">_winreg</span><span class="o">.</span><span class="n">KEY_READ</span> <span class="o">|</span> <span class="n">_winreg</span><span class="o">.</span><span class="n">KEY_WOW64_64KEY</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="n">hKey</span> <span class="o">=</span> <span class="n">_winreg</span><span class="o">.</span><span class="n">OpenKey</span><span class="p">(</span>
                    <span class="n">_winreg</span><span class="o">.</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span>
                    <span class="s2">&quot;SOFTWARE</span><span class="se">\\</span><span class="s2">RoboDK&quot;</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">_winreg</span><span class="o">.</span><span class="n">KEY_READ</span> <span class="o">|</span> <span class="n">_winreg</span><span class="o">.</span><span class="n">KEY_WOW64_32KEY</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Read the value.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_winreg</span><span class="o">.</span><span class="n">QueryValueEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="s2">&quot;INSTDIR&quot;</span><span class="p">)</span>
            <span class="c1"># Close the handle object.</span>
            <span class="n">_winreg</span><span class="o">.</span><span class="n">CloseKey</span><span class="p">(</span><span class="n">hKey</span><span class="p">)</span>
            <span class="c1"># Return only the value from the resulting tuple (value, type_as_int).</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/bin/RoboDK.exe&quot;</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># FileNotFoundError:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;RoboDK was not installed properly. Install RoboDK from www.robodk.com/download.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;C:/RoboDK/bin/RoboDK.exe&quot;</span></div>


<div class="viewcode-block" id="getPathIcon"><a class="viewcode-back" href="../../robolink/#robolink.getPathIcon">[docs]</a><span class="k">def</span> <span class="nf">getPathIcon</span><span class="p">():</span>
    <span class="n">iconpath</span> <span class="o">=</span> <span class="n">getPathRoboDK</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">iconpath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.exe&quot;</span><span class="p">):</span>
        <span class="n">iconpath</span> <span class="o">=</span> <span class="n">iconpath</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">iconpath</span> <span class="o">=</span> <span class="n">iconpath</span> <span class="o">+</span> <span class="s2">&quot;.ico&quot;</span>
    <span class="k">return</span> <span class="n">iconpath</span></div>


<div class="viewcode-block" id="import_install"><a class="viewcode-back" href="../../robolink/#robolink.import_install">[docs]</a><span class="k">def</span> <span class="nf">import_install</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">pip_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rdk</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import a module by first installing it if the corresponding package is not available. If the module name does not match the pip install command, provide the pip_name for install purposes.</span>
<span class="sd">    Optionally, you can pass the RoboDK API Robolink object to see install progress in RoboDK&#39;s status bar.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Example to embed a window as a docked RoboDK window</span>

<span class="sd">        # If you want to install opencv for Python and pyserial you should use:</span>
<span class="sd">        import_install(&quot;opencv&quot;, &quot;opencv-python&quot;, RDK)</span>
<span class="sd">        import_install(&quot;serial&quot;, &quot;pyserial&quot;, RDK)</span>

<span class="sd">        # If the name of the module matches the package you can just pass the name of the module.</span>
<span class="sd">        # Example:</span>
<span class="sd">        import_install(&quot;xlrd&quot;, rdk=RDK)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;import &quot;</span> <span class="o">+</span> <span class="n">module_name</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="k">return</span>

    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>
        <span class="kn">import</span> <span class="nn">io</span>

        <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running command:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
            <span class="c1"># , universal_newlines=True)</span>
            <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span>
            <span class="p">)</span>
            <span class="c1"># or another encoding</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span>
                <span class="c1"># display line output</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rdk</span><span class="p">:</span>
                    <span class="n">rdk</span><span class="o">.</span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pip_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pip_name</span> <span class="o">=</span> <span class="n">module_name</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Installing required module: &quot;</span> <span class="o">+</span> <span class="n">module_name</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rdk</span><span class="p">:</span>
            <span class="n">rdk</span><span class="o">.</span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span> <span class="o">+</span> <span class="s2">&quot; -m pip install &quot;</span> <span class="o">+</span> <span class="n">pip_name</span>
            <span class="c1"># os.system(cmd)</span>
            <span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;import &quot;</span> <span class="o">+</span> <span class="n">module_name</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Unable to load or install &lt;strong&gt;</span><span class="si">%s</span><span class="s2">&lt;/strong&gt;. Make sure you have internet connection and administrator privileges&quot;</span>
                <span class="o">%</span> <span class="n">module_name</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rdk</span><span class="p">:</span>
                <span class="n">rdk</span><span class="o">.</span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="EmbedWindow"><a class="viewcode-back" href="../../robolink/#robolink.EmbedWindow">[docs]</a><span class="k">def</span> <span class="nf">EmbedWindow</span><span class="p">(</span>
    <span class="n">window_name</span><span class="p">,</span>
    <span class="n">docked_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">size_w</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">size_h</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">pid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">area_add</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">area_allowed</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="p">[],</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embed a window from a separate process in RoboDK as a docked window. Returns True if successful.</span>

<span class="sd">    :param str window_name: The name of the window currently open. Make sure the window name is unique and it is a top level window</span>
<span class="sd">    :param str docked_name: Name of the docked tab in RoboDK (optional, if different from the window name)</span>
<span class="sd">    :param int pid: Process ID (optional)</span>
<span class="sd">    :param int area_add: Set to 1 (right) or 2 (left) (default is 1)</span>
<span class="sd">    :param int area_allowed: Areas allowed (default is 15:no constrain)</span>
<span class="sd">    :param int timeout: Timeout to abort attempting to embed the window</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Example to embed a window as a docked RoboDK window</span>

<span class="sd">        from tkinter import *</span>
<span class="sd">        from robolink import *</span>
<span class="sd">        import threading</span>

<span class="sd">        # Create a new window</span>
<span class="sd">        window = tkinter.Tk()</span>

<span class="sd">        # Close the window</span>
<span class="sd">        def onClose():</span>
<span class="sd">            window.destroy()</span>
<span class="sd">            quit(0)</span>

<span class="sd">        # Trigger Select button</span>
<span class="sd">        # IMPORTANT: We need to run the action on a separate thread because</span>
<span class="sd">        # (otherwise, if we want to interact with RoboDK window it will freeze)</span>
<span class="sd">        def on_btnSelect():</span>
<span class="sd">            def thread_btnSelect():</span>
<span class="sd">                # Run button action (example to select an item and display its name)</span>
<span class="sd">                RDK = Robolink()</span>
<span class="sd">                item = RDK.ItemUserPick(&#39;Select an item&#39;)</span>
<span class="sd">                if item.Valid():</span>
<span class="sd">                    RDK.ShowMessage(&quot;You selected the item: &quot; + item.Name())</span>

<span class="sd">            threading.Thread(target=thread_btnSelect).start()</span>

<span class="sd">        # Set the window title (must be unique for the docking to work, try to be creative!)</span>
<span class="sd">        window_title = &#39;RoboDK API Docked Window&#39;</span>
<span class="sd">        window.title(window_title)</span>

<span class="sd">        # Delete the window when we close it</span>
<span class="sd">        window.protocol(&quot;WM_DELETE_WINDOW&quot;, onClose)</span>

<span class="sd">        # Add a button (Select action)</span>
<span class="sd">        btnSelect = Button(window, text=&#39;Trigger on_btnSelect&#39;, height=5, width=60, command=on_btnSelect)</span>
<span class="sd">        btnSelect.pack(fill=X)</span>

<span class="sd">        # Embed the window</span>
<span class="sd">        EmbedWindow(window_title)</span>

<span class="sd">        # Run the window event loop. This is like an app and will block until we close the window</span>
<span class="sd">        window.mainloop()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># import threading</span>
    <span class="k">def</span> <span class="nf">t_dock</span><span class="p">(</span><span class="n">wname</span><span class="p">,</span> <span class="n">dname</span><span class="p">,</span> <span class="n">sz_w</span><span class="p">,</span> <span class="n">sz_h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a_add</span><span class="p">,</span> <span class="n">a_allowed</span><span class="p">,</span> <span class="n">tout</span><span class="p">):</span>
        <span class="c1"># it is important to run this on a parallel thread to not block the main window events in Python</span>
        <span class="n">rdk</span> <span class="o">=</span> <span class="n">Robolink</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rdk</span><span class="o">.</span><span class="n">EmbedWindow</span><span class="p">(</span><span class="n">wname</span><span class="p">,</span> <span class="n">dname</span><span class="p">,</span> <span class="n">sz_w</span><span class="p">,</span> <span class="n">sz_h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a_add</span><span class="p">,</span> <span class="n">a_allowed</span><span class="p">,</span> <span class="n">tout</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Window docked successfully: &quot;</span> <span class="o">+</span> <span class="n">window_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to dock window: &quot;</span> <span class="o">+</span> <span class="n">window_name</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">t_dock</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="n">window_name</span><span class="p">,</span>
            <span class="n">docked_name</span><span class="p">,</span>
            <span class="n">size_w</span><span class="p">,</span>
            <span class="n">size_h</span><span class="p">,</span>
            <span class="n">pid</span><span class="p">,</span>
            <span class="n">area_add</span><span class="p">,</span>
            <span class="n">area_allowed</span><span class="p">,</span>
            <span class="n">timeout</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>


<div class="viewcode-block" id="Robolink"><a class="viewcode-back" href="../../robolink/#robolink.Robolink">[docs]</a><span class="k">class</span> <span class="nc">Robolink</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The Robolink class is the link to to RoboDK and allows creating macros for Robodk, simulate applications and generate programs offline.</span>
<span class="sd">    Any interaction is made through \&quot;items\&quot; (Item() objects). An item is an object in the</span>
<span class="sd">    robodk tree (it can be either a robot, an object, a tool, a frame, a</span>
<span class="sd">    program, ...).</span>

<span class="sd">    :param str robodk_ip: IP of the RoboDK API server (default=&#39;localhost&#39;)</span>
<span class="sd">    :param int port: Port of the RoboDK API server (default=None, it will use the default value)</span>
<span class="sd">    :param list args: Command line arguments to pass to RoboDK on startup (for example: &#39;/NOSPLASH /NOSHOW&#39; should be passed as args=[&#39;/NOSPLASH&#39;,&#39;/NOSHOW&#39;] to not display RoboDK). Arguments have no effect if RoboDK is already running.\n</span>
<span class="sd">        For more information: `RoboDK list of arguments on startup &lt;https://robodk.com/doc/en/RoboDK-API.html#CommandLine&gt;`_.</span>
<span class="sd">    :param str robodk_path: RoboDK installation path. It defaults to RoboDK&#39;s default path (C:/RoboDK/bin/RoboDK.exe on Windows or /Applications/RoboDK.app/Contents/MacOS/RoboDK on Mac)</span>


<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Example of a RoboDK API initialization</span>

<span class="sd">        from robolink import *</span>

<span class="sd">        # Connect to the RoboDK API</span>
<span class="sd">        RDK = Robolink()</span>

<span class="sd">        # Retrieve all items and print their names</span>
<span class="sd">        list_items = RDK.ItemList()</span>
<span class="sd">        for item in list_items:</span>
<span class="sd">            print(item.Name())</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Force starting a new RoboDK hidden instance and output debug information</span>

<span class="sd">        from robolink import *</span>

<span class="sd">        # Connect to the RoboDK API</span>
<span class="sd">        RDK = Robolink(args=[&quot;-NEWINSTANCE&quot;, &quot;-NOUI&quot;, &quot;-SKIPINI&quot;, &quot;-EXIT_LAST_COM&quot;])</span>

<span class="sd">        # Add a reference frame</span>
<span class="sd">        RDK.AddFrame(&quot;My reference frame&quot;)</span>
<span class="sd">        RDK.setPose(transl(100,200,300) * rotz(pi/2))</span>

<span class="sd">        # Retrieve all items and print their names (just a reference frame)</span>
<span class="sd">        list_items = RDK.ItemList()</span>
<span class="sd">        for item in list_items:</span>
<span class="sd">            print(item.Name())</span>

<span class="sd">        # Close RoboDK</span>
<span class="sd">        RDK.CloseRoboDK()</span>

<span class="sd">        # Example command line arguments:</span>
<span class="sd">        # -NEWINSTANCE: Forces using a new instance</span>
<span class="sd">        # -NOUI: Run RoboDK behind the scenes (without OpenGL context)</span>
<span class="sd">        # -SKIPINI: Skip using RoboDK&#39;s INI settings (global settings), this provides a faster startup</span>
<span class="sd">        # -EXIT_LAST_COM: Exit RoboDK when the last API client connected closes</span>
<span class="sd">        # -DEBUG: Run in debug mode (outputs information in the console)</span>
<span class="sd">        #</span>
<span class="sd">        # Follow these steps to see an extended list of command line arguments:</span>
<span class="sd">        # 1- Select Tools-Run Script</span>
<span class="sd">        # 2- Select ShowCommands</span>
<span class="sd">        #</span>
<span class="sd">        # More information here:</span>
<span class="sd">        #    https://robodk.com/doc/en/RoboDK-API.html#CommandLine</span>

<span class="sd">    .. seealso:: :func:`~robolink.Robolink.Item`, :func:`~robolink.Item.Name`, :func:`~robolink.Item.setPose`, :func:`~robolink.Robolink.CloseRoboDK`</span>

<span class="sd">    .. seealso:: :func:`~robolink.Robolink.AddFile`, :func:`~robolink.Robolink.AddFrame`, :func:`~robolink.Robolink.AddTarget`, :func:`~robolink.Robolink.AddProgram`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># checks that provided items exist in memory and poses are homogeneous</span>
    <span class="n">SAFE_MODE</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># if AUTO_UPDATE is 1, updating and rendering objects the 3D the scene will be delayed until 100 ms after the last call (this value can be changed in Tools-Options-Other-API Render delay, or also using the RoboDK.Command(&#39;AutoRenderDelay&#39;, value) and RoboDK.Command(&#39;AutoRenderDelayMax&#39;, value)</span>
    <span class="n">AUTO_UPDATE</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># IP address of the simulator (localhost if it is the same computer), otherwise, use RL = Robolink(&#39;yourip&#39;) to set to a different IP</span>
    <span class="n">IP</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span>

    <span class="c1"># port to start looking for the RoboDK API connection (Tools-Options-Other-RoboDK API)</span>
    <span class="n">PORT_START</span> <span class="o">=</span> <span class="mi">20500</span>

    <span class="c1"># port to stop looking for the RoboDK API connection</span>
    <span class="n">PORT_END</span> <span class="o">=</span> <span class="mi">20500</span>

    <span class="c1"># timeout for communication, in seconds</span>
    <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">69420</span>

    <span class="c1"># Add Cameras as items (added option to use cameras as items at version v5.0.0)</span>
    <span class="n">CAMERA_AS_ITEM</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># activate nodelay option (faster, requires more resources)</span>
    <span class="n">NODELAY</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># file path to the robodk program (executable). As an example, on Windows it should be: C:/RoboDK/bin/RoboDK.exe</span>
    <span class="n">APPLICATION_DIR</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Debug output through console</span>
    <span class="n">COM</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># tcpip com</span>
    <span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="c1"># Command line arguments to RoboDK, such as /NOSPLASH /NOSHOW to not display RoboDK. It has no effect if RoboDK is already running.</span>
    <span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Close standard output for roboDK (RoboDK console output will no longer be visible)</span>
    <span class="n">CLOSE_STD_OUT</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">PORT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># current port</span>
    <span class="n">BUILD</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># This variable holds the build id and is used for version checking</span>

    <span class="c1"># Remember last status message</span>
    <span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

    <span class="k">def</span> <span class="nf">_setTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the communication timeout (in seconds).&quot;&quot;&quot;</span>
        <span class="c1"># Change the default timeout here, in seconds:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span> <span class="o">=</span> <span class="n">timeout_sec</span>  <span class="c1"># in seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns 1 if connection is valid, returns 0 if connection is invalid&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># try:</span>
        <span class="c1">#    self.COM.settimeout(0)</span>
        <span class="c1">#    check = self.COM.recv(1)</span>
        <span class="c1"># except:</span>
        <span class="c1">#    connected = 0</span>
        <span class="c1">#</span>
        <span class="c1"># self.COM.settimeout(self.TIMEOUT)</span>
        <span class="k">return</span> <span class="n">connected</span>

    <span class="k">def</span> <span class="nf">_check_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If we are not connected it will attempt a connection, if it fails, it will throw an error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Connect</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unable to connect&quot;</span><span class="p">)</span>
        <span class="c1"># To do: Clear input buffer.</span>

    <span class="k">def</span> <span class="nf">_check_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This procedure checks the status of the connection&quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># everything is OK</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">elif</span> <span class="n">status</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;Unknown error&quot;</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;Invalid item provided: The item identifier provided is not valid or it does not exist.&quot;</span>
            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># output warning</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>
                <span class="c1"># warn(self.LAST_STATUS_MESSAGE)# does not show where is the problem...</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># output error</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;Invalid license. Purchase a license online (www.robodk.com) or contact us at info@robodk.com.&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="c1"># Since RoboDK 4.0 we raise dedicated errors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TargetReachError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">StoppedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LicenseError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Generic error exception</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;Problems running function&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">status</span>

    <span class="k">def</span> <span class="nf">_check_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Formats the color in a vector of size 4x1 and ranges [0,1]&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The color vector must be a list of 3 or 4 values&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Color provided is not in the range [0,1] ([r,g,b,a])&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">color</span>

    <span class="k">def</span> <span class="nf">_send_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a string of characters with a \\n&quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>  <span class="c1"># Python 2.x only</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>  <span class="c1"># Python 3.x only</span>

    <span class="k">def</span> <span class="nf">_rec_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives a string. It reads until if finds LF (\\n)&quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="n">chari</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">chari</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>  <span class="c1"># read until LF</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="n">chari</span>
            <span class="n">chari</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>  <span class="c1"># python 2 and python 3 compatible</span>
        <span class="c1"># string = &#39;&#39;</span>
        <span class="c1"># chari = self.COM.recv(1).decode(&#39;utf-8&#39;)</span>
        <span class="c1"># while chari != &#39;\n&#39;:    # read until LF</span>
        <span class="c1">#    string = string + chari</span>
        <span class="c1">#    chari = self.COM.recv(1).decode(&#39;utf-8&#39;)</span>
        <span class="c1"># return str(string) # python 2 and python 3 compatible</span>

    <span class="k">def</span> <span class="nf">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends an item pointer&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>
            <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">item</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_rec_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives an item pointer&quot;&quot;&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="n">buffer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">itemtype</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;i&quot;</span><span class="p">,</span> <span class="n">buffer2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">itemtype</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_send_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a byte array&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rec_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives a byte array&quot;&quot;&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
        <span class="n">bytes_len</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="n">bytes_remaining</span> <span class="o">=</span> <span class="n">bytes_len</span>
        <span class="k">while</span> <span class="n">bytes_remaining</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">bytes_remaining</span><span class="p">)</span>
            <span class="n">bytes_remaining</span> <span class="o">=</span> <span class="n">bytes_len</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">_send_ptr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptr_h</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a generic pointer&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
            <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">ptr_h</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># q=unsigned long long (64 bits), d=float64</span>

    <span class="k">def</span> <span class="nf">_rec_ptr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives a generic pointer&quot;&quot;&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="c1"># q=unsigned long long (64 bits), d=float64</span>
        <span class="n">ptr_h</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ptr_h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># return ptr_h</span>

    <span class="k">def</span> <span class="nf">_send_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a pose (4x4 matrix)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose</span><span class="o">.</span><span class="n">isHomogeneous</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: pose is not homogeneous!&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="n">posebytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">posebytes</span> <span class="o">=</span> <span class="n">posebytes</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;d&quot;</span><span class="p">,</span> <span class="n">pose</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">posebytes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rec_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives a pose (4x4 matrix)&quot;&quot;&quot;</span>
        <span class="n">posebytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">posenums</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;16d&quot;</span><span class="p">,</span> <span class="n">posebytes</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">pose</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">posenums</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span>
                <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">pose</span>

    <span class="k">def</span> <span class="nf">_send_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends an xyz vector&quot;&quot;&quot;</span>
        <span class="n">posbytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">posbytes</span> <span class="o">=</span> <span class="n">posbytes</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;d&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">posbytes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rec_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives an xyz vector&quot;&quot;&quot;</span>
        <span class="n">posbytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">posnums</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;3d&quot;</span><span class="p">,</span> <span class="n">posbytes</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posnums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pos</span>

    <span class="k">def</span> <span class="nf">_send_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends an int (32 bits)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;i&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_rec_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives an int (32 bits)&quot;&quot;&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;i&quot;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_send_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends an array of doubles&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># if it is a Mat() with joints</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">tr</span><span class="p">())</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">nval</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nval</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">buffer</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nval</span><span class="p">):</span>
                <span class="n">buffer</span> <span class="o">=</span> <span class="n">buffer</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;d&quot;</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rec_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives an array of doubles&quot;&quot;&quot;</span>
        <span class="n">nvalues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">nvalues</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">nvalues</span><span class="p">)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nvalues</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">))</span>
            <span class="c1"># values = fread(self.COM, nvalues, &#39;double&#39;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_send_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a 2 dimensional matrix (nxm)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">matbytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">matbytes</span> <span class="o">=</span> <span class="n">matbytes</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;d&quot;</span><span class="p">,</span> <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">matbytes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rec_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receives a 2 dimensional matrix (nxm)&quot;&quot;&quot;</span>
        <span class="n">size1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">size2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">recvsize</span> <span class="o">=</span> <span class="n">size1</span> <span class="o">*</span> <span class="n">size2</span> <span class="o">*</span> <span class="mi">8</span>
        <span class="n">BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">512</span>
        <span class="k">if</span> <span class="n">recvsize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matbytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
            <span class="n">to_receive</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">recvsize</span><span class="p">,</span> <span class="n">BUFFER_SIZE</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">to_receive</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">matbytes</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">to_receive</span><span class="p">)</span>
                <span class="n">to_receive</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">recvsize</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">matbytes</span><span class="p">),</span> <span class="n">BUFFER_SIZE</span><span class="p">)</span>
            <span class="n">matnums</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size1</span> <span class="o">*</span> <span class="n">size2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">matbytes</span><span class="p">)</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">size1</span><span class="p">,</span> <span class="n">size2</span><span class="p">)</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size2</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size1</span><span class="p">):</span>
                    <span class="c1"># mat[i,j] = matnums[cnt]</span>
                    <span class="n">mat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">matnums</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span>
                    <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mat</span>

    <span class="k">def</span> <span class="nf">_moveX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">itemrobot</span><span class="p">,</span> <span class="n">movetype</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs a linear or joint movement. Use MoveJ or MoveL instead.&quot;&quot;&quot;</span>
        <span class="c1"># self._check_connection();</span>
        <span class="n">itemrobot</span><span class="o">.</span><span class="n">WaitMove</span><span class="p">()</span>  <span class="c1"># checks connection</span>
        <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MoveXb&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MoveX&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">movetype</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>  <span class="c1"># target is an item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">target</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># target are joints</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">target</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># target is a pose</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">mattr</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span>
                <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid input values&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemrobot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
            <span class="c1"># itemrobot.WaitMove()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">360000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>  <span class="c1"># will wait here</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

<div class="viewcode-block" id="Robolink.MoveC"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.MoveC">[docs]</a>    <span class="k">def</span> <span class="nf">MoveC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target1</span><span class="p">,</span> <span class="n">target2</span><span class="p">,</span> <span class="n">itemrobot</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs a circular movement. Use robot.MoveC instead.&quot;&quot;&quot;</span>
        <span class="c1"># self._check_connection();</span>
        <span class="n">itemrobot</span><span class="o">.</span><span class="n">WaitMove</span><span class="p">()</span>  <span class="c1"># checks connection</span>
        <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MoveCb&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MoveC&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target1</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>  <span class="c1"># target1 is an item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">target1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target1</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">target1</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="p">(</span>
            <span class="mi">4</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span>
        <span class="p">):</span>  <span class="c1"># target1 are joints</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">target1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">target1</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># target1 is a pose</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">mattr</span> <span class="o">=</span> <span class="n">target1</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span>
                <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid input value for target 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target2</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>  <span class="c1"># target1 is an item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">target2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target2</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">target2</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="p">(</span>
            <span class="mi">4</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span>
        <span class="p">):</span>  <span class="c1"># target2 are joints</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">target2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">target2</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># target2 is a pose</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">mattr</span> <span class="o">=</span> <span class="n">target2</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span>
                <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">mattr</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid input value for target 2&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemrobot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
            <span class="c1"># itemrobot.WaitMove()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">360000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>  <span class="c1"># will wait here</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">robodk_ip</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">robodk_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">close_std_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A connection is attempted upon creation of the object</span>
<span class="sd">        In  1 (optional) : robodk_ip -&gt; IP of the RoboDK API server (default=&#39;localhost&#39;)</span>
<span class="sd">        In  2 (optional) : port -&gt; Port of the RoboDK API server (default=None)</span>
<span class="sd">        In  3 (optional) : args -&gt; Command line arguments, as a list, to pass to RoboDK on startup (such as [&#39;/NOSPLASH&#39;,&#39;/NOSHOW&#39;]), to not display RoboDK. It has no effect if RoboDK is already running.</span>
<span class="sd">        In  4 (optional) : robodk_path -&gt; RoboDK path. Leave it to the default None for the default path (C:/RoboDK/bin/RoboDK.exe).</span>
<span class="sd">        In  5 (optional) : close_std_out -&gt; Close RoboDK standard output path. No RoboDK console output will be shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">args</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">IP</span> <span class="o">=</span> <span class="n">robodk_ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CLOSE_STD_OUT</span> <span class="o">=</span> <span class="n">close_std_out</span>
        <span class="k">if</span> <span class="n">robodk_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span> <span class="o">=</span> <span class="n">robodk_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span> <span class="o">=</span> <span class="n">getPathRoboDK</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;/API_NODELAY&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="ow">or</span> <span class="s2">&quot;-API_NODELAY&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NODELAY</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PORT_START</span> <span class="o">=</span> <span class="n">port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PORT_END</span> <span class="o">=</span> <span class="n">port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-PORT=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s2">&quot;ROBODK_API_PORT&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
            <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;ROBODK_API_PORT&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PORT_START</span> <span class="o">=</span> <span class="n">port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PORT_END</span> <span class="o">=</span> <span class="n">port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-PORT=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s2">&quot;/NEWINSTANCE&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="ow">or</span> <span class="s2">&quot;-NEWINSTANCE&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="n">socket</span>

            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">socket</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">getsockname</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using available port </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PORT_START</span> <span class="o">=</span> <span class="n">port</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PORT_END</span> <span class="o">=</span> <span class="n">port</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-PORT=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">()</span>
                <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">getsockname</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using available port </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PORT_START</span> <span class="o">=</span> <span class="n">port</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PORT_END</span> <span class="o">=</span> <span class="n">port</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-PORT=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">port</span><span class="p">)</span>
                <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;-DEBUG&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="ow">or</span> <span class="s2">&quot;/DEBUG&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-DEBUG&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Connect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_verify_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that we are connected to the RoboDK API server&quot;&quot;&quot;</span>

        <span class="n">use_new_version</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">use_new_version</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;RDK_API&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">SAFE_MODE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">AUTO_UPDATE</span><span class="p">])</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="n">ver_api</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BUILD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&quot;RDK_API&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;CMD_START&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SAFE_MODE</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AUTO_UPDATE</span><span class="p">))</span>
            <span class="c1"># fprintf(self.COM, sprintf(&#39;%i %i&#39;), self.SAFE_MODE, self.AUTO_UPDATE))# appends LF</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&quot;READY&quot;</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="n">ok</span>

    <span class="k">def</span> <span class="nf">_require_build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">build_required</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUILD</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># unknown build number. Use new API hello command</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUILD</span> <span class="o">&lt;</span> <span class="n">build_required</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;This function is unavailable. Update RoboDK to use this API feature: https://robodk.com/download&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="Robolink.Disconnect"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">Disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops the communication with RoboDK. If setRunMode is set to RUNMODE_MAKE_ROBOTPROG for offline programming, any programs pending will be generated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Finish"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Finish">[docs]</a>    <span class="k">def</span> <span class="nf">Finish</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops the communication with RoboDK. If setRunMode is set to RUNMODE_MAKE_ROBOTPROG for offline programming, any programs pending will be generated.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode`, :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Robolink.ProgramStart`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.NewLink"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.NewLink">[docs]</a>    <span class="k">def</span> <span class="nf">NewLink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reconnect the API using a different communication link.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># if True:</span>
            <span class="kn">import</span> <span class="nn">socket</span>

            <span class="c1"># self.COM.close()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NODELAY</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_TCP</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">TCP_NODELAY</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">IP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PORT</span><span class="p">))</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">connected</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_verify_connection</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to reconnect (1)&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to reconnect (2)&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Robolink.Connect"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Connect">[docs]</a>    <span class="k">def</span> <span class="nf">Connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Establish a connection with RoboDK. If RoboDK is not running it will attempt to start RoboDK from the default installation path (otherwise APPLICATION_DIR must be set properly).</span>
<span class="sd">        If the connection succeeds it returns 1, otherwise it returns 0&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">start_robodk</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span><span class="p">)</span>
            <span class="kn">import</span> <span class="nn">subprocess</span>

            <span class="c1"># import time</span>
            <span class="c1"># tstart = time.time()</span>

            <span class="k">def</span> <span class="nf">output_reader</span><span class="p">(</span><span class="n">proc</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
                    <span class="n">ln</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">ln</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>

            <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span> <span class="k">as</span> <span class="n">_platform</span>

            <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;linux&quot;</span> <span class="ow">or</span> <span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;linux2&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span>
                <span class="n">command</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.sh&quot;</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                    <span class="n">command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">_platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
                <span class="c1"># Popen does not work sometimes (such as running from fusion)</span>
                <span class="n">startapp</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;/usr/bin/open&quot;</span><span class="p">,</span> <span class="n">command</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/Content&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># p = subprocess.Popen(command,stdout=subprocess.PIPE)</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="k">return</span> <span class="kc">False</span>

                <span class="c1"># p = subprocess.call(startapp)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>

            <span class="n">emptyln</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">lineb</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lineb</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lineb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="n">emptyln</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">emptyln</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">emptyln</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RoboDK Application not properly started. Command:&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
                        <span class="k">break</span>

                    <span class="k">if</span> <span class="s2">&quot;running&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="c1"># telapsed = time.time() - tstart</span>
                        <span class="c1"># print(&quot;RoboDK startup time: %.3f&quot; % telapsed)</span>
                        <span class="k">break</span>

                <span class="c1"># if self.DEBUG:</span>
                <span class="c1"># Important! Make sure we consume stdout (at least in Debug mode)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CLOSE_STD_OUT</span><span class="p">:</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># import threading</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">output_reader</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,))</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># with subprocess.Popen(command, stdout=subprocess.PIPE, bufsize=1, universal_newlines=True) as p:</span>
            <span class="c1">#    self._ProcessID = p.pid</span>
            <span class="c1">#    for line in p.stdout:</span>
            <span class="c1">#        line_ok = line.strip()</span>
            <span class="c1">#        print(line_ok)</span>
            <span class="c1">#        if &#39;running&#39; in line_ok.lower():</span>
            <span class="c1">#            print(&quot;RoboDK is running&quot;)</span>
            <span class="c1">#            return #does not return!!</span>

        <span class="kn">import</span> <span class="nn">socket</span>

        <span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PORT_START</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PORT_END</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># Prevent warning message by closing the previous socket</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">COM</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NODELAY</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_TCP</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">TCP_NODELAY</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">IP</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
                    <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">connected</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
                        <span class="k">break</span>

                <span class="k">except</span><span class="p">:</span>
                    <span class="n">connected</span> <span class="o">=</span> <span class="n">connected</span>

            <span class="k">if</span> <span class="n">connected</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if status is closed, try to open application</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PORT</span> <span class="o">=</span> <span class="n">port</span>
                <span class="k">break</span>

            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IP</span> <span class="o">!=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">return</span> <span class="n">connected</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span><span class="p">]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">:</span>
                        <span class="n">command</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ARGUMENTS</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">start_robodk</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
                        <span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">return</span> <span class="n">connected</span>
                    <span class="c1"># import time</span>
                    <span class="c1"># time.sleep(5) # wait for RoboDK to start and check network license.</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s2">&quot;Application path is not correct or could not start: &quot;</span>
                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">APPLICATION_DIR</span>
                    <span class="p">)</span>

        <span class="k">if</span> <span class="n">connected</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verify_connection</span><span class="p">():</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">connected</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="c1"># public methods</span>
<div class="viewcode-block" id="Robolink.Item"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Item">[docs]</a>    <span class="k">def</span> <span class="nf">Item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">itemtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an item by its name. If there is no exact match it will return the last closest match.</span>
<span class="sd">        Specify what type of item you are looking for with itemtype. This is useful if 2 items have the same name but different type.</span>
<span class="sd">        (check variables ITEM_TYPE_*)</span>

<span class="sd">        :param str name: name of the item (name of the item shown in the RoboDK station tree)</span>
<span class="sd">        :param int itemtype: type of the item to be retrieved (avoids confusion if there are similar name matches). Use ITEM_TYPE_*.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available Item types</span>

<span class="sd">            ITEM_TYPE_STATION=1             # station item (.rdk files)</span>
<span class="sd">            ITEM_TYPE_ROBOT=2               # robot item (.robot files)</span>
<span class="sd">            ITEM_TYPE_FRAME=3               # reference frame item</span>
<span class="sd">            ITEM_TYPE_TOOL=4                # tool item (.tool files or tools without geometry)</span>
<span class="sd">            ITEM_TYPE_OBJECT=5              # object item (.stl, .step, .iges, ...)</span>
<span class="sd">            ITEM_TYPE_TARGET=6              # target item</span>
<span class="sd">            ITEM_TYPE_PROGRAM=8             # program item (made using the GUI)</span>
<span class="sd">            ITEM_TYPE_PROGRAM_PYTHON=10     # Python program or macro</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.ItemList`, :func:`~robolink.Robolink.ItemUserPick`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Name`, :func:`~robolink.Item.Pose`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setParent`, :func:`~robolink.Item.setJoints`, :func:`~robolink.Item.MoveJ`, :func:`~robolink.Item.MoveL`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            tool  = RDK.Item(&#39;Tool&#39;)                # Retrieve an item named tool</span>
<span class="sd">            robot = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)   # the first available robot</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Invalid name: provide a name as a string. Item names are visible in the RoboDK tree.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">itemtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Item&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Item2&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">itemtype</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>  <span class="c1"># item = fread(com, 2, &#39;ulong&#39;);% ulong is 32 bits!!!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="Robolink.ItemList"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ItemList">[docs]</a>    <span class="k">def</span> <span class="nf">ItemList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_names</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of items (list of name or pointers) of all available items in the currently open station of RoboDK.</span>

<span class="sd">        :param int filter: (optional) Filter the list by a specific item type (ITEM_TYPE_*). For example: RDK.ItemList(filter = ITEM_TYPE_ROBOT)</span>
<span class="sd">        :param int list_names: (optional) Set to True to return a list of names instead of a list of :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Item`, :func:`~robolink.Robolink.ItemUserPick`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">retlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">list_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_List_Items&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_List_Items_Type&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
                <span class="n">namei</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
                <span class="n">retlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">namei</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_List_Items_ptr&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_List_Items_Type_ptr&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
                <span class="n">itemi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
                <span class="n">retlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itemi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">retlist</span></div>

<div class="viewcode-block" id="Robolink.ItemUserPick"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ItemUserPick">[docs]</a>    <span class="k">def</span> <span class="nf">ItemUserPick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Pick one item&quot;</span><span class="p">,</span> <span class="n">itemtype_or_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows a RoboDK popup to select one object from the open station.</span>
<span class="sd">        An item type can be specified to filter desired items. If no type is specified, all items are selectable.</span>
<span class="sd">        (check variables ITEM_TYPE_*)</span>
<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            RDK.ItemUserPick(&quot;Pick a robot&quot;, ITEM_TYPE_ROBOT)</span>

<span class="sd">        :param str message: message to display</span>
<span class="sd">        :param int itemtype_or_list: filter choices by a specific item type (ITEM_TYPE_*) or provide a list of items to choose from</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Item`, :func:`~robolink.Robolink.ItemList`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">itemtype_or_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">itemtype_or_list</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">itemtype_or_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;PickItem&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">itemtype_or_list</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;PickItemList&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">itemtype_or_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">itm</span> <span class="ow">in</span> <span class="n">itemtype_or_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itm</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># wait up to 1 hour for user input</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="Robolink.ShowRoboDK"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ShowRoboDK">[docs]</a>    <span class="k">def</span> <span class="nf">ShowRoboDK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show or raise the RoboDK window</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setWindowState`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RAISE&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.HideRoboDK"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.HideRoboDK">[docs]</a>    <span class="k">def</span> <span class="nf">HideRoboDK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the RoboDK window. RoboDK will keep running as a process</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setWindowState`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;HIDE&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.CloseRoboDK"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CloseRoboDK">[docs]</a>    <span class="k">def</span> <span class="nf">CloseRoboDK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close RoboDK window and finish RoboDK&#39;s execution.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;QUIT&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Version"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Version">[docs]</a>    <span class="k">def</span> <span class="nf">Version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close RoboDK window and finish RoboDK&#39;s execution.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Version&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">bit_arch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">ver4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">date_build</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ver4</span></div>

<div class="viewcode-block" id="Robolink.setWindowState"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setWindowState">[docs]</a>    <span class="k">def</span> <span class="nf">setWindowState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windowstate</span><span class="o">=</span><span class="n">WINDOWSTATE_NORMAL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the state of the RoboDK window</span>

<span class="sd">        :param int windowstate: state of the window (WINDOWSTATE_*)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Allowed window states</span>

<span class="sd">            WINDOWSTATE_HIDDEN      = -1        # Hidden</span>
<span class="sd">            WINDOWSTATE_SHOW        = 0         # Visible</span>
<span class="sd">            WINDOWSTATE_MINIMIZED   = 1         # Minimize window</span>
<span class="sd">            WINDOWSTATE_NORMAL      = 2         # Show normal window (last known state)</span>
<span class="sd">            WINDOWSTATE_MAXIMIZED   = 3         # Show maximized window</span>
<span class="sd">            WINDOWSTATE_FULLSCREEN  = 4         # Show fulscreen window</span>
<span class="sd">            WINDOWSTATE_CINEMA      = 5         # Show maximized window without the toolbar and without the menu</span>
<span class="sd">            WINDOWSTATE_FULLSCREEN_CINEMA= 6    # Show fulscreen window without the toolbar and without the menu</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setFlagsRoboDK`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_WindowState&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">windowstate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.setFlagsRoboDK"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setFlagsRoboDK">[docs]</a>    <span class="k">def</span> <span class="nf">setFlagsRoboDK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">FLAG_ROBODK_ALL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the RoboDK flags. RoboDK flags allow defining how much access the user has to RoboDK features. Use a FLAG_ROBODK_* variables to set one or more flags.</span>

<span class="sd">        :param int flags: state of the window (FLAG_ROBODK_*)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Allowed RoboDK flags</span>

<span class="sd">            FLAG_ROBODK_TREE_ACTIVE = 1                 # Enable the tree</span>
<span class="sd">            FLAG_ROBODK_3DVIEW_ACTIVE = 2               # Enable the 3D view (3D mouse navigation)</span>
<span class="sd">            FLAG_ROBODK_LEFT_CLICK = 4                  # Enable left clicks</span>
<span class="sd">            FLAG_ROBODK_RIGHT_CLICK = 8                 # Enable right clicks</span>
<span class="sd">            FLAG_ROBODK_DOUBLE_CLICK = 16               # Enable double clicks</span>
<span class="sd">            FLAG_ROBODK_MENU_ACTIVE = 32                # Enable the main menu (complete menu)</span>
<span class="sd">            FLAG_ROBODK_MENUFILE_ACTIVE = 64            # Enable the File menu</span>
<span class="sd">            FLAG_ROBODK_MENUEDIT_ACTIVE = 128           # Enable the Edit menu</span>
<span class="sd">            FLAG_ROBODK_MENUPROGRAM_ACTIVE = 256        # Enable the Program menu</span>
<span class="sd">            FLAG_ROBODK_MENUTOOLS_ACTIVE = 512          # Enable the Tools menu</span>
<span class="sd">            FLAG_ROBODK_MENUUTILITIES_ACTIVE = 1024     # Enable the Utilities menu</span>
<span class="sd">            FLAG_ROBODK_MENUCONNECT_ACTIVE = 2048       # Enable the Connect menu</span>
<span class="sd">            FLAG_ROBODK_WINDOWKEYS_ACTIVE = 4096        # Enable the keyboard</span>
<span class="sd">            FLAG_ROBODK_TREE_VISIBLE = 8192             # Make the station tree visible</span>
<span class="sd">            FLAG_ROBODK_REFERENCES_VISIBLE = 16384      # Make the reference frames visible</span>
<span class="sd">            FLAG_ROBODK_NONE = 0                        # Disable everything</span>
<span class="sd">            FLAG_ROBODK_ALL = 0xFFFF                    # Enable everything</span>
<span class="sd">            FLAG_ROBODK_MENU_ACTIVE_ALL                 # Enable the menu only</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setFlagsItem`, :func:`~robolink.Robolink.setWindowState`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_RoboDK_Rights&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.setFlagsItem"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setFlagsItem">[docs]</a>    <span class="k">def</span> <span class="nf">setFlagsItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">FLAG_ITEM_ALL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update item flags. Item flags allow defining how much access the user has to item-specific features. Use FLAG_ITEM_* flags to set one or more flags.</span>

<span class="sd">        :param item: item to set (set to 0 to apply to all items)</span>
<span class="sd">        :type item: :class:`Item`</span>
<span class="sd">        :param flags: set the item flags (FLAG_ITEM_*)</span>
<span class="sd">        :type flags: int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.getFlagsItem`, :func:`~robolink.Robolink.setFlagsRoboDK`, :func:`~robolink.Robolink.setWindowState`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Item_Rights&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.getFlagsItem"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.getFlagsItem">[docs]</a>    <span class="k">def</span> <span class="nf">getFlagsItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve current item flags. Item flags allow defining how much access the user has to item-specific features. Use FLAG_ITEM_* flags to set one or more flags.</span>

<span class="sd">        :param item: item to get flags</span>
<span class="sd">        :type item: :class:`Item`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Allowed RoboDK flags</span>

<span class="sd">            FLAG_ITEM_SELECTABLE = 1        # Allow selecting the item</span>
<span class="sd">            FLAG_ITEM_EDITABLE = 2          # Allow editing the item</span>
<span class="sd">            FLAG_ITEM_DRAGALLOWED = 4       # Allow dragging the item</span>
<span class="sd">            FLAG_ITEM_DROPALLOWED = 8       # Allow dropping nested items</span>
<span class="sd">            FLAG_ITEM_ENABLED = 32          # Enable this item in the tree</span>
<span class="sd">            FLAG_ITEM_NONE = 0              # Disable everything</span>
<span class="sd">            FLAG_ITEM_ALL = 64+32+8+4+2+1   # Enable everything</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setFlagsItem`, :func:`~robolink.Robolink.setFlagsRoboDK`, :func:`~robolink.Robolink.setWindowState`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Item_Rights&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">flags</span></div>

<div class="viewcode-block" id="Robolink.ShowMessage"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ShowMessage">[docs]</a>    <span class="k">def</span> <span class="nf">ShowMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show a message from the RoboDK window. By default, the message will be a blocking popup. Alternatively, it can be a message displayed at the bottom of RoboDK&#39;s main window.</span>

<span class="sd">        :param str message: message to display</span>
<span class="sd">        :param bool popup: Set to False to display the message in the RoboDK&#39;s status bar (not blocking)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">popup</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ShowMessage&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># wait up to 1 hour user to hit OK</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ShowMessageStatus&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<div class="viewcode-block" id="Robolink.Copy"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Copy">[docs]</a>    <span class="k">def</span> <span class="nf">Copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">copy_childs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Makes a copy of an item (same as Ctrl+C), which can be pasted (Ctrl+V) using Paste().</span>

<span class="sd">        :param item: Item to copy to the clipboard</span>
<span class="sd">        :type item: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Paste`, Item. :func:`~robolink.Item.Copy`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            RDK = Robolink()</span>
<span class="sd">            object = RDK.Item(&#39;My Object&#39;)</span>
<span class="sd">            object.Copy()               # same as RDK.Copy(object) also works</span>
<span class="sd">            object_copy1 = RDK.Paste()</span>
<span class="sd">            object_copy1.setName(&#39;My Object (copy 1)&#39;)</span>
<span class="sd">            object_copy2 = RDK.Paste()</span>
<span class="sd">            object_copy2.setName(&#39;My Object (copy 2)&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Copy2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">copy_childs</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Paste"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Paste">[docs]</a>    <span class="k">def</span> <span class="nf">Paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paste_to</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">paste_times</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste the copied item as a dependency of another item (same as Ctrl+V). Paste should be used after Copy(). It returns the newly created item.</span>

<span class="sd">        :param paste_to: Item to attach the copied item (optional)</span>
<span class="sd">        :type paste_to: :class:`.Item`</span>
<span class="sd">        :param int paste_times: number of times to paste the item (returns a list if greater than 1)</span>
<span class="sd">        :return: New item created</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Copy`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">paste_times</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">10500</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;PastN&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">paste_to</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">paste_times</span><span class="p">)</span>
            <span class="n">ntimes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="n">list_items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntimes</span><span class="p">):</span>
                <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
                <span class="n">list_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newitem</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">list_items</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Paste&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">paste_to</span><span class="p">)</span>
            <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddFile"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddFile">[docs]</a>    <span class="k">def</span> <span class="nf">AddFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a file and attach it to parent (if provided). The call returns the newly added :class:`.Item`. If the new file is an object and it is attached to a robot it will be automatically converted to a tool.</span>

<span class="sd">        :param str filename: any file to load, supported by RoboDK. Supported formats include STL, STEP, IGES, ROBOT, TOOL, RDK,... It is also possible to load supported robot programs, such as SRC (KUKA), SCRIPT (Universal Robots), LS (Fanuc), JBI (Motoman), MOD (ABB), PRG (ABB), ...</span>
<span class="sd">        :param parent: item to attach the newly added object (optional)</span>
<span class="sd">        :type parent: :class:`.Item`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            RDK = Robolink()</span>
<span class="sd">            item = RDK.AddFile(r&#39;C:\\Users\\Name\\Desktop\\object.step&#39;)</span>
<span class="sd">            item.setPose(transl(100,50,500))</span>

<span class="sd">            # Add a tool to an existing robot:</span>
<span class="sd">            tool = RDK.AddFile(r&#39;C:\\Users\\Name\\Desktop\\robot-tool.stl&#39;, robot)</span>
<span class="sd">            tool.setPoseTool(transl(100,50,500))</span>

<span class="sd">            # Add a reference frame, move it and add an object to that reference frame (locally):</span>
<span class="sd">            frame = AddFrame(&#39;Reference A&#39;)</span>
<span class="sd">            frame.setPose(transl(100,200,300))</span>
<span class="sd">            new_object = RDK.Addfile(&#39;path-to-object.stl&#39;, frame)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Save`, :func:`~robolink.Robolink.AddFrame`, :func:`~robolink.Robolink.AddTool`, :func:`~robolink.Robolink.Copy`, :func:`~robolink.Robolink.Paste`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># 60 seconds timeout to add a file</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddShape"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddShape">[docs]</a>    <span class="k">def</span> <span class="nf">AddShape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triangle_points</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">override_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a shape provided triangle coordinates. Triangles must be provided as a list of vertices. A vertex normal can be provided optionally.</span>

<span class="sd">        :param triangle_points: List of vertices grouped by triangles.</span>
<span class="sd">        :type triangle_points: :class:`robodk.Mat` (3xN or 6xN matrix, N must be multiple of 3 because vertices must be stacked by groups of 3)</span>
<span class="sd">        :param parent: item to attach the newly added geometry (optional)</span>
<span class="sd">        :type parent: :class:`.Item`</span>
<span class="sd">        :param override_shapes: Set to True to fill the object with a new shape</span>
<span class="sd">        :type override_shapes: bool</span>
<span class="sd">        :return: added object/shape (0 if failed)</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddCurve`, :func:`~robolink.Robolink.AddPoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">triangle_points</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">triangle_points</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">triangle_points</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">triangle_points</span><span class="p">,</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;triangle_points must be a 3xN or 6xN list or matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;AddShape2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">triangle_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">add_to</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">override_shapes</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddCurve"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddCurve">[docs]</a>    <span class="k">def</span> <span class="nf">AddCurve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">curve_points</span><span class="p">,</span>
        <span class="n">reference_object</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">add_to_ref</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a curve provided point coordinates. The provided points must be a list of vertices. A vertex normal can be provided optionally.</span>

<span class="sd">        :param curve_points: List of points defining the curve</span>
<span class="sd">        :type curve_points: :class:`robodk.Mat` (3xN matrix, or 6xN to provide curve normals as ijk vectors)</span>
<span class="sd">        :param reference_object: item to attach the newly added geometry (optional)</span>
<span class="sd">        :type reference_object: :class:`.Item`</span>
<span class="sd">        :param bool add_to_ref: If True, the curve will be added as part of the object in the RoboDK item tree (a reference object must be provided)</span>
<span class="sd">        :param int projection_type: type of projection. Use the PROJECTION_* flags.</span>
<span class="sd">        :return: added object/shape (0 if failed)</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available projection types</span>

<span class="sd">            PROJECTION_NONE                = 0      # No projection</span>
<span class="sd">            PROJECTION_CLOSEST             = 1 # The projection will be the closest point on the surface</span>
<span class="sd">            PROJECTION_ALONG_NORMAL        = 2 # The projection will be done along the normal.</span>
<span class="sd">            PROJECTION_ALONG_NORMAL_RECALC = 3 # The projection will be done along the normal. Furthermore, the normal will be recalculated according to the surface normal.</span>
<span class="sd">            PROJECTION_CLOSEST_RECALC      = 4 # The projection will be the closest point on the surface and the normals will be recalculated</span>
<span class="sd">            PROJECTION_RECALC              = 5 # The normals are recalculated according to the surface normal of the closest projection. The points are not changed.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddShape`, :func:`~robolink.Robolink.AddPoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">curve_points</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">curve_points</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">curve_points</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">curve_points</span><span class="p">,</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;curve_points must be a 3xN or 6xN list or matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;AddWire&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">curve_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">reference_object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">add_to_ref</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">projection_type</span><span class="p">)</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddPoints"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddPoints">[docs]</a>    <span class="k">def</span> <span class="nf">AddPoints</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">points</span><span class="p">,</span>
        <span class="n">reference_object</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">add_to_ref</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a list of points to an object. The provided points must be a list of vertices. A vertex normal can be provided optionally.</span>

<span class="sd">        :param points: list of points or matrix</span>
<span class="sd">        :type points: :class:`robodk.Mat` (3xN matrix, or 6xN to provide point normals as ijk vectors)</span>
<span class="sd">        :param reference_object: item to attach the newly added geometry (optional)</span>
<span class="sd">        :type reference_object: :class:`.Item`</span>
<span class="sd">        :param bool add_to_ref: If True, the points will be added as part of the object in the RoboDK item tree (a reference object must be provided)</span>
<span class="sd">        :param int projection_type: type of projection. Use the PROJECTION_* flags.</span>
<span class="sd">        :return: added object/shape (0 if failed)</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.ProjectPoints`, :func:`~robolink.Robolink.AddShape`, :func:`~robolink.Robolink.AddCurve`</span>

<span class="sd">        The difference between ProjectPoints and AddPoints is that ProjectPoints does not add the points to the RoboDK station.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;points must be a 3xN or 6xN list or matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;AddPoints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">reference_object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">add_to_ref</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">projection_type</span><span class="p">)</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.ProjectPoints"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ProjectPoints">[docs]</a>    <span class="k">def</span> <span class="nf">ProjectPoints</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">points</span><span class="p">,</span>
        <span class="n">object_project</span><span class="p">,</span>
        <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Project a point or a list of points given its coordinates.</span>
<span class="sd">        The provided points must be a list of [XYZ] coordinates. Optionally, a vertex normal can be provided [XYZijk].</span>
<span class="sd">        It returns the projected points as a list of points (empty matrix if failed).</span>

<span class="sd">        :param points: list of points to project</span>
<span class="sd">        :type points: list of points (XYZ or XYZijk list of floats), or :class:`robodk.Mat` (3xN matrix, or 6xN to provide point normals as ijk vectors)</span>
<span class="sd">        :param object_project: object to project the points</span>
<span class="sd">        :type object_project: :class:`.Item`</span>
<span class="sd">        :param projection_type: Type of projection. For example: PROJECTION_ALONG_NORMAL_RECALC will project along the point normal and recalculate the normal vector on the surface projected.</span>
<span class="sd">        :type projection_type: int</span>
<span class="sd">        :param timeout: Max timeout to wait for a reply in seconds (30 seconds by default).</span>
<span class="sd">        :type timeout: int</span>

<span class="sd">        The difference between ProjectPoints and AddPoints is that ProjectPoints does not add the points to the RoboDK station.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">islist</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">islist</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
            <span class="c1"># Safety check for backwards compatibility</span>
            <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">points</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;points must be a 3xN or 6xN list or matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ProjectPoints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">object_project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">projection_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>  <span class="c1"># 30 seconds timeout</span>
        <span class="n">projected_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>  <span class="c1"># will wait here</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">islist</span><span class="p">:</span>
            <span class="n">projected_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">projected_points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">projected_points</span></div>

<div class="viewcode-block" id="Robolink.CloseStation"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CloseStation">[docs]</a>    <span class="k">def</span> <span class="nf">CloseStation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closes the current RoboDK station without suggesting to save&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">12938</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;RemoveStn&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Delete"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Delete">[docs]</a>    <span class="k">def</span> <span class="nf">Delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a list of items.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Delete`, :func:`~robolink.Robolink.CloseStation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">14560</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item_list</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RemoveLst&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">itm</span> <span class="ow">in</span> <span class="n">item_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itm</span><span class="p">)</span>
            <span class="n">itm</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Save"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Save">[docs]</a>    <span class="k">def</span> <span class="nf">Save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">itemsave</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save an item or a station to a file (formats supported include RDK, STL, ROBOT, TOOL, ...). If no item is provided, the open station is saved.</span>

<span class="sd">        :param str filename: File path to save</span>
<span class="sd">        :param itemsave: Item to save (leave at 0 to save the current RoboDK station as an RDK file</span>
<span class="sd">        :type itemsave: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFile`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Save&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemsave</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span></div>

<div class="viewcode-block" id="Robolink.AddStation"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddStation">[docs]</a>    <span class="k">def</span> <span class="nf">AddStation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;New Station&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new empty station. It returns the station :class:`.Item` created.</span>

<span class="sd">        :param str name: name of the station</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFile`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;NewStation&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddTarget"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddTarget">[docs]</a>    <span class="k">def</span> <span class="nf">AddTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">itemparent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">itemrobot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new target that can be reached with a robot.</span>

<span class="sd">        :param str name: Target name</span>
<span class="sd">        :param itemparent: Reference frame to attach the target</span>
<span class="sd">        :type itemparent: :class:`.Item`</span>
<span class="sd">        :param itemrobot: Robot that will be used to go to self target (optional)</span>
<span class="sd">        :type itemrobot: :class:`.Item`</span>
<span class="sd">        :return: New target item created</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFrame`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_TARGET&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemparent</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemrobot</span><span class="p">)</span>
            <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddFrame"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddFrame">[docs]</a>    <span class="k">def</span> <span class="nf">AddFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">itemparent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new reference Frame. It returns the new :class:`.Item` created.</span>

<span class="sd">        :param str name: name of the new reference frame</span>
<span class="sd">        :param itemparent: Item to attach the new reference frame (such as another reference frame)</span>
<span class="sd">        :type itemparent: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddTarget`&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_FRAME&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemparent</span><span class="p">)</span>
            <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddProgram"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddProgram">[docs]</a>    <span class="k">def</span> <span class="nf">AddProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">itemrobot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new program to the RoboDK station. Programs can be used to simulate a specific sequence, to generate vendor specific programs (Offline Programming) or to run programs on the robot (Online Programming).</span>
<span class="sd">        It returns the new :class:`.Item` created.</span>
<span class="sd">        Tip: Use the MoveRobotThroughLine.py macro to create programs in the RoboDK station (Option 2).</span>

<span class="sd">        :param name: Name of the program</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param itemrobot: Robot that will be used for this program. It is not required to specify the robot if the station has only one robot or mechanism.</span>
<span class="sd">        :type itemrobot: :class:`.Item`</span>
<span class="sd">        :return: New program item</span>
<span class="sd">        :rtype: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddTarget`, :func:`~robolink.Item.MoveJ`, :func:`~robolink.Item.MoveL`, :func:`~robolink.Item.setDO`, :func:`~robolink.Item.waitDI`, :func:`~robolink.Item.Pause`, :func:`~robolink.Item.RunCodeCustom`, :func:`~robolink.Item.RunInstruction`, :func:`~robolink.Item.ShowInstructions`, :func:`~robolink.Item.ShowTargets`, :func:`~robolink.Item.Update`</span>


<span class="sd">        Example 1 - Generic program with movements:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Turn off rendering (faster)</span>
<span class="sd">            RDK.Render(False)</span>
<span class="sd">            prog = RDK.AddProgram(&#39;AutoProgram&#39;)</span>

<span class="sd">            # Hide program instructions (optional, but faster)</span>
<span class="sd">            prog.ShowInstructions(False)</span>

<span class="sd">            # Retrieve the current robot position:</span>
<span class="sd">            pose_ref = robot.Pose()</span>

<span class="sd">            # Iterate through a number of points</span>
<span class="sd">            for i in range(len(POINTS)):</span>
<span class="sd">                # add a new target</span>
<span class="sd">                ti = RDK.AddTarget(&#39;Auto Target %i&#39; % (i+1))</span>

<span class="sd">                # use the reference pose and update the XYZ position</span>
<span class="sd">                pose_ref.setPos(POINTS[i])</span>
<span class="sd">                ti.setPose(pose_ref)</span>

<span class="sd">                # force to use the target as a Cartesian target (default)</span>
<span class="sd">                ti.setAsCartesianTarget()</span>

<span class="sd">                # Add the target as a Linear/Joint move in the new program</span>
<span class="sd">                prog.MoveL(ti)</span>

<span class="sd">            # Hide the target items from the tree: it each movement still keeps its own target.</span>
<span class="sd">            # Right click the movement instruction and select &quot;Select Target&quot; to see the target in the tree</span>
<span class="sd">            program.ShowTargets(False)</span>

<span class="sd">            # Turn rendering ON before starting the simulation (automatic if we are done)</span>
<span class="sd">            RDK.Render(True)</span>

<span class="sd">            #--------------------------------------</span>
<span class="sd">            # Update the program path to display the yellow path in RoboDK.</span>
<span class="sd">            # Set collision checking ON or OFF</span>
<span class="sd">            check_collisions = COLLISION_OFF</span>
<span class="sd">            # Update the path (can take some time if collision checking is active)</span>
<span class="sd">            update_result = program.Update(check_collisions)</span>
<span class="sd">            # Retrieve the result</span>
<span class="sd">            n_insok = update_result[0]</span>
<span class="sd">            time = update_result[1]</span>
<span class="sd">            distance = update_result[2]</span>
<span class="sd">            percent_ok = update_result[3]*100</span>
<span class="sd">            str_problems = update_result[4]</span>
<span class="sd">            if percent_ok &lt; 100.0:</span>
<span class="sd">                msg_str = &quot;WARNING! Problems with &lt;strong&gt;%s&lt;/strong&gt; (%.1f):&lt;br&gt;%s&quot; % (program_name, percent_ok, str_problems)</span>
<span class="sd">            else:</span>
<span class="sd">                msg_str = &quot;No problems found for program %s&quot; % program_name</span>

<span class="sd">            # Notify the user:</span>
<span class="sd">            print(msg_str)</span>
<span class="sd">            RDK.ShowMessage(msg_str)</span>

<span class="sd">        Example 2 - Program flow, manage inputs/outputs and program calls:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Add a pause (in miliseconds)</span>
<span class="sd">            program.Pause(1000) # pause motion 1 second</span>

<span class="sd">            # Stop the program so that it can be resumed</span>
<span class="sd">            # It provokes a STOP (pause until the operator desires to resume)</span>
<span class="sd">            program.Pause()</span>

<span class="sd">            # Add a program call or specific code in the program:</span>
<span class="sd">            program.RunInstruction(&#39;ChangeTool(2)&#39;,INSTRUCTION_CALL_PROGRAM)</span>
<span class="sd">            program.RunInstruction(&#39;ChangeTool(2);&#39;,INSTRUCTION_INSERT_CODE)</span>

<span class="sd">            # Set a digital output</span>
<span class="sd">            program.setDO(&#39;DO_NAME&#39;, 1)</span>
<span class="sd">            # Wait for a digital input:</span>
<span class="sd">            program.waitDI(&#39;DI_NAME&#39;, 1)</span>

<span class="sd">        Example 3 - Add movements with external axes:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Add a new movement involving external axes:</span>

<span class="sd">            # First: create a new target</span>
<span class="sd">            target = RDK.AddTarget(&quot;T1&quot;, reference)</span>

<span class="sd">            # Set the target as Cartesian (default)</span>
<span class="sd">            target.setAsCartesianTarget()</span>

<span class="sd">            # Specify the position of the external axes:</span>
<span class="sd">            external_axes = [10, 20]</span>
<span class="sd">            # The robot joints are calculated to reach the target</span>
<span class="sd">            # given the position of the external axes</span>
<span class="sd">            target.setJoints([0,0,0,0,0,0] + external_axes)</span>

<span class="sd">            # Specify the pose (position with respect to the reference frame):</span>
<span class="sd">            target.setPose(KUKA_2_Pose([x,y,z,w,p,r]))</span>

<span class="sd">            # Add a new movement instruction linked to that target:</span>
<span class="sd">            program.MoveJ(target)</span>

<span class="sd">        Example 4 - Add a program call after each movement instruction inside a program:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *    # API to communicate with RoboDK</span>
<span class="sd">            from robodk import *      # basic matrix operations</span>
<span class="sd">            RDK = Robolink()</span>

<span class="sd">            # Ask the user to select a program:</span>
<span class="sd">            prog = RDK.ItemUserPick(&quot;Select a Program to modify&quot;, ITEM_TYPE_PROGRAM)</span>
<span class="sd">            if not prog.Valid():</span>
<span class="sd">                print(&quot;Operation cancelled or no programs available&quot;)</span>
<span class="sd">                quit()</span>

<span class="sd">            # Ask the user to enter a function call that will be added after each movement:</span>
<span class="sd">            print(&quot;Program selected: &quot; + prog.Name())</span>
<span class="sd">            ins_call = mbox(&quot;Enter a program call to add after each movement&quot;, entry=&quot;SynchRobot&quot;)</span>
<span class="sd">            if not ins_call:</span>
<span class="sd">                print(&quot;Operation cancelled&quot;)</span>
<span class="sd">                quit()</span>

<span class="sd">            # Iterate through all the instructions in a program:</span>
<span class="sd">            ins_id = 0</span>
<span class="sd">            ins_count = prog.InstructionCount()</span>
<span class="sd">            while ins_id &lt; ins_count:</span>
<span class="sd">                # Retrieve instruction</span>
<span class="sd">                ins_nom, ins_type, move_type, isjointtarget, pose, joints = prog.Instruction(ins_id)</span>
<span class="sd">                if ins_type == INS_TYPE_MOVE:</span>
<span class="sd">                    # Select the movement instruction as a reference</span>
<span class="sd">                    prog.InstructionSelect(ins_id)</span>
<span class="sd">                    # Add a new program call</span>
<span class="sd">                    prog.RunInstruction(ins_call, INSTRUCTION_CALL_PROGRAM)</span>
<span class="sd">                    # Advance one additional instruction as we just added another instruction</span>
<span class="sd">                    ins_id = ins_id + 1</span>
<span class="sd">                    ins_count = ins_count + 1</span>

<span class="sd">                ins_id = ins_id + 1</span>

<span class="sd">        More examples to generate programs directly from your script or move the robot directly from your program here:</span>
<span class="sd">        :ref:`lbl-move-through-points`. or the macro available in RoboDK/Library/Macros/MoveRobotThroughLine.py</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_PROG&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemrobot</span><span class="p">)</span>
            <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.AddMillingProject"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddMillingProject">[docs]</a>    <span class="k">def</span> <span class="nf">AddMillingProject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Milling settings&quot;</span><span class="p">,</span> <span class="n">itemrobot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete, use :func:`~robolink.Robolink.AddMachiningProject` instead&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddMachiningProject</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">itemrobot</span><span class="p">)</span></div>

<div class="viewcode-block" id="Robolink.AddMachiningProject"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.AddMachiningProject">[docs]</a>    <span class="k">def</span> <span class="nf">AddMachiningProject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Milling settings&quot;</span><span class="p">,</span> <span class="n">itemrobot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new robot machining project. Machining projects can also be used for 3D printing, following curves and following points.</span>
<span class="sd">        It returns the newly created :class:`.Item` containing the project settings.</span>
<span class="sd">        Tip: Use the MoveRobotThroughLine.py macro to see an example that creates a new &quot;curve follow project&quot; given a list of points to follow (Option 4).</span>

<span class="sd">        :param str name: Name of the project settings</span>
<span class="sd">        :param itemrobot: Robot to use for the project settings (optional). It is not required to specify the robot if only one robot or mechanism is available in the RoboDK station.</span>
<span class="sd">        :type itemrobot: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setMachiningParameters`&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_MACHINING&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemrobot</span><span class="p">)</span>
            <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">newitem</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<div class="viewcode-block" id="Robolink.RunProgram"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.RunProgram">[docs]</a>    <span class="k">def</span> <span class="nf">RunProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcn_param</span><span class="p">,</span> <span class="n">wait_for_finished</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run a program (start a program). If the program exists in the RoboDK station it has the same behavior as right clicking a and selecting Run (or Run Python script for Python programs).</span>
<span class="sd">        When generating a program offline (Offline Programming), the program call will be generated in the program output (RoboDK will handle the syntax when the code is generated for a specific robot using the post processor).</span>

<span class="sd">        :param fcn_param: program name and parameters. Parameters can be provided for Python programs available in the RoboDK station as well.</span>
<span class="sd">        :type fcn_param: str</span>
<span class="sd">        :param bool wait_for_finished: Set to True to block execution during a simulation until the program finishes (skipped if the program does not exist or when the program is generated)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Item`, :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.Busy`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wait_for_finished</span><span class="p">:</span>
            <span class="n">prog_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="n">fcn_param</span><span class="p">,</span> <span class="n">ITEM_TYPE_PROGRAM</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prog_item</span><span class="o">.</span><span class="n">Valid</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid program </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fcn_param</span><span class="p">)</span>
            <span class="n">prog_status</span> <span class="o">=</span> <span class="n">prog_item</span><span class="o">.</span><span class="n">RunProgram</span><span class="p">()</span>
            <span class="n">prog_item</span><span class="o">.</span><span class="n">WaitFinished</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prog_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RunCode</span><span class="p">(</span><span class="n">fcn_param</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prog_status</span></div>

<div class="viewcode-block" id="Robolink.RunCode"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.RunCode">[docs]</a>    <span class="k">def</span> <span class="nf">RunCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">code_is_fcn_call</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a program call or a customized instruction output in a program.</span>
<span class="sd">        If code_is_fcn_call is set to True it has the same behavior as RDK.RunProgram(). In this case, when generating a program offline (offline programming), a function/procedure call will be generated in the program output (RoboDK will handle the syntax when the code is generated for a specific robot using the post processor).</span>
<span class="sd">        If the program exists it will also run the program in simulate mode.</span>

<span class="sd">        :param code: program name or code to generate</span>
<span class="sd">        :type code: str</span>
<span class="sd">        :param code_is_fcn_call: Set to True if the provided code corresponds to a function call (same as RunProgram()), if so, RoboDK will handle the syntax when the code is generated for a specific robot.</span>
<span class="sd">        :type code_is_fcn_call: bool</span>

<span class="sd">        Example to run an existing program in the RoboDK station:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            RDK.RunCode(&quot;Prog1&quot;, True)              # Run a program named Prog1 available in the RoboDK station</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunCode&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">code_is_fcn_call</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">))</span>
            <span class="n">prog_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">prog_status</span></div>

<div class="viewcode-block" id="Robolink.RunMessage"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.RunMessage">[docs]</a>    <span class="k">def</span> <span class="nf">RunMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">message_is_comment</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show a message or a comment in the program generated offline (program generation). The message (or code) is displayed on the teach pendant of the robot.</span>

<span class="sd">        :param str message: message or comment to display.</span>
<span class="sd">        :param bool message_is_comment: Set to True to generate a comment in the generated code instead of displaying a message on the teach pendant of the robot.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Message: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunMessage&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">message_is_comment</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Render"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Render">[docs]</a>    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_render</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display/render the scene: update the display. This function turns default rendering (rendering after any modification of the station unless always_render is set to true).</span>
<span class="sd">        Use Update to update the internal links of the complete station without rendering (when a robot or item has been moved).</span>

<span class="sd">        :param bool always_render: Set to True to update the screen every time the station is modified (default behavior when Render() is not used).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Update`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># auto_render = not always_render</span>
        <span class="k">if</span> <span class="n">always_render</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">auto_render</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">always_render</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">auto_render</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">always_render</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">auto_render</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Render&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">auto_render</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Update"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Update">[docs]</a>    <span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the screen. This updates the position of all robots and internal links according to previously set values.</span>
<span class="sd">        This function is useful when Render is turned off (Example: &quot;RDK.Render(False)&quot;). Otherwise, by default RoboDK will update all links after any modification of the station (when robots or items are moved).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Render`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Refresh&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.IsInside"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.IsInside">[docs]</a>    <span class="k">def</span> <span class="nf">IsInside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_inside</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return 1 (True) if object_inside is inside the object, otherwise, it returns 0 (False). Both objects must be of type :class:`.Item`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;IsInside&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">object_inside</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">inside</span></div>

<div class="viewcode-block" id="Robolink.setCollisionActive"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setCollisionActive">[docs]</a>    <span class="k">def</span> <span class="nf">setCollisionActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_state</span><span class="o">=</span><span class="n">COLLISION_ON</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set collision checking ON or OFF (COLLISION_ON/COLLISION_OFF) for a specific pair of objects (:class:`.Item`). This allows altering the collision map for Collision checking.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setCollisionActivePair`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collision_SetState&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">check_state</span><span class="p">)</span>
        <span class="n">ncollisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ncollisions</span></div>

<div class="viewcode-block" id="Robolink.setCollisionActivePair"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setCollisionActivePair">[docs]</a>    <span class="k">def</span> <span class="nf">setCollisionActivePair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_state</span><span class="p">,</span> <span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">,</span> <span class="n">id1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">id2</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set collision checking ON or OFF (COLLISION_ON/COLLISION_OFF) for a specific pair of objects. Specify the link id for robots or moving mechanisms (id 0 is the base)</span>
<span class="sd">        Returns 1 if succeeded. Returns 0 if setting the pair failed (wrong id is provided)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setCollisionActive`, :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collision_SetPair&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">check_state</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.setCollisionActivePairList"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setCollisionActivePairList">[docs]</a>    <span class="k">def</span> <span class="nf">setCollisionActivePairList</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">list_check_state</span><span class="p">,</span> <span class="n">list_item1</span><span class="p">,</span> <span class="n">list_item2</span><span class="p">,</span> <span class="n">list_id1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_id2</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set collision checking ON or OFF (COLLISION_ON/COLLISION_OFF) for a specific list of pairs of objects. This allows altering the collision map for Collision checking.</span>
<span class="sd">        Specify the link id for robots or moving mechanisms (id 0 is the base).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setCollisionActive`, :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Item.setCollisionActivePair`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npairs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_check_state</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_item1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_item2</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;Collision_SetPairList&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">npairs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npairs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">list_item1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">list_item2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">id1</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">id2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">list_id1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_id1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">id1</span> <span class="o">=</span> <span class="n">list_id1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">list_id2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_id2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">id2</span> <span class="o">=</span> <span class="n">list_id2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">list_check_state</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.Collisions"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Collisions">[docs]</a>    <span class="k">def</span> <span class="nf">Collisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of pairs of objects that are currently in a collision state.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setCollisionActive`, :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Robolink.CollisionItems`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collisions&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">ncollisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ncollisions</span></div>

<div class="viewcode-block" id="Robolink.Collision"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Collision">[docs]</a>    <span class="k">def</span> <span class="nf">Collision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns 1 if item1 and item2 collided. Otherwise returns 0.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Robolink.CollisionItems`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collided&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item2</span><span class="p">)</span>
        <span class="n">ncollisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ncollisions</span></div>

<div class="viewcode-block" id="Robolink.CollisionItems"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CollisionItems">[docs]</a>    <span class="k">def</span> <span class="nf">CollisionItems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of items that are in a collision state. This function can be used after calling Collisions() to retrieve the items that are in a collision state.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collision_Items&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nitems</span><span class="p">):</span>
            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">())</span>
            <span class="n">link_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>  <span class="c1"># link id for robot items (ignored)</span>
            <span class="n">collision_times</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="p">)</span>  <span class="c1"># number of objects it is in collisions with</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item_list</span></div>

<div class="viewcode-block" id="Robolink.CollisionPairs"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CollisionPairs">[docs]</a>    <span class="k">def</span> <span class="nf">CollisionPairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of pairs of items that are in a collision state.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Collisions`, :func:`~robolink.Item.Visible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Collision_Pairs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nitems</span><span class="p">):</span>
            <span class="n">item_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="n">id_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="n">item_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
            <span class="n">id_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item_1</span><span class="p">,</span> <span class="n">item_2</span><span class="p">,</span> <span class="n">id_1</span><span class="p">,</span> <span class="n">id_2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item_list</span></div>

<div class="viewcode-block" id="Robolink.setSimulationSpeed"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setSimulationSpeed">[docs]</a>    <span class="k">def</span> <span class="nf">setSimulationSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the simulation speed.</span>
<span class="sd">        A simulation speed of 5 (default) means that 1 second of simulation time equals to 5 seconds in a real application.</span>
<span class="sd">        The slowest speed ratio allowed is 0.001. Set a large simmulation ratio (&gt;100) for fast simulation results.</span>

<span class="sd">        :param speed: simulation ratio</span>
<span class="sd">        :type speed: float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.SimulationSpeed`, :func:`~robolink.Robolink.SimulationTime`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;SimulateSpeed&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">speed</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.SimulationSpeed"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.SimulationSpeed">[docs]</a>    <span class="k">def</span> <span class="nf">SimulationSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the simulation speed. A simulation speed of 1 means real-time simulation.</span>
<span class="sd">        A simulation speed of 5 (default) means that 1 second of simulation time equals to 5 seconds in a real application.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setSimulationSpeed`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;GetSimulateSpeed&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">speed</span></div>

<div class="viewcode-block" id="Robolink.SimulationTime"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.SimulationTime">[docs]</a>    <span class="k">def</span> <span class="nf">SimulationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the simulation time (in seconds). Time of 0 seconds starts with the first time this function is called.</span>
<span class="sd">        The simulation time changes depending on the simulation speed. The simulation time is usually faster than the real time (5 times by default).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setSimulationSpeed`, :func:`~robolink.Robolink.SimulationSpeed`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;GetSimTime&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">speed</span></div>

<div class="viewcode-block" id="Robolink.setRunMode"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setRunMode">[docs]</a>    <span class="k">def</span> <span class="nf">setRunMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the run mode (behavior) of the script, for either simulation, offline programming or online programming.</span>
<span class="sd">        By default, robodk shows the path simulation for movement instructions (run_mode=RUNMODE_SIMULATE).</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available run modes</span>

<span class="sd">            RUNMODE_SIMULATE=1                      # performs the simulation moving the robot (default)</span>
<span class="sd">            RUNMODE_QUICKVALIDATE=2                 # performs a quick check to validate the robot movements</span>
<span class="sd">            RUNMODE_MAKE_ROBOTPROG=3                # makes the robot program</span>
<span class="sd">            RUNMODE_MAKE_ROBOTPROG_AND_UPLOAD=4     # makes the robot program and updates it to the robot</span>
<span class="sd">            RUNMODE_MAKE_ROBOTPROG_AND_START=5      # makes the robot program and starts it on the robot (independently from the PC)</span>
<span class="sd">            RUNMODE_RUN_ROBOT=6                     # moves the real robot from the PC (PC is the client, the robot behaves like a server)</span>

<span class="sd">        The following calls will alter the current run mode:</span>

<span class="sd">        1- :func:`~robolink.Item.Connect` automatically sets RUNMODE_RUN_ROBOT. So it will use the robot driver together with the simulation.</span>

<span class="sd">        2- :func:`~robolink.Robolink.ProgramStart` automatically sets the mode to RUNMODE_MAKE_ROBOTPROG. So it will generate the program</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.RunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_RunMode&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">run_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.RunMode"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.RunMode">[docs]</a>    <span class="k">def</span> <span class="nf">RunMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current run mode (behavior) of the script.</span>
<span class="sd">        By default, robodk simulates any movements requested from the API (such as prog.MoveL) simulation for movement instructions (run_mode=RUNMODE_SIMULATE).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_RunMode&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">runmode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">runmode</span></div>

<div class="viewcode-block" id="Robolink.getParams"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.getParams">[docs]</a>    <span class="k">def</span> <span class="nf">getParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all the user parameters from the open RoboDK station.</span>
<span class="sd">        Station parameters can also be modified manually by right clicking the station item and selecting &quot;Station parameters&quot;</span>
<span class="sd">        :return: list of pairs of strings</span>
<span class="sd">        :rtype: list of str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.getParam` (Robolink station parameter), :func:`~robolink.Robolink.setParam` (Robolink station parameter)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Params&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nparam</span><span class="p">):</span>
            <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                <span class="c1"># automatically convert int, long and float</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">params</span></div>

<div class="viewcode-block" id="Robolink.getParam"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.getParam">[docs]</a>    <span class="k">def</span> <span class="nf">getParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s2">&quot;PATH_OPENSTATION&quot;</span><span class="p">,</span> <span class="n">str_type</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a global or a station parameter from the open RoboDK station.</span>
<span class="sd">        Station parameters can also be modified manually by right clicking the station item and selecting &quot;Station parameters&quot;</span>

<span class="sd">        :param str param: name of the parameter</span>
<span class="sd">        :param bool str_type: True to retrieve a string parameter (False for binary/bytes type)</span>
<span class="sd">        :return: value of the parameter.</span>
<span class="sd">        :rtype: str, float or None if the parameter is unknown</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available global parameters</span>

<span class="sd">            PATH_OPENSTATION       # Full path of the current station (.rdk file)</span>
<span class="sd">            FILE_OPENSTATION       # File name of the current station (name of the .rdk file)</span>
<span class="sd">            PATH_DESKTOP           # Full path to the desktop folder</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setParam` (Robolink station parameter), :func:`~robolink.Robolink.getParams`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">str_type</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Param&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;UNKNOWN &quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                <span class="c1"># automatically convert int, long and float</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">value</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_DataParam&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_bytes</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Robolink.setParam"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setParam">[docs]</a>    <span class="k">def</span> <span class="nf">setParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a station parameter. If the parameters exists, it will be updated. Otherwise, it will be added to the station.</span>

<span class="sd">        :param str param: name of the parameter</span>
<span class="sd">        :param str value: value of the parameter (value type can be str or bytes)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.getParam`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_DataParam&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Param&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Command"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Command">[docs]</a>    <span class="k">def</span> <span class="nf">Command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a special command. These commands are meant to have a specific effect in RoboDK, such as changing a specific setting or provoke specific events.</span>

<span class="sd">        :param str command: Command Name, such as Trace, Threads or Window.</span>
<span class="sd">        :param str value: Comand value (optional, not all commands require a value)</span>

<span class="sd">        Select **Tools-Run Script-Show Commands** to see all available commands.</span>

<span class="sd">        .. image:: Commands.png</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example commands</span>

<span class="sd">            from robolink import *</span>
<span class="sd">            RDK = Robolink()      # Start the RoboDK API</span>

<span class="sd">            # How to change the number of threads using by the RoboDK application:</span>
<span class="sd">            RDK.Command(&quot;Threads&quot;, &quot;4&quot;)</span>

<span class="sd">            # How to change the default behavior of 3D view using the mouse:</span>
<span class="sd">            RDK.Command(&quot;MouseClick_Left&quot;, &quot;Select&quot;)   # Set the left mouse click to select</span>
<span class="sd">            RDK.Command(&quot;MouseClick_Mid&quot;, &quot;Pan&quot;)       # Set the mid mouse click to Pan the 3D view</span>
<span class="sd">            RDK.Command(&quot;MouseClick_Right&quot;, &quot;Rotate&quot;)  # Set the right mouse click to Rotate the 3D view</span>

<span class="sd">            RDK.Command(&quot;MouseClick&quot;, &quot;Default&quot;)       # Set the default mouse 3D navigation settings</span>

<span class="sd">            # Provoke a resize event</span>
<span class="sd">            RDK.Command(&quot;Window&quot;, &quot;Resize&quot;)</span>

<span class="sd">            # Reset the trace</span>
<span class="sd">            RDK.Command(&quot;Trace&quot;, &quot;Reset&quot;)</span>


<span class="sd">        You can also pass commands through command line when starting RoboDK or when RoboDK is already running (add &#39;-&#39; to the command name).</span>
<span class="sd">        More information about command line options available in the documentation: https://robodk.com/doc/en/RoboDK-API.html#CommandLine</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to start RoboDK in Chinese and white background using 6 threads and load a RoboDK project file</span>

<span class="sd">            RoboDK -Lang=zh -ColorBgBottom=white -ColorBgTop=white -Threads=6 &quot;path-to-file.rdk&quot;</span>


<span class="sd">        .. seealso:: :func:`~robolink.Item.setParam` (Item parameter/command), :func:`~robolink.Robolink.setParam` (Robolink station parameter)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="c1"># return dict if we provided a dict</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">:</span>
            <span class="c1"># Special 2D matrix write/read</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Gen_Mat&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
            <span class="n">nmats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
            <span class="n">mat2d_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmats</span><span class="p">):</span>
                <span class="n">mat2d_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">())</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">mat2d_list</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;SCMD&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">line</span></div>

<div class="viewcode-block" id="Robolink.getOpenStations"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.getOpenStations">[docs]</a>    <span class="k">def</span> <span class="nf">getOpenStations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of open stations in RoboDK</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setActiveStation`, :func:`~robolink.Robolink.getParam`, :func:`~robolink.Item.Childs`, :func:`~robolink.Item.Save`, :func:`~robolink.Robolink.AddStation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_AllStn&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nstn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">list_stn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstn</span><span class="p">):</span>
            <span class="n">list_stn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_stn</span></div>

<div class="viewcode-block" id="Robolink.ActiveStation"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ActiveStation">[docs]</a>    <span class="k">def</span> <span class="nf">ActiveStation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the active station item (station currently visible)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setActiveStation`, :func:`~robolink.Robolink.getParam`, :func:`~robolink.Item.Childs`, :func:`~robolink.Item.Save`, :func:`~robolink.Robolink.AddStation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ActiveStn&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">stn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">stn</span></div>

<div class="viewcode-block" id="Robolink.setActiveStation"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setActiveStation">[docs]</a>    <span class="k">def</span> <span class="nf">setActiveStation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the active station (project currently visible)</span>

<span class="sd">        :param stn: station item, it can be previously loaded as an RDK file</span>
<span class="sd">        :type stn: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.ActiveStation`, :func:`~robolink.Robolink.getOpenStations`, :func:`~robolink.Robolink.getParam`, :func:`~robolink.Item.Childs`, :func:`~robolink.Robolink.AddFile`, :func:`~robolink.Robolink.AddStation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ActiveStn&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.ShowSequence"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ShowSequence">[docs]</a>    <span class="k">def</span> <span class="nf">ShowSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display a sequence of joints given a list of joints as a matrix.</span>
<span class="sd">        This function can also display a sequence of instructions (RoKiSim format).</span>

<span class="sd">        :param matrix: joint sequence as a 6xN matrix or instruction sequence as a 7xN matrix</span>
<span class="sd">        :type matrix: :class:`.Mat`</span>

<span class="sd">        Tip: use :func:`~robolink.Item.InstructionList` to retrieve the instruction list in RoKiSim format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ShowSequence</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span></div>

<div class="viewcode-block" id="Robolink.LaserTracker_Measure"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.LaserTracker_Measure">[docs]</a>    <span class="k">def</span> <span class="nf">LaserTracker_Measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimate</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">search</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes a measurement using the laser tracker with respect to the tracker reference frame. If an estimate point is provided, the laser tracker will first move to those coordinates. If search is True, the tracker will search for a target.</span>
<span class="sd">        Returns the XYZ coordinates of target if it was found. Othewise it retuns None. For trackers that support a 6D measurement, the returned value with be an array of 6 values (list) to include the Euler angles.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MeasLT2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_xyz</span><span class="p">(</span><span class="n">estimate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">search</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Old versions require checking against 0 mm</span>
        <span class="k">if</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">xyz</span></div>

<div class="viewcode-block" id="Robolink.MeasurePose"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.MeasurePose">[docs]</a>    <span class="k">def</span> <span class="nf">MeasurePose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_avg_ms</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tip_xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes a measurement with a 6D measurement device. It returns two poses, the base reference frame and the measured object reference frame. Status is negative if the measurement failed. extra data is [error_avg, error_max] in mm, if we are averaging a pose.</span>

<span class="sd">        :param time_avg: Take the measurement for a period of time and average the result.</span>
<span class="sd">        :param tip_xyz: Offet the measurement to the tip.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_send</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="p">,</span> <span class="n">time_avg_ms</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tip_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">array_send</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MeasPose4&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">array_send</span><span class="p">)</span>
        <span class="n">pose1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose1</span><span class="p">,</span> <span class="n">data</span></div>

<div class="viewcode-block" id="Robolink.Collision_Line"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Collision_Line">[docs]</a>    <span class="k">def</span> <span class="nf">Collision_Line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">robodk</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Checks the collision between a line and any objects in the station. The line is defined by 2 points.</span>

<span class="sd">        :param p1: start point of the line</span>
<span class="sd">        :type p1: list of float [x,y,z]</span>
<span class="sd">        :param p2: end point of the line</span>
<span class="sd">        :type p2: list of float [x,y,z]</span>
<span class="sd">        :param ref: Reference of the two points with respect to the absolute station reference.</span>
<span class="sd">        :type ref: :class:`.Mat`</span>
<span class="sd">        :return: [collision (True or False), item (collided), point (point of collision with respect to the station)]</span>
<span class="sd">        :rtype: [bool, :class:`.Item`, list of float as xyz]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p1abs</span> <span class="o">=</span> <span class="n">ref</span> <span class="o">*</span> <span class="n">p1</span>
        <span class="n">p2abs</span> <span class="o">=</span> <span class="n">ref</span> <span class="o">*</span> <span class="n">p2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CollisionLine&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_xyz</span><span class="p">(</span><span class="n">p1abs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_xyz</span><span class="p">(</span><span class="n">p2abs</span><span class="p">)</span>
        <span class="n">itempicked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_xyz</span><span class="p">()</span>
        <span class="n">collision</span> <span class="o">=</span> <span class="n">itempicked</span><span class="o">.</span><span class="n">Valid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">collision</span><span class="p">,</span> <span class="n">itempicked</span><span class="p">,</span> <span class="n">xyz</span></div>

<div class="viewcode-block" id="Robolink.setPoses"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setPoses">[docs]</a>    <span class="k">def</span> <span class="nf">setPoses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">poses</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the relative positions (poses) of a list of items with respect to their parent. For example, the position of an object/frame/target with respect to its parent.</span>
<span class="sd">        Use this function instead of setPose() for faster speed.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setPose` (item), :func:`~robolink.Item.Pose` (item), :func:`~robolink.Robolink.setPosesAbs`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poses</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The number of items must match the number of poses&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Hlocals&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">poses</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.setPosesAbs"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setPosesAbs">[docs]</a>    <span class="k">def</span> <span class="nf">setPosesAbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">poses</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the absolute positions (poses) of a list of items with respect to the station reference. For example, the position of an object/frame/target with respect to its parent.</span>
<span class="sd">        Use this function instead of setPose() for faster speed.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setPoseAbs` (item), :func:`~robolink.Item.PoseAbs` (item), :func:`~robolink.Robolink.setPoses`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poses</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The number of items must match the number of poses&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Hlocal_AbsS&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">poses</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.Joints"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Joints">[docs]</a>    <span class="k">def</span> <span class="nf">Joints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot_item_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current joints of a list of robots.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setJoints` (item), :func:`~robolink.Item.Joints` (item), :func:`~robolink.Robolink.setJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ThetasList&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nrobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">robot_item_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">nrobs</span><span class="p">)</span>
        <span class="n">joints_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrobs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot_item_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">joints_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
            <span class="n">joints_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joints_i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints_list</span></div>

<div class="viewcode-block" id="Robolink.setJoints"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setJoints">[docs]</a>    <span class="k">def</span> <span class="nf">setJoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot_item_list</span><span class="p">,</span> <span class="n">joints_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the current robot joints for a list of robot items and a list joints.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setJoints` (item), :func:`~robolink.Item.Joints` (item), :func:`~robolink.Robolink.Joints`&quot;&quot;&quot;</span>
        <span class="n">nrobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">robot_item_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nrobs</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">joints_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;The size of the robot list does not match the size of the joints list&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ThetasList&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">nrobs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrobs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot_item_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.CalibrateTool"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CalibrateTool">[docs]</a>    <span class="k">def</span> <span class="nf">CalibrateTool</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">poses_xyzwpr</span><span class="p">,</span>
        <span class="n">input_format</span><span class="o">=</span><span class="n">EULER_RX_RY_RZ</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">CALIBRATE_TCP_BY_POINT</span><span class="p">,</span>
        <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calibrate a TCP given a list of poses/joints and following a specific algorithm/method.</span>
<span class="sd">        Tip: Provide the list of joints instead of poses to maximize accuracy for calibrated robots.</span>

<span class="sd">        :param poses_xyzwpr: List of points or a list of robot joints (matrix 3xN or nDOFsxN)</span>
<span class="sd">        :type poses_xyzwpr: :class:`.Mat` or a list of list of float</span>
<span class="sd">        :param int input_format: Euler format. Optionally, use JOINT_FORMAT and provide the robot.</span>
<span class="sd">        :param int algorithm: method/algorithm to use to calculate the new TCP. Tip: use CALIBRATE_TCP ...</span>
<span class="sd">        :param robot: the robot must be provided to calculate the reference frame by joints</span>
<span class="sd">        :type robot: :class:`.Item`</span>
<span class="sd">        :param tool: provide a tool item to store the calibration data with that tool (the TCP is not updated, only the calibration joints)</span>
<span class="sd">        :type tool: :class:`.Item`</span>
<span class="sd">        :return: \n</span>
<span class="sd">            [TCP, stats, errors]\n</span>
<span class="sd">            Out 1 (TCP) - The TCP as a list [x,y,z] with respect to the robot flange\n</span>
<span class="sd">            Out 2 (stats) - Statistics as [mean, standard deviation, max] - error stats summary\n</span>
<span class="sd">            Out 3 (errors) - List of errors for each pose (array 1xN)\n</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available Tool Calibration Algorithms</span>

<span class="sd">            CALIBRATE_TCP_BY_POINT      # Take the same point using different orientations</span>
<span class="sd">            CALIBRATE_TCP_BY_PLANE      # Take the same point on a plane</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.CalibrateReference`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span>
        <span class="p">):</span>
            <span class="n">nposes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">input_format</span> <span class="o">=</span> <span class="n">EULER_RX_RYp_RZpp</span>
                <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nposes</span><span class="p">):</span>
                    <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">robodk</span><span class="o">.</span><span class="n">Pose_2_Staubli</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

                <span class="n">poses_xyzwpr</span> <span class="o">=</span> <span class="n">matrix</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CalibTCP3&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">poses_xyzwpr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">input_format</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="p">[</span><span class="n">algorithm</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">TCPxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="n">errorstats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">errors</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">TCPxyz</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="n">errorstats</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="n">errors</span></div>

<div class="viewcode-block" id="Robolink.CalibrateReference"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CalibrateReference">[docs]</a>    <span class="k">def</span> <span class="nf">CalibrateReference</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">joints_points</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">CALIBRATE_FRAME_3P_P1_ON_X</span><span class="p">,</span>
        <span class="n">use_joints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calibrate a reference frame given a number of points and following a specific algorithm/method.</span>
<span class="sd">        Important: Provide the list of joints to maximize accuracy for calibrated robots.</span>

<span class="sd">        :param joints_points: List of points or a list of robot joints (matrix 3xN or nDOFsxN)</span>
<span class="sd">        :type joints_points: :class:`robodk.Mat` or a list of list of float</span>
<span class="sd">        :param int method: method/algorithm to use to calculate the new TCP. Tip: use CALIBRATE_FRAME ...</span>
<span class="sd">        :param bool use_joints: use points or joint values (bool): Set to True if joints_points is a list of joints</span>
<span class="sd">        :param robot: the robot must be provided to calculate the reference frame by joints</span>
<span class="sd">        :type robot: :class:`.Item`</span>
<span class="sd">        :return: The pose of the reference frame with respect to the robot base frame</span>
<span class="sd">        :rtype: :class:`robodk.Mat`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available Reference Frame Calibration Algorithms</span>

<span class="sd">            CALIBRATE_FRAME_3P_P1_ON_X = 0      # Calibrate by 3 points: [X, X+, Y+] (p1 on X axis)</span>
<span class="sd">            CALIBRATE_FRAME_3P_P1_ORIGIN = 1    # Calibrate by 3 points: [Origin, X+, XY+] (p1 is origin)</span>
<span class="sd">            CALIBRATE_FRAME_6P = 2              # Calibrate by 6 points</span>
<span class="sd">            CALIBRATE_TURNTABLE = 3             # Calibrate turntable</span>
<span class="sd">            CALIBRATE_TURNTABLE = 4             # Calibrate 2-axis turntable</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.CalibrateTool`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CalibFrame&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">joints_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">use_joints</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="n">reference_pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="n">stats_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>

        <span class="n">stats_data</span> <span class="o">=</span> <span class="n">stats_data</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="c1"># We&#39;ll receive addditional information when calibrating a 1 axis or 2 axis turntable</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stats_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reference_pose</span><span class="p">,</span> <span class="n">stats_data</span>

        <span class="k">return</span> <span class="n">reference_pose</span></div>

<div class="viewcode-block" id="Robolink.ProgramStart"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ProgramStart">[docs]</a>    <span class="k">def</span> <span class="nf">ProgramStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">programname</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">postprocessor</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Defines the name of the program when the program is generated (offline programming).</span>
<span class="sd">        It is also possible to specify the name of the post processor as well as the folder to save the program.</span>
<span class="sd">        This method must be called before any program output is generated (before any robot movement or other instruction).</span>

<span class="sd">        :param str progname: Name of the program</span>
<span class="sd">        :param str folder: Folder to save the program, leave empty to use the default program folder (usually Desktop)</span>
<span class="sd">        :param str postprocessor: Name of the post processor. For example, to select the post processor C:/RoboDK/Posts/Fanuc_RJ3.py, specify &quot;Fanuc_RJ3.py&quot; or simply &quot;Fanuc_RJ3&quot;.</span>
<span class="sd">        :param robot: Robot used for program generation</span>
<span class="sd">        :type robot: :class:`.Item`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            robot = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)   # use the first available robot</span>
<span class="sd">            RDK.ProgramStart(&#39;Prog1&#39;,&#39;C:/MyProgramFolder/&#39;, &quot;ABB_RAPID_IRC5&quot;, robot)  # specify the program name for program generation</span>
<span class="sd">            # RDK.setRunMode(RUNMODE_MAKE_ROBOTPROG) # redundant</span>
<span class="sd">            robot.MoveJ(target)                     # make a simulation</span>
<span class="sd">            ...</span>
<span class="sd">            RDK.Finish()                            # Provokes the program generation (disconnects the API)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode`, :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Robolink.Finish`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ProgramStart&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">programname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">postprocessor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">robot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">errors</span></div>

<div class="viewcode-block" id="Robolink.setViewPose"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setViewPose">[docs]</a>    <span class="k">def</span> <span class="nf">setViewPose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the pose of the wold reference frame with respect to the view (camera/screen)</span>

<span class="sd">        :param pose: pose of the item with respect to its parent</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ViewPose&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.ViewPose"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.ViewPose">[docs]</a>    <span class="k">def</span> <span class="nf">ViewPose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the pose of the wold reference frame with respect to the view (camera/screen)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ViewPose&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Robolink.BuildMechanism"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.BuildMechanism">[docs]</a>    <span class="k">def</span> <span class="nf">BuildMechanism</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">,</span>
        <span class="n">list_obj</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">joints_build</span><span class="p">,</span>
        <span class="n">joints_home</span><span class="p">,</span>
        <span class="n">joints_senses</span><span class="p">,</span>
        <span class="n">joints_lim_low</span><span class="p">,</span>
        <span class="n">joints_lim_high</span><span class="p">,</span>
        <span class="n">base</span><span class="o">=</span><span class="n">robodk</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">tool</span><span class="o">=</span><span class="n">robodk</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;New robot&quot;</span><span class="p">,</span>
        <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new robot or mechanism.</span>

<span class="sd">        :param int type: Type of the mechanism</span>
<span class="sd">        :param list list_obj: list of object items that build the robot</span>
<span class="sd">        :param list parameters: robot parameters in the same order as shown in the RoboDK menu: Utilities-Build Mechanism or robot</span>
<span class="sd">        :param list_joints_build: current state of the robot (joint axes) to build the robot</span>
<span class="sd">        :param list joints_home: joints for the home position (it can be changed later)</span>
<span class="sd">        :param robot: existing robot in the station to replace it (optional)</span>
<span class="sd">        :type robot: :class:`.Item`</span>
<span class="sd">        :param str name: robot name</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Start the RoboDK API</span>
<span class="sd">            from robolink import *</span>
<span class="sd">            from robodk import *</span>
<span class="sd">            RDK = Robolink()</span>

<span class="sd">            # Define your new robot or mechanism</span>
<span class="sd">            # Example to create a Fanuc LR Mate 200iD robot</span>
<span class="sd">            robot_name = &#39;Fanuc LR Mate 200iD&#39;</span>
<span class="sd">            DOFs       = 6</span>

<span class="sd">            # Define the joints of the robot/mechanism</span>
<span class="sd">            joints_build = [0, 0, 0, 0, 0, 0]</span>

<span class="sd">            # Define the home position of the robot/mechanism (default position when you build the mechanism)</span>
<span class="sd">            # This is also the position the robot goes to if you select &quot;Home&quot;</span>
<span class="sd">            joints_home   = [0, 0, 0, 0, 0, 0]</span>

<span class="sd">            # Define the robot parameters. The parameters must be provided in the same order they appear</span>
<span class="sd">            #     in the menu Utilities-Model Mechanism or robot</span>
<span class="sd">            # Some basic mechanisms such as 1 or 2 axis translation/rotation axes don&#39;t need any parameters</span>
<span class="sd">            #     (translation/rotation will happen around the Z axis)</span>
<span class="sd">            #parameters = []</span>
<span class="sd">            parameters = [330, 50, 0, 330, 35, 335, 80, 0, -90, 0, 0, 0, 0]</span>

<span class="sd">            # Define the joint sense (set to +1 or -1 for each axis (+1 is used as a reference for the ABB IRB120 robot)</span>
<span class="sd">            joints_senses   = [+1, +1, -1,  -1, -1, -1] # add -1 as 7th index to account for axis 2 and axis 3 coupling</span>

<span class="sd">            # Joint limits (lower limits for each axis)</span>
<span class="sd">            lower_limits  = [-170, -100, -67, -190, -125, -360]</span>

<span class="sd">            # Joint limits (upper limits for each axis)</span>
<span class="sd">            upper_limits  = [ 170,  145, 213,  190,  125,  360]</span>

<span class="sd">            # Base frame pose (offset the model by applying a base frame transformation)</span>
<span class="sd">            #base_pose   = xyzrpw_2_pose([0, 0, 0, 0, 0, 0])</span>
<span class="sd">            # Fanuc and Motoman robots have the base frame at the intersection of axes 1 and 2</span>
<span class="sd">            base_pose   = xyzrpw_2_pose([0, 0, -330, 0, 0, 0])</span>

<span class="sd">            # Tool frame pose (offset the tool flange by applying a tool frame transformation)</span>
<span class="sd">            tool_pose   = xyzrpw_2_pose([0, 0, 0, 0, 0, 0])</span>

<span class="sd">            # Retrieve all your items from RoboDK (they should be previously loaded manually or using the API&#39;s command RDK.AddFile())</span>
<span class="sd">            list_objects   = []</span>
<span class="sd">            for i in range(DOFs + 1):</span>
<span class="sd">               if i == 0:</span>
<span class="sd">                   itm = RDK.Item(robot_name + &#39; Base&#39;, ITEM_TYPE_OBJECT)</span>
<span class="sd">               else:</span>
<span class="sd">                   itm = RDK.Item(robot_name + &#39; &#39; + str(i), ITEM_TYPE_OBJECT)</span>

<span class="sd">               list_objects.append(itm)</span>

<span class="sd">            # Create the robot/mechanism</span>
<span class="sd">            new_robot = RDK.BuildMechanism(MAKE_ROBOT_6DOF, list_objects, parameters, joints_build, joints_home, joints_senses, lower_limits, upper_limits, base_pose, tool_pose, robot_name)</span>
<span class="sd">            if not new_robot.Valid():</span>
<span class="sd">                print(&quot;Failed to create the robot. Check input values.&quot;)</span>
<span class="sd">            else:</span>
<span class="sd">                print(&quot;Robot/mechanism created: &quot; + new_robot.Name())</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># calculate the number of degrees of freedom</span>
        <span class="n">ndofs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_obj</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;BuildMechanism&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">ndofs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndofs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">list_obj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">joints_build</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">joints_build</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">12</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">joints_build</span><span class="p">))</span>
        <span class="n">joints_data</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">joints_build</span><span class="p">,</span> <span class="n">joints_home</span><span class="p">,</span> <span class="n">joints_senses</span><span class="p">,</span> <span class="n">joints_lim_low</span><span class="p">,</span> <span class="n">joints_lim_high</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">joints_data</span><span class="p">)</span>
        <span class="n">robot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">robot</span></div>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># ----------------------- CAMERA VIEWS ----------------------------</span>
<div class="viewcode-block" id="Robolink.Cam2D_Add"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Cam2D_Add">[docs]</a>    <span class="k">def</span> <span class="nf">Cam2D_Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_object</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cam_params</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">camera_item</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a simulated 2D camera view. Returns a handle pointer that can be used in case more than one simulated view is used.</span>

<span class="sd">        :param item_object: object to attach the camera</span>
<span class="sd">        :type item_object: :class:`.Item`</span>
<span class="sd">        :param str cam_params: Camera parameters as a string. Add one or more commands as shown in the following example.</span>
<span class="sd">        :param camera_item: Use an existing camera item to modify settings and open the view (supported on RoboDK v5.0 and later)</span>
<span class="sd">        :type camera_item: :class:`.Item`</span>


<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *    # API to communicate with RoboDK</span>
<span class="sd">            from robodk import *      # library for basic matrix operations</span>
<span class="sd">            RDK = Robolink()</span>

<span class="sd">            # Close any open 2D camera views</span>
<span class="sd">            RDK.Cam2D_Close()</span>

<span class="sd">            camref = RDK.ItemUserPick(&#39;Select the Camera location (reference, tool or object)&#39;)</span>
<span class="sd">            #camref = RDK.Item(&#39;Frame 7&#39;,ITEM_TYPE_FRAME)</span>

<span class="sd">            # Set parameters in mm and degrees:</span>
<span class="sd">            #  FOV: Field of view in degrees (2*atan(0.5*height/distance) of the sensor</span>
<span class="sd">            #  FOCAL_LENGHT: focal lenght in mm</span>
<span class="sd">            #  FAR_LENGHT: maximum working distance (in mm)</span>
<span class="sd">            #  PIXELSIZE: Size of the pixel in micro meters (square size assumed)</span>
<span class="sd">            #  SIZE: size of the window in pixels (fixed) (width x height)</span>
<span class="sd">            #    WINDOWFIXED: If we specify the Size, make the size of the window exactly the same size</span>
<span class="sd">            #    WINDOWRESIZE: Even if we specify the size</span>
<span class="sd">            #  SNAPSHOT: size of the snapshot image in pixels if it should be different from the normal size (width x height). Size can be larger than 4k, depending on graphics card support.</span>
<span class="sd">            #  BG_COLOR: background color (rgb color or named color: AARRGGBB)</span>
<span class="sd">            #  LIGHT_AMBIENT: ambient color (rgb color or named color: AARRGGBB)</span>
<span class="sd">            #  LIGHT_SPECULAR: specular color (rgb color or named color: AARRGGBB)</span>
<span class="sd">            #  LIGHT_DIFFUSE: diffuse color (rgb color or named color: AARRGGBB)</span>
<span class="sd">            #  DEPTH: Add this flag to create a 32 bit depth map (white=close, black=far)</span>
<span class="sd">            #  GRAYSCALE: Add this flag to create a grayscale image</span>
<span class="sd">            #  NO_TASKBAR: Don&#39;t add the window to the task bar</span>
<span class="sd">            #  MINIMIZED: Show the window minimized</span>
<span class="sd">            #  ALWAYS_VISIBLE: Keep the window on top of all other windows</span>
<span class="sd">            #  DOCKED: Show the view as a docked window (not a separate window)</span>
<span class="sd">            #  SHADER_VERTEX: File to a vertex shader (GLSL file)</span>
<span class="sd">            #  SHADER_FRAGMENT: File to a fragment shader (GLSL file)</span>

<span class="sd">            # Examples to call Camd2D_Add:</span>

<span class="sd">            # Camera without a fixed window size and 1000 mm length</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000&#39;)</span>

<span class="sd">            # Camera with a fixed window size and 1000 mm length</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480&#39;)</span>

<span class="sd">            # Camera with a black background</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 BG_COLOR=black&#39;)</span>

<span class="sd">            # Camera without a fixed window size and high resolution snapshot</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480&#39;)</span>

<span class="sd">            # Depth view: 32 bit depth map (white=close, black=far)</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 DEPTH&#39;)</span>

<span class="sd">            # Minimized camera</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 MINIMIZED&#39;)</span>

<span class="sd">            # Do not show the camera window in the taskbar</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 NO_TASKBAR&#39;)</span>

<span class="sd">            # Customize the light</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 BG_COLOR=black LIGHT_AMBIENT=red LIGHT_DIFFUSE=#FF00FF00 LIGHT_SPECULAR=black&#39;)</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=600 SIZE=640x480 BG_COLOR=black LIGHT_AMBIENT=red LIGHT_DIFFUSE=black LIGHT_SPECULAR=white&#39;)</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=1000 SIZE=640x480 LIGHT_AMBIENT=red&#39;)</span>

<span class="sd">            # Provoke a popup and allow the user to enter some parameters</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;POPUP&#39;)</span>

<span class="sd">            # Example to take a snapshot from the camera</span>
<span class="sd">            RDK.Cam2D_Snapshot(RDK.getParam(&#39;PATH_OPENSTATION&#39;) + &quot;/sample_image.png&quot;, cam_id)</span>

<span class="sd">            # Special command to retrieve the window ID:</span>
<span class="sd">            win_id = RDK.Command(&quot;CamWinID&quot;, str(cam_id))</span>
<span class="sd">            # print(str(win_id))</span>

<span class="sd">            #-----------------------------------------------------------------------------------</span>
<span class="sd">            # Example to use a customized shader to customize the effect of light</span>
<span class="sd">            # Tip: Use the example: C:/RoboDK/Library/Example-Shader-Customized-Light.rdk</span>
<span class="sd">            # Tip: If you need a fixed light source update the variable light_Position in the shader_fragment.glsl file</span>

<span class="sd">            # Get the path to the RoboDK library (usually in C:/RoboDK/Library/)</span>
<span class="sd">            path_library = RDK.getParam(&quot;PATH_LIBRARY&quot;)</span>
<span class="sd">            file_shader_fragment = path_library + &#39;/Macros/Camera-Shaders/shader_fragment.glsl&#39;</span>
<span class="sd">            file_shader_vertex = path_library + &#39;/Macros/Camera-Shaders/shader_vertex.glsl&#39;</span>
<span class="sd">            cam_id = RDK.Cam2D_Add(camref, &#39;FOCAL_LENGHT=6 FOV=32 FAR_LENGHT=2500 SHADER_FRAGMENT=&#39; + file_shader_fragment + &#39; SHADER_VERTEX=&#39; + file_shader_vertex)</span>


<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Cam2D_Snapshot`, :func:`~robolink.Robolink.Cam2D_Close`, :func:`~robolink.Robolink.Cam2D_SetParams`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CAMERA_AS_ITEM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">17779</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_PtrAdd&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item_object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">camera_item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">cam_params</span><span class="p">)</span>
            <span class="n">cam_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_Add&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item_object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">cam_params</span><span class="p">)</span>
            <span class="n">cam_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_ptr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cam_handle</span></div>

<div class="viewcode-block" id="Robolink.Cam2D_Snapshot"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Cam2D_Snapshot">[docs]</a>    <span class="k">def</span> <span class="nf">Cam2D_Snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_save_img</span><span class="p">,</span> <span class="n">cam_handle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Take a snapshot from a simulated camera view and save it to a file. Returns 1 if success, 0 otherwise.</span>

<span class="sd">        :param str file_save_img: file path to save. Formats supported include PNG, JPEG, TIFF, ...</span>
<span class="sd">        :param int cam_handle: camera handle (pointer returned by Cam2D_Add)</span>
<span class="sd">        :param str params: additional options (use, &quot;Grayscale&quot;, &quot;Depth&quot; or &quot;Color&quot; to modify the camera snapshot)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Cam2D_Add`, :func:`~robolink.Robolink.Cam2D_Close`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">file_save_img</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The first argument must be a valid file name (str)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_Snapshot&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_ptr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">file_save_img</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Camera is an item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">17779</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_PtrSnapshot&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">file_save_img</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.Cam2D_Close"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Cam2D_Close">[docs]</a>    <span class="k">def</span> <span class="nf">Cam2D_Close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cam_handle</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closes all camera windows or one specific camera if the camera handle is provided. Returns True if success, False otherwise.</span>

<span class="sd">        :param cam_handle: camera handle (pointer returned by Cam2D_Add). Leave to 0 to close all simulated views.</span>
<span class="sd">        :type cam_handle: int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Cam2D_Add`, :func:`~robolink.Robolink.Cam2D_Snapshot`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cam_handle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_CloseAll&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_Close&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_ptr</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">17779</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_PtrClose&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.Cam2D_SetParams"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Cam2D_SetParams">[docs]</a>    <span class="k">def</span> <span class="nf">Cam2D_SetParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cam_handle</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the parameters of the simulated camera.</span>
<span class="sd">        Returns 1 if success, 0 otherwise.</span>

<span class="sd">        :param str params: parameter settings according to the parameters supported by Cam2D_Add</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Cam2D_Add`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_SetParams&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_ptr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Cam2D_PtrSetParams&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">cam_handle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># ----------------------- SPRAY GUN SIMULATION ----------------------------</span>
<div class="viewcode-block" id="Robolink.Spray_Add"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Spray_Add">[docs]</a>    <span class="k">def</span> <span class="nf">Spray_Add</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">item_tool</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_object</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a simulated spray gun that allows projecting particles to a part. This is useful to simulate applications such as:</span>
<span class="sd">        arc welding, spot welding, 3D printing, painting, inspection or robot machining to verify the trace.</span>

<span class="sd">        The scripts ArcStart, ArcEnd and WeldOn and SpindleOn behave in a similar way, the only difference is the default behavior</span>
<span class="sd">        This behavior simmulates Fanuc Arc Welding and triggers appropriate output when using the customized post processor.</span>

<span class="sd">        Select ESC to clear the trace manually.</span>

<span class="sd">        Example scripts that use Spray_Add in **Library/Macros**:</span>

<span class="sd">        * SpindleOn / SpindleOff: Turn trace On/Off</span>
<span class="sd">        * ArcOn / ArcOff: Turn trace On/Off</span>
<span class="sd">        * SprayOn / SprayOff: Simulate a spray given a workspace volume (for painting)</span>
<span class="sd">        * WeldOn / WeldOff: Support for multiple weld guns</span>

<span class="sd">        Examples:</span>

<span class="sd">        * SpindleOn(2): Show the trace in blue</span>
<span class="sd">        * SpindleOn(red): Show the trace in red</span>
<span class="sd">        * SpindleOff: Turn off the trace</span>
<span class="sd">        * SpindleOn(green,2.5): Green trace with a sphere of radius 2.5 mm</span>

<span class="sd">        .. image:: TraceOn.png</span>

<span class="sd">        :param str params: A string specifying the behavior of the simulated particles. The string can contain one or more of the following commands (separated by a space). See the allowed parameter options.</span>
<span class="sd">        :param points: provide the volume as a list of points as described in the sample macro SprayOn.py</span>
<span class="sd">        :type points: :class:`robodk.Mat`</span>
<span class="sd">        :param geometry: (optional) provide a list of points describing triangles to define a specific particle geometry. Use this option instead of the PARTICLE command.</span>
<span class="sd">        :type geometry: :class:`robodk.Mat`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Allowed parameter options</span>

<span class="sd">            STEP=AxB: Defines the grid to be projected 1x1 means only one line of particle projection (for example, for welding)</span>
<span class="sd">            PARTICLE: Defines the shape and size of particle (sphere or particle), unless a specific geometry is provided:</span>
<span class="sd">                a- SPHERE(radius, facets)</span>
<span class="sd">                b- SPHERE(radius, facets, scalex, scaley, scalez)</span>
<span class="sd">                b- CUBE(sizex, sizey, sizez)</span>
<span class="sd">            RAND=factor: Defines a random factor factor 0 means that the particles are not deposited randomly</span>
<span class="sd">            ELLYPSE: defines the volume as an ellypse (default)</span>
<span class="sd">            RECTANGLE: defines the volume as a rectangle</span>
<span class="sd">            PROJECT: project the particles to the surface (default) (for welding, painting or scanning)</span>
<span class="sd">            NO_PROJECT: does not project the particles to the surface (for example, for 3D printing)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Spray_SetState`, :func:`~robolink.Robolink.Spray_GetStats`, :func:`~robolink.Robolink.Spray_Clear`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            tool = 0    # auto detect active tool</span>
<span class="sd">            obj = 0     # auto detect object in active reference frame</span>

<span class="sd">            options_command = &quot;ELLYPSE PROJECT PARTICLE=SPHERE(4,8,1,1,0.5) STEP=8x8 RAND=2&quot;</span>

<span class="sd">            # define the ellypse volume as p0, pA, pB, colorRGBA (close and far), in mm</span>
<span class="sd">            # coordinates must be provided with respect to the TCP</span>
<span class="sd">            close_p0 = [   0,   0, -200] # xyz in mm: Center of the conical ellypse (side 1)</span>
<span class="sd">            close_pA = [   5,   0, -200] # xyz in mm: First vertex of the conical ellypse (side 1)</span>
<span class="sd">            close_pB = [   0,  10, -200] # xyz in mm: Second vertex of the conical ellypse (side 1)</span>
<span class="sd">            close_color = [ 1, 0, 0, 1]  # RGBA (0-1)</span>

<span class="sd">            far_p0   = [   0,   0,  50] # xyz in mm: Center of the conical ellypse (side 2)</span>
<span class="sd">            far_pA   = [  60,   0,  50] # xyz in mm: First vertex of the conical ellypse (side 2)</span>
<span class="sd">            far_pB   = [   0, 120,  50] # xyz in mm: Second vertex of the conical ellypse (side 2)</span>
<span class="sd">            far_color   = [ 0, 0, 1, 0.2]  # RGBA (0-1)</span>

<span class="sd">            close_param = close_p0 + close_pA + close_pB + close_color</span>
<span class="sd">            far_param = far_p0 + far_pA + far_pB + far_color</span>
<span class="sd">            volume = robodk.Mat([close_param, far_param]).tr()</span>
<span class="sd">            RDK.Spray_Add(tool, obj, options_command, volume)</span>
<span class="sd">            RDK.Spray_SetState(SPRAY_ON)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Gun_Add&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item_tool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">item_object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
        <span class="n">id_spray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">id_spray</span></div>

<div class="viewcode-block" id="Robolink.Spray_SetState"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Spray_SetState">[docs]</a>    <span class="k">def</span> <span class="nf">Spray_SetState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">SPRAY_ON</span><span class="p">,</span> <span class="n">id_spray</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the state of a simulated spray gun (ON or OFF)</span>

<span class="sd">        :param int state: Set to ON or OFF. Use the defined constants: SPRAY_*</span>
<span class="sd">        :param int id_spray: spray handle (pointer returned by Spray_Add). Leave to -1 to apply to all simulated sprays.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Spray_Add`, :func:`~robolink.Robolink.Spray_GetStats`, :func:`~robolink.Robolink.Spray_Clear`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Gun_SetState&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id_spray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.Spray_GetStats"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Spray_GetStats">[docs]</a>    <span class="k">def</span> <span class="nf">Spray_GetStats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_spray</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets statistics from all simulated spray guns or a specific spray gun.</span>

<span class="sd">        :param int id_spray: spray handle (pointer returned by Spray_Add). Leave to -1 to apply to all simulated sprays.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Spray_Add`, :func:`~robolink.Robolink.Spray_SetState`, :func:`~robolink.Robolink.Spray_Clear`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Gun_Stats&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id_spray</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">info</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">info</span><span class="p">,</span> <span class="n">data</span></div>

<div class="viewcode-block" id="Robolink.Spray_Clear"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Spray_Clear">[docs]</a>    <span class="k">def</span> <span class="nf">Spray_Clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_spray</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops simulating a spray gun. This will clear the simulated particles.</span>

<span class="sd">        :param int id_spray: spray handle (pointer returned by Spray_Add). Leave the default -1 to apply to all simulated sprays.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Spray_Add`, :func:`~robolink.Robolink.Spray_SetState`, :func:`~robolink.Robolink.Spray_GetStats`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Gun_Clear&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">id_spray</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Robolink.License"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.License">[docs]</a>    <span class="k">def</span> <span class="nf">License</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the license string&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_License2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">lic_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">lic_cid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lic_name</span><span class="p">,</span> <span class="n">lic_cid</span></div>

<div class="viewcode-block" id="Robolink.Selection"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Selection">[docs]</a>    <span class="k">def</span> <span class="nf">Selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of currently selected items</span>

<span class="sd">        :return: List of items</span>
<span class="sd">        :rtype: list of :class:`.Item`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Selection&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nitems</span><span class="p">):</span>
            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item_list</span></div>

<div class="viewcode-block" id="Robolink.setSelection"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setSelection">[docs]</a>    <span class="k">def</span> <span class="nf">setSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_items</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Set the selection in the tree</span>

<span class="sd">        :param list list_items: List of items to set as selected&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">8896</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Selection&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_items</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">itm</span> <span class="ow">in</span> <span class="n">list_items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.MergeItems"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.MergeItems">[docs]</a>    <span class="k">def</span> <span class="nf">MergeItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_items</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Merge multiple object items as one. Source objects are not deleted and a new object is created.</span>

<span class="sd">        :param list list_items: List of items to set as selected</span>
<span class="sd">        :return: New object created</span>
<span class="sd">        :rtype: :class:`.Item`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">8896</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MergeItems&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_items</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">itm</span> <span class="ow">in</span> <span class="n">list_items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itm</span><span class="p">)</span>
        <span class="n">newitem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newitem</span></div>

<div class="viewcode-block" id="Robolink.Popup_ISO9283_CubeProgram"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.Popup_ISO9283_CubeProgram">[docs]</a>    <span class="k">def</span> <span class="nf">Popup_ISO9283_CubeProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Popup the menu to create the ISO9283 cube program (Utilities-Create Cube ISO)</span>

<span class="sd">        :return: Created program. The program is invalid.</span>
<span class="sd">        :rtype: :class:`.Item`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_build</span><span class="p">(</span><span class="mi">5177</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Popup_ProgISO9283&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">iso_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iso_program</span></div>

<div class="viewcode-block" id="Robolink.setInteractiveMode"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.setInteractiveMode">[docs]</a>    <span class="k">def</span> <span class="nf">setInteractiveMode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mode_type</span><span class="o">=</span><span class="n">SELECT_MOVE</span><span class="p">,</span>
        <span class="n">default_ref_flags</span><span class="o">=</span><span class="n">DISPLAY_REF_DEFAULT</span><span class="p">,</span>
        <span class="n">custom_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_ref_flags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the interactive mode to define the behavior when navigating and selecting items in RoboDK&#39;s 3D view.</span>

<span class="sd">        :param int mode_type: The mode type defines what accion occurs when the 3D view is selected (Select object, Pan, Rotate, Zoom, Move Objects, ...)</span>
<span class="sd">        :param int default_ref_flags: When a movement is specified, we can provide what motion we allow by default with respect to the coordinate system (set apropriate flags)</span>
<span class="sd">        :param list custom_objects: Provide a list of optional items to customize the move behavior for these specific items (important: the lenght of custom_ref_flags must match)</span>
<span class="sd">        :param list custom_ref_flags: Provide a matching list of flags to customize the movement behavior for specific items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_InteractiveMode&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">mode_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">default_ref_flags</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_objects</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">custom_ref_flags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nitems</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">custom_objects</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">custom_ref_flags</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">nitems</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nitems</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">custom_objects</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">custom_ref_flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.CursorXYZ"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.CursorXYZ">[docs]</a>    <span class="k">def</span> <span class="nf">CursorXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_coord</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_coord</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the position of the cursor as XYZ coordinates (by default), or the 3D position of a given set of 2D coordinates of the window (x &amp; y coordinates in pixels from the top left corner)</span>
<span class="sd">        The XYZ coordinates returned are given with respect to the RoboDK station (absolute reference).</span>
<span class="sd">        If no coordinates are provided, the current position of the cursor is retrieved.</span>

<span class="sd">        :param int x_coord: X coordinate in pixels</span>
<span class="sd">        :param int y_coord: Y coordinate in pixels</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to retrieve the 3D point under the mouse cursor</span>

<span class="sd">            RDK = Robolink()</span>
<span class="sd">            while True:</span>
<span class="sd">                xyz, item = RDK.CursorXYZ()</span>
<span class="sd">                print(str(item) + &quot; &quot; + str(xyz))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Proj2d3d&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">x_coord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">y_coord</span><span class="p">)</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_xyz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">item</span></div>

<div class="viewcode-block" id="Robolink.PluginLoad"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.PluginLoad">[docs]</a>    <span class="k">def</span> <span class="nf">PluginLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load or unload the specified plugin (path to DLL, dylib or SO file). If the plugin is already loaded it will unload the plugin and reload it. Pass an empty plugin_name to reload all plugins.</span>

<span class="sd">        :param str plugin_name: name of the plugin or path (if it is not in the default directory.</span>
<span class="sd">        :param int load: load the plugin (1/default) or unload (0)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to load a plugin</span>

<span class="sd">            RDK = Robolink()</span>
<span class="sd">            RDK.PluginLoad(&quot;C:/RoboDK/bin/plugin/yourplugin.dll&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;PluginLoad&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Robolink.PluginCommand"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.PluginCommand">[docs]</a>    <span class="k">def</span> <span class="nf">PluginCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_name</span><span class="p">,</span> <span class="n">plugin_command</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a specific command to a RoboDK plugin. The command and value (optional) must be handled by your plugin. It returns the result as a string.</span>

<span class="sd">        :param str plugin_name: The plugin name must match the PluginName() implementation in the RoboDK plugin.</span>
<span class="sd">        :param str command: Specific command handled by your plugin</span>
<span class="sd">        :param str value: Specific value (optional) handled by your plugin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;PluginCommand&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">plugin_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">plugin_command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Robolink.EmbedWindow"><a class="viewcode-back" href="../../robolink/#robolink.Robolink.EmbedWindow">[docs]</a>    <span class="k">def</span> <span class="nf">EmbedWindow</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window_name</span><span class="p">,</span>
        <span class="n">docked_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">size_w</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">size_h</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">pid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">area_add</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">area_allowed</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Embed a window from a separate process in RoboDK as a docked window. Returns True if successful.</span>

<span class="sd">        :param str window_name: The name of the window currently open. Make sure the window name is unique and it is a top level window</span>
<span class="sd">        :param str docked_name: Name of the docked tab in RoboDK (optional, if different from the window name)</span>
<span class="sd">        :param int pid: Process ID (optional)</span>
<span class="sd">        :param int area_add: Set to 1 (right) or 2 (left) (default is 1)</span>
<span class="sd">        :param int area_allowed: Areas allowed (default is 15:no constrain)</span>
<span class="sd">        :param int timeout: Timeout to abort attempting to embed the window</span>

<span class="sd">        .. seealso:: Use the static function: :func:`~robolink.EmbedWindow` (this function should usually be called on a separate thread)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">docked_name</span><span class="p">:</span>
            <span class="n">docked_name</span> <span class="o">=</span> <span class="n">window_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;WinProcDock&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">docked_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">window_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="n">size_w</span><span class="p">,</span> <span class="n">size_h</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">area_allowed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">area_add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span></div></div>


<div class="viewcode-block" id="Item"><a class="viewcode-back" href="../../robolink/#robolink.Item">[docs]</a><span class="k">class</span> <span class="nc">Item</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The Item class represents an item in RoboDK station. An item can be a robot, a frame, a tool, an object, a target, ... any item visible in the station tree.</span>
<span class="sd">    An item can also be seen as a node where other items can be attached to (child items).</span>
<span class="sd">    Every item has one parent item/node and can have one or more child items/nodes.</span>

<span class="sd">    RoboDK Items are automatically created and retrieved by generated by :class:`.Robolink` methods such as :func:`~robolink.Robolink.Item` and :func:`~robolink.Robolink.ItemUserPick`</span>

<span class="sd">    .. seealso:: :func:`~robolink.Robolink.Item`, :func:`~robolink.Robolink.ItemUserPick`</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            tool  = RDK.Item(&#39;Tool&#39;)                # Get an item named Tool (name in the RoboDK station tree)</span>
<span class="sd">            robot = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)   # Get the first available robot</span>
<span class="sd">            target = RDK.Item(&#39;Target 1&#39;, ITEM_TYPE_TARGET)   # Get a target called &quot;Target 1&quot;</span>
<span class="sd">            frame = RDK.ItemUserPick(&#39;Select a reference frame&#39;, ITEM_TYPE_FRAME)   # Promt the user to select a reference frame</span>

<span class="sd">            robot.setPoseFrame(frame)</span>
<span class="sd">            robot.setPoseTool(tool)</span>
<span class="sd">            robot.MoveJ(target)             # Move the robot to the target using the selected reference frame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">ptr_item</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">itemtype</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>

        <span class="c1"># it is recommended to keep the link as a reference and not a duplicate (otherwise it will establish a new connection at every call)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">link</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">itemtype</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ptr_item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ptr_item</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">()</span>  <span class="c1"># request type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">ptr_item</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Valid</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;RoboDK item (</span><span class="si">%i</span><span class="s2">) of type </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;RoboDK item (INVALID)&quot;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">item</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">item</span>

<div class="viewcode-block" id="Item.equals"><a class="viewcode-back" href="../../robolink/#robolink.Item.equals">[docs]</a>    <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if an item is the same as this item :class:`.Item`</span>

<span class="sd">        :param item2: item to compare</span>
<span class="sd">        :type item2: :class:`.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="n">item2</span><span class="o">.</span><span class="n">item</span></div>

<div class="viewcode-block" id="Item.RDK"><a class="viewcode-back" href="../../robolink/#robolink.Item.RDK">[docs]</a>    <span class="k">def</span> <span class="nf">RDK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the RoboDK link Robolink(). It is important to have different links (Robolink) for multithreaded applications.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Finish`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span></div>

    <span class="c1"># &quot;&quot;&quot;Generic item calls&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Item.Type"><a class="viewcode-back" href="../../robolink/#robolink.Item.Type">[docs]</a>    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the type of the item (robot, object, tool, frame, ...).</span>
<span class="sd">        Tip: Compare the returned value against ITEM_TYPE_* variables</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Item_Type&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">itemtype</span></div>

<div class="viewcode-block" id="Item.Copy"><a class="viewcode-back" href="../../robolink/#robolink.Item.Copy">[docs]</a>    <span class="k">def</span> <span class="nf">Copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copy_children</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the item to the clipboard (same as Ctrl+C). Use together with Paste() to duplicate items.</span>

<span class="sd">        :param bool copy_children: Set to false to prevent copying all items attached to this item.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Copy`, :func:`~robolink.Item.Paste`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">copy_children</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.Paste"><a class="viewcode-back" href="../../robolink/#robolink.Item.Paste">[docs]</a>    <span class="k">def</span> <span class="nf">Paste</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste the copied :class:`.Item` from the clipboard as a child of this item (same as Ctrl+V)</span>
<span class="sd">        Returns the new item created (pasted)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Copy`, :func:`~robolink.Item.Copy`, :func:`~robolink.Item.Paste`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Paste</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.AddFile"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddFile">[docs]</a>    <span class="k">def</span> <span class="nf">AddFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds an object attached to this object</span>

<span class="sd">        :param str filename: file path</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFile`, :func:`~robolink.Item.Save`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">AddFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.Save"><a class="viewcode-back" href="../../robolink/#robolink.Item.Save">[docs]</a>    <span class="k">def</span> <span class="nf">Save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a station or object to a file</span>

<span class="sd">        :param str filename: file to save. Use *.rdk name for RoboDK stations, *.stl file for objects, *.robot file for robots, ...</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFile`, :func:`~robolink.Item.AddFile`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.Collision"><a class="viewcode-back" href="../../robolink/#robolink.Item.Collision">[docs]</a>    <span class="k">def</span> <span class="nf">Collision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_check</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if this item is in a collision state with another :class:`.Item`, otherwise it returns False.</span>

<span class="sd">        :param item_check: item to check for collisions</span>
<span class="sd">        :type item_check: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Collision`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Collision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">item_check</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.IsInside"><a class="viewcode-back" href="../../robolink/#robolink.Item.IsInside">[docs]</a>    <span class="k">def</span> <span class="nf">IsInside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the object is inside the provided object</span>

<span class="sd">        :param object: object to check</span>
<span class="sd">        :type object: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.IsInside`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">IsInside</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.AddGeometry"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">AddGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromitem</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Makes a copy of the geometry fromitem adding it at a given position (pose), relative to this item.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CopyFaces&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">fromitem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Delete"><a class="viewcode-back" href="../../robolink/#robolink.Item.Delete">[docs]</a>    <span class="k">def</span> <span class="nf">Delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove this item and all its children from the station.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFile`, :func:`~robolink.Robolink.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Item is not valid or was already deleted&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Remove&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Item.Valid"><a class="viewcode-back" href="../../robolink/#robolink.Item.Valid">[docs]</a>    <span class="k">def</span> <span class="nf">Valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if the item is valid.</span>
<span class="sd">        Returns True if the item is valid or False if the item is not valid.</span>
<span class="sd">        An invalid item will be returned by an unsuccessful function call (wrong name or because an item was deleted)</span>

<span class="sd">        :param bool check_deleted: Check if the item was deleted in RoboDK.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Item`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            tool  = RDK.Item(&#39;Tool&#39;)                # Retrieve an item named tool</span>
<span class="sd">            if not tool.Valid():</span>
<span class="sd">                print(&quot;The tool item does not exist!&quot;)</span>
<span class="sd">                quit()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">check_deleted</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Item.setParent"><a class="viewcode-back" href="../../robolink/#robolink.Item.setParent">[docs]</a>    <span class="k">def</span> <span class="nf">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attaches the item to a new parent while maintaining the relative position with its parent.</span>
<span class="sd">        The absolute position is changed.</span>

<span class="sd">        :param parent: parent to attach the item</span>
<span class="sd">        :type parent: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParentStatic`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Parent&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parent</span></div>

<div class="viewcode-block" id="Item.setParentStatic"><a class="viewcode-back" href="../../robolink/#robolink.Item.setParentStatic">[docs]</a>    <span class="k">def</span> <span class="nf">setParentStatic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attaches the item to another parent while maintaining the current absolute position in the station.</span>
<span class="sd">        The relationship between this item and its parent is changed to maintain the abosolute position.</span>

<span class="sd">        :param parent: parent to attach the item</span>
<span class="sd">        :type parent: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParent`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Parent_Static&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.AttachClosest"><a class="viewcode-back" href="../../robolink/#robolink.Item.AttachClosest">[docs]</a>    <span class="k">def</span> <span class="nf">AttachClosest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tolerance_mm</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">list_objects</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Attach the closest object to the tool.</span>
<span class="sd">        Returns the item that was attached. Use item.Valid() to check if an object was attached to the tool.</span>

<span class="sd">        :param str keyword: Keyword needed for an object to be grabbable (leave empty to consider all objects)</span>
<span class="sd">        :param float tolerance_mm: Distance tolerance to use (at most) to consider grabbing objects. The closest object will be attached. In Tools-Options-General tab you can choose to check object distance between TCP and object shape (instead of the default TCP vs. Object position).</span>
<span class="sd">        :param list list_objects: List of candidate objects to consider to grab (providing a keyword constrains the choices even more)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParentStatic`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Attach_Closest2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="n">tolerance_mm</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_objects</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">obji</span> <span class="ow">in</span> <span class="n">list_objects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>

        <span class="n">item_attached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item_attached</span></div>

<div class="viewcode-block" id="Item.DetachClosest"><a class="viewcode-back" href="../../robolink/#robolink.Item.DetachClosest">[docs]</a>    <span class="k">def</span> <span class="nf">DetachClosest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Detach the closest object attached to the tool (see also: setParentStatic).</span>

<span class="sd">        :param parent: New parent item to attach, such as a reference frame (optional). If not provided, the items held by the tool will be placed at the station root.</span>
<span class="sd">        :type parent: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParentStatic`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Detach_Closest&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">item_detached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item_detached</span></div>

<div class="viewcode-block" id="Item.DetachAll"><a class="viewcode-back" href="../../robolink/#robolink.Item.DetachAll">[docs]</a>    <span class="k">def</span> <span class="nf">DetachAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Detaches any object attached to a tool.</span>

<span class="sd">        :param parent: New parent item to attach, such as a reference frame (optional). If not provided, the items held by the tool will be placed at the station root.</span>
<span class="sd">        :type parent: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParentStatic`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Detach_All&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Parent"><a class="viewcode-back" href="../../robolink/#robolink.Item.Parent">[docs]</a>    <span class="k">def</span> <span class="nf">Parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the parent item of this item (:class:`.Item`)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Childs`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Parent&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parent</span></div>

<div class="viewcode-block" id="Item.Childs"><a class="viewcode-back" href="../../robolink/#robolink.Item.Childs">[docs]</a>    <span class="k">def</span> <span class="nf">Childs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the childs items (list of :class:`.Item`) that are attached to this item.</span>
<span class="sd">        Exceptionally, if Childs is called on a program it will return the list of subprograms called by this program.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Parent`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Childs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">nitems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">itemlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nitems</span><span class="p">):</span>
            <span class="n">itemlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">itemlist</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<div class="viewcode-block" id="Item.Visible"><a class="viewcode-back" href="../../robolink/#robolink.Item.Visible">[docs]</a>    <span class="k">def</span> <span class="nf">Visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns 1 if the item is visible, otherwise it returns 0.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setVisible`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Visible&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">visible</span></div>

<div class="viewcode-block" id="Item.setVisible"><a class="viewcode-back" href="../../robolink/#robolink.Item.setVisible">[docs]</a>    <span class="k">def</span> <span class="nf">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visible</span><span class="p">,</span> <span class="n">visible_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the item visiblity.</span>

<span class="sd">        :param bool visible: Set the object as visible (1/True) or invisible (0/False)</span>
<span class="sd">        :param bool visible_frame: Set the object reference frame as visible (1/True) or invisible (0/False). It is also possible to provide flags to control the visibility of each robot link (only for robot items). When the item is a robot, this variable can specify robot visibility using suitable flags (as shown in the example).</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Change robot visibility</span>

<span class="sd">            # Retrieve the robot (first robot available)</span>
<span class="sd">            robot = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)</span>

<span class="sd">            # Show the robot with default settings:</span>
<span class="sd">            robot.setVisible(True, VISIBLE_ROBOT_DEFAULT)</span>

<span class="sd">            # Show the robot and hide all references:</span>
<span class="sd">            robot.setVisible(1, VISIBLE_ROBOT_DEFAULT and not VISIBLE_ROBOT_ALL_REFS)</span>

<span class="sd">            # Show only references (hide the robot):</span>
<span class="sd">            robot.setVisible(1, VISIBLE_ROBOT_ALL_REFS)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available Frame flags</span>

<span class="sd">            # Default values for objects</span>
<span class="sd">            VISIBLE_REFERENCE_DEFAULT = -1</span>
<span class="sd">            VISIBLE_REFERENCE_ON = 1     # For objects and reference frames only</span>
<span class="sd">            VISIBLE_REFERENCE_OFF = 0    # For objects and reference frames only</span>

<span class="sd">            # Available flags to set robot visiblity</span>
<span class="sd">            VISIBLE_ROBOT_NONE = 0</span>
<span class="sd">            VISIBLE_ROBOT_FLANGE = 0x01</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_Base_3D = 0x01 &lt;&lt; 1</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_Base_REF = 0x01 &lt;&lt; 2</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_1_3D = 0x01 &lt;&lt; 3</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_1_REF = 0x01 &lt;&lt; 4</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_2_3D = 0x01 &lt;&lt; 5</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_2_REF = 0x01 &lt;&lt; 6</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_3_3D = 0x01 &lt;&lt; 7</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_3_REF = 0x01 &lt;&lt; 8</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_4_3D = 0x01 &lt;&lt; 9</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_4_REF = 0x01 &lt;&lt; 10</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_5_3D = 0x01 &lt;&lt; 11</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_5_REF = 0x01 &lt;&lt; 12</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_6_3D = 0x01 &lt;&lt; 13</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_6_REF = 0x01 &lt;&lt; 14</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_7_3D = 0x01 &lt;&lt; 15</span>
<span class="sd">            VISIBLE_ROBOT_AXIS_7_REF = 0x02 &lt;&lt; 16</span>
<span class="sd">            VISIBLE_ROBOT_DEFAULT = 0x2AAAAAAB</span>
<span class="sd">            VISIBLE_ROBOT_ALL = 0x7FFFFFFF</span>
<span class="sd">            VISIBLE_ROBOT_ALL_REFS = 0x15555555</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Visible`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">visible_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">visible_frame</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">visible_frame</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">visible_frame</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">visible_frame</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">visible_frame</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Visible&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">visible_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.Name"><a class="viewcode-back" href="../../robolink/#robolink.Item.Name">[docs]</a>    <span class="k">def</span> <span class="nf">Name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the item name. The name of the item is always displayed in the RoboDK station tree.</span>
<span class="sd">        Returns the name as a string (str)</span>

<span class="sd">        :return: New item name</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setName`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">name</span></div>

<div class="viewcode-block" id="Item.setName"><a class="viewcode-back" href="../../robolink/#robolink.Item.setName">[docs]</a>    <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the name of the item. The name of the item will be displayed in the station tree.</span>

<span class="sd">        :param str name: New item name</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Name`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setValue"><a class="viewcode-back" href="../../robolink/#robolink.Item.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a specific property name to a given value. This is reserved for internal purposes and future compatibility.</span>

<span class="sd">        :param str varname: property name</span>
<span class="sd">        :param str value: property value</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.Command`, :func:`~robolink.Item.setParam`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Gen_Mat&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Gen_Str&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unsupported value type&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

    <span class="c1">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<div class="viewcode-block" id="Item.setPose"><a class="viewcode-back" href="../../robolink/#robolink.Item.setPose">[docs]</a>    <span class="k">def</span> <span class="nf">setPose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the position (pose) of the item with respect to its parent (item it is attached to).</span>
<span class="sd">        For example, the position of an object, frame or target with respect to its parent reference frame.</span>

<span class="sd">        :param pose: pose of the item with respect to its parent</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Pose`, :func:`~robolink.Item.PoseAbs`, :func:`~robolink.Item.setPoseAbs`, :func:`~robolink.Item.setPoseTool`, :func:`~robolink.Item.setPoseFrame`, :func:`~robolink.Robolink.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Hlocal&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.Pose"><a class="viewcode-back" href="../../robolink/#robolink.Item.Pose">[docs]</a>    <span class="k">def</span> <span class="nf">Pose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the relative pose of an object, target or reference frame. For example, the position of an object, target or reference frame with respect to its parent (the item it is attached to in the tree). For robot items, this provide the pose of the end efector with respect to the robot base (same as PoseTool()). It returns the pose as :class:`robodk.Mat`.</span>

<span class="sd">        Tip: Use a Pose_2_* function from the robodk module (such as :class:`robodk.Pose_2_KUKA`) to convert the pose to XYZABC (XYZ position in mm and ABC orientation in degrees), specific to a robot brand.</span>

<span class="sd">        Example: :ref:`weldexample`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Pose`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.PoseAbs`, :func:`~robolink.Item.PoseTool`, :func:`~robolink.Item.PoseFrame`, :func:`~robolink.Robolink.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Hlocal&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Item.setGeometryPose"><a class="viewcode-back" href="../../robolink/#robolink.Item.setGeometryPose">[docs]</a>    <span class="k">def</span> <span class="nf">setGeometryPose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the position (pose) the object geometry with respect to its own reference frame. This can be applied to tools and objects.</span>
<span class="sd">        The pose must be a :class:`robodk.Mat`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Hgeom&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.GeometryPose"><a class="viewcode-back" href="../../robolink/#robolink.Item.GeometryPose">[docs]</a>    <span class="k">def</span> <span class="nf">GeometryPose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the position (pose as :class:`robodk.Mat`) the object geometry with respect to its own reference frame. This procedure works for tools and objects.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Hgeom&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Item.setPoseAbs"><a class="viewcode-back" href="../../robolink/#robolink.Item.setPoseAbs">[docs]</a>    <span class="k">def</span> <span class="nf">setPoseAbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the pose (:class:`robodk.Mat`) of this item with respect to the absolute reference frame (also know as the station reference or world coordinate system -WCS-). For example, the position of an object/frame/target with respect to the origin of the station.</span>

<span class="sd">        :param pose: pose of the item with respect to the station reference</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.PoseAbs`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.Pose`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Hlocal_Abs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.PoseAbs"><a class="viewcode-back" href="../../robolink/#robolink.Item.PoseAbs">[docs]</a>    <span class="k">def</span> <span class="nf">PoseAbs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the pose (:class:`robodk.Mat`) of this item with respect to the absolute reference frame (also know as the station reference or world coordinate system -WCS-). For example, the position of an object/frame/target with respect to the origin of the station.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setPoseAbs`, :func:`~robolink.Item.Pose`, :func:`~robolink.Item.setPose`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            # Calculate the pose of any object with respect to any reference in RoboDK</span>
<span class="sd">            def CalculatePoseFrame2Object(frame, part):</span>
<span class="sd">                # Get both poses with respect to the station reference (wrt-world coordinate system)</span>
<span class="sd">                framePoseAbs = frame.PoseAbs()</span>
<span class="sd">                partPoseAbs = part.PoseAbs()</span>

<span class="sd">                # Calculate the pose of the object relative to the reference</span>
<span class="sd">                pose = framePoseAbs.inv() * partPoseAbs</span>
<span class="sd">                return pose</span>

<span class="sd">            # Take the object</span>
<span class="sd">            obj = RDK.Item(&#39;Sphere&#39;)</span>

<span class="sd">            # Retrieve the reference</span>
<span class="sd">            frame = RDK.Item(&#39;Frame 2&#39;)</span>

<span class="sd">            # Calculate the relationship</span>
<span class="sd">            pose =  CalculatePoseFrame2Object(frame,obj)</span>

<span class="sd">            # Display the result</span>
<span class="sd">            print(pose)</span>
<span class="sd">            RDK.ShowMessage(&quot;The relative pose is:\n&quot; + str(pose))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Hlocal_Abs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Item.Recolor"><a class="viewcode-back" href="../../robolink/#robolink.Item.Recolor">[docs]</a>    <span class="k">def</span> <span class="nf">Recolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tocolor</span><span class="p">,</span> <span class="n">fromcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes the color of an :class:`.Item` (object, tool or robot).</span>
<span class="sd">        Colors must in the format COLOR=[R,G,B,(A=1)] where all values range from 0 to 1.</span>
<span class="sd">        Alpha (A) defaults to 1 (100% opaque). Set A to 0 to make an object transparent.</span>

<span class="sd">        :param tocolor: color to set</span>
<span class="sd">        :type tocolor: list of float</span>
<span class="sd">        :param fromcolor: color to change</span>
<span class="sd">        :type fromcolor: list of float</span>
<span class="sd">        :param tolerance: tolerance to replace colors (set to 0 for exact match)</span>
<span class="sd">        :type tolerance: float (defaults to 0.1)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setColor`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fromcolor</span><span class="p">:</span>
            <span class="n">fromcolor</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">tolerance</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;tolerance must be a scalar&quot;</span><span class="p">)</span>

        <span class="n">tocolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_color</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="n">fromcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_color</span><span class="p">(</span><span class="n">fromcolor</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Recolor&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="n">tolerance</span><span class="p">]</span> <span class="o">+</span> <span class="n">fromcolor</span> <span class="o">+</span> <span class="n">tocolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setColor"><a class="viewcode-back" href="../../robolink/#robolink.Item.setColor">[docs]</a>    <span class="k">def</span> <span class="nf">setColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tocolor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the color of an object, tool or robot.</span>
<span class="sd">        A color must in the format COLOR=[R,G,B,(A=1)] where all values range from 0 to 1.</span>

<span class="sd">        :param tocolor: color to set</span>
<span class="sd">        :type tocolor: list of float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Color`, :func:`~robolink.Item.Recolor`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">tocolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_color</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Color&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setColorShape"><a class="viewcode-back" href="../../robolink/#robolink.Item.setColorShape">[docs]</a>    <span class="k">def</span> <span class="nf">setColorShape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tocolor</span><span class="p">,</span> <span class="n">shape_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the color of an object shape. It can also be used for tools.</span>
<span class="sd">        A color must in the format COLOR=[R,G,B,(A=1)] where all values range from 0 to 1.</span>

<span class="sd">        :param tocolor: color to set</span>
<span class="sd">        :type tocolor: list of float</span>
<span class="sd">        :param int shape_id: ID of the shape: the ID is the order in which the shape was added using AddShape()</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Color`, :func:`~robolink.Item.Recolor`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">tocolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_color</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ShapeColor&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">shape_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setColorCurve"><a class="viewcode-back" href="../../robolink/#robolink.Item.setColorCurve">[docs]</a>    <span class="k">def</span> <span class="nf">setColorCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tocolor</span><span class="p">,</span> <span class="n">curve_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the color of a curve object. It can also be used for tools.</span>
<span class="sd">        A color must in the format COLOR=[R,G,B,(A=1)] where all values range from 0 to 1.</span>

<span class="sd">        :param tocolor: color to set</span>
<span class="sd">        :type tocolor: list of float</span>
<span class="sd">        :param int curve_id: ID of the curve: the ID is the order in which the shape was added using AddCurve()</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Color`, :func:`~robolink.Item.Recolor`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">tocolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_color</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_CurveColor&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">curve_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">tocolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Color"><a class="viewcode-back" href="../../robolink/#robolink.Item.Color">[docs]</a>    <span class="k">def</span> <span class="nf">Color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the color of an :class:`.Item` (object, tool or robot). If the item has multiple colors it returns the first color available).</span>
<span class="sd">        A color is in the format COLOR=[R,G,B,(A=1)] where all values range from 0 to 1.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setColor`, :func:`~robolink.Item.Recolor`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Color&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">color</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Scale"><a class="viewcode-back" href="../../robolink/#robolink.Item.Scale">[docs]</a>    <span class="k">def</span> <span class="nf">Scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">pre_mult</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">post_mult</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply a scale to an object to make it bigger or smaller.</span>
<span class="sd">        The scale can be uniform (if scale is a float value) or per axis (if scale is an array/list [scale_x, scale_y, scale_z]).</span>

<span class="sd">        :param scale: scale parameter (1 means no change)</span>
<span class="sd">        :type scale: float or list of 3 float [scale_x, scale_y, scale_z]</span>
<span class="sd">        :param pre_mult: pre multiplication to apply before the scaling(optional)</span>
<span class="sd">        :param post_mult: post multiplication to apply after the scaling (optional)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pre_mult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">post_mult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pre_mult</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pre_mult</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">post_mult</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">post_mult</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">invH</span><span class="p">(</span><span class="n">pre_mult</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;scale must be a single value or a 3-vector value&quot;</span><span class="p">)</span>

            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;TrScale&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pre_mult</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">post_mult</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">status</span> <span class="o">&gt;</span> <span class="mi">0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;scale must be a single value or a 3-vector value&quot;</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Scale&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># &quot;&quot;&quot;Object specific calls&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Item.AddShape"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddShape">[docs]</a>    <span class="k">def</span> <span class="nf">AddShape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triangle_points</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a shape to the object provided some triangle coordinates. Triangles must be provided as a list of vertices. A vertex normal can be optionally provided.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddShape`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">AddShape</span><span class="p">(</span><span class="n">triangle_points</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.AddCurve"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddCurve">[docs]</a>    <span class="k">def</span> <span class="nf">AddCurve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">curve_points</span><span class="p">,</span>
        <span class="n">add_to_ref</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a curve provided point coordinates. The provided points must be a list of vertices. A vertex normal can be provided optionally.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddCurve`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">AddCurve</span><span class="p">(</span><span class="n">curve_points</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">add_to_ref</span><span class="p">,</span> <span class="n">projection_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.AddPoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddPoints">[docs]</a>    <span class="k">def</span> <span class="nf">AddPoints</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">add_to_ref</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a list of points to an object. The provided points must be a list of vertices. A vertex normal can be provided optionally.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddPoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">AddPoints</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">add_to_ref</span><span class="p">,</span> <span class="n">projection_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.ProjectPoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.ProjectPoints">[docs]</a>    <span class="k">def</span> <span class="nf">ProjectPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">projection_type</span><span class="o">=</span><span class="n">PROJECTION_ALONG_NORMAL_RECALC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Projects a point or a list of points to the object given its coordinates. The provided points must be a list of [XYZ] coordinates. Optionally, a vertex normal can be provided [XYZijk].</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.ProjectPoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">ProjectPoints</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">projection_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.SelectedFeature"><a class="viewcode-back" href="../../robolink/#robolink.Item.SelectedFeature">[docs]</a>    <span class="k">def</span> <span class="nf">SelectedFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the currently selected feature for this object.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.GetPoints`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Show the point selected</span>
<span class="sd">            object = RDK.Item(&#39;Object&#39;, ITEM_TYPE_OBJECT)</span>
<span class="sd">            is_selected, feature_type, feature_id = OBJECT.SelectedFeature()</span>

<span class="sd">            points, name_selected = object.GetPoints(feature_type, feature_id)</span>
<span class="sd">            point = None</span>
<span class="sd">            if len(points) &gt; 1:</span>
<span class="sd">                point = points[feature_id]</span>
<span class="sd">            else:</span>
<span class="sd">                point = points[0]</span>

<span class="sd">            RDK.ShowMessage(&quot;Selected Point: %s = [%.3f, %.3f, %.3f]&quot; % (name_selected, point[0], point[1], point[2]))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ObjSelection&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">is_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">feature_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">feature_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">is_selected</span><span class="p">,</span> <span class="n">feature_type</span><span class="p">,</span> <span class="n">feature_id</span></div>

<div class="viewcode-block" id="Item.GetPoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.GetPoints">[docs]</a>    <span class="k">def</span> <span class="nf">GetPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FEATURE_SURFACE</span><span class="p">,</span> <span class="n">feature_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves the point under the mouse cursor, a curve or the 3D points of an object. The points are provided in [XYZijk] format in relative coordinates. The XYZ are the local point coordinate and ijk is the normal of the surface.</span>

<span class="sd">        :param int feature_type: set to FEATURE_SURFACE to retrieve the point under the mouse cursor, FEATURE_CURVE to retrieve the list of points for that wire, or FEATURE_POINT to retrieve the list of points.</span>
<span class="sd">        :param int feature_id:  used only if FEATURE_CURVE is specified, it allows retrieving the appropriate curve id of an object</span>

<span class="sd">        :return: List of points</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Example to display the XYZ position of a selected object</span>
<span class="sd">            from robolink import *    # Import the RoboDK API</span>
<span class="sd">            RDK = Robolink()          # Start RoboDK API</span>

<span class="sd">            # Ask the user to select an object</span>
<span class="sd">            OBJECT = RDK.ItemUserPick(&quot;Select an object&quot;, ITEM_TYPE_OBJECT)</span>

<span class="sd">            while True:</span>
<span class="sd">                is_selected, feature_type, feature_id = OBJECT.SelectedFeature()</span>

<span class="sd">                if is_selected and feature_type == FEATURE_SURFACE:</span>
<span class="sd">                    point_mouse, name_feature = OBJECT.GetPoints(FEATURE_SURFACE)</span>
<span class="sd">                    print(&quot;Selected %i (%i): %s  %s&quot; % (feature_id, feature_type, str(point_mouse), name_feature))</span>

<span class="sd">                else:</span>
<span class="sd">                    print(&quot;Object Not Selected. Select a point in the object surface...&quot;)</span>

<span class="sd">                robodk.pause(0.1)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.SelectedFeature`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ObjPoint&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">feature_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">feature_id</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="n">feature_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">points</span><span class="p">),</span> <span class="n">feature_name</span></div>

<div class="viewcode-block" id="Item.setMillingParameters"><a class="viewcode-back" href="../../robolink/#robolink.Item.setMillingParameters">[docs]</a>    <span class="k">def</span> <span class="nf">setMillingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ncfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete, use :func:`~robolink.Item.setMachiningParameters` instead&quot;&quot;&quot;</span>
        <span class="n">newprog</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setMachiningParameters</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newprog</span><span class="p">,</span> <span class="n">status</span></div>

<div class="viewcode-block" id="Item.setMachiningParameters"><a class="viewcode-back" href="../../robolink/#robolink.Item.setMachiningParameters">[docs]</a>    <span class="k">def</span> <span class="nf">setMachiningParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ncfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the robot milling path input and parameters. Parameter input can be an NC file (G-code or APT file) or an object item in RoboDK. A curve or a point follow project will be automatically set up for a robot manufacturing project.</span>
<span class="sd">        Tip: Use getLink(), setPoseTool(), setPoseFrame() to get/set the robot tool, reference frame, robot and program linked to the project.</span>
<span class="sd">        Tip: Use setPose() and setJoints() to update the path to tool orientation or the preferred start joints.</span>

<span class="sd">        :param str ncfile: path to the NC file (G-code or APT) to be loaded (optional)</span>
<span class="sd">        :param part: object holding curves or points to automatically set up a curve/point follow project (optional)</span>
<span class="sd">        :type part: :class:`.Item`</span>
<span class="sd">        :param params: Additional options</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddMachiningProject`, :func:`~robolink.Item.Joints`, :func:`~robolink.Item.getLink`, :func:`~robolink.Item.setJoints`, :func:`~robolink.Item.setToolPose`, :func:`~robolink.Item.setFramePose`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            object_curve = RDK.AddCurve(POINTS)</span>
<span class="sd">            object_curve.setName(&#39;AutoPoints n%i&#39; % NUM_POINTS)</span>
<span class="sd">            path_settings = RDK.AddMillingProject(&quot;AutoCurveFollow settings&quot;)</span>
<span class="sd">            prog, status = path_settings.setMillingParameters(part=object_curve)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_MachiningParams&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">newprog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newprog</span><span class="p">,</span> <span class="n">status</span></div>

    <span class="c1"># &quot;&quot;&quot;Target item calls&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Item.setAsCartesianTarget"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAsCartesianTarget">[docs]</a>    <span class="k">def</span> <span class="nf">setAsCartesianTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a target as a cartesian target. A cartesian target moves to cartesian coordinates.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddTarget`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setAsJointTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Target_As_RT&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setAsJointTarget"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAsJointTarget">[docs]</a>    <span class="k">def</span> <span class="nf">setAsJointTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a target as a joint target. A joint target moves to the joint position without taking into account the cartesian coordinates.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddTarget`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setAsCartesianTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Target_As_JT&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.isJointTarget"><a class="viewcode-back" href="../../robolink/#robolink.Item.isJointTarget">[docs]</a>    <span class="k">def</span> <span class="nf">isJointTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if a target is a joint target. A joint target moves to the joint position without taking into account the cartesian coordinates.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddTarget`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setAsCartesianTarget, :func:`~robolink.Item.setAsJointTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Target_Is_JT&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">isjt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">isjt</span> <span class="o">&gt;</span> <span class="mi">0</span></div>

    <span class="c1"># &quot;&quot;&quot;Robot item calls&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Item.Joints"><a class="viewcode-back" href="../../robolink/#robolink.Item.Joints">[docs]</a>    <span class="k">def</span> <span class="nf">Joints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current joint position as a :class:`robodk.Mat` of a robot or the joints of a target.</span>
<span class="sd">        If the item is a cartesian target, it returns the preferred joints (configuration) to go to that cartesian position.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setJoints`, :func:`~robolink.Item.MoveJ`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started)</span>
<span class="sd">            tool  = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)   # Retrieve the robot</span>
<span class="sd">            joints = robot.Joints().list()          # retrieve the current robot joints as a list</span>
<span class="sd">            joints[5] = 0                           # set joint 6 to 0 deg</span>
<span class="sd">            robot.MoveJ(joints)                     # move the robot to the new joint position</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Thetas&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints</span></div>

<div class="viewcode-block" id="Item.SimulatorJoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.SimulatorJoints">[docs]</a>    <span class="k">def</span> <span class="nf">SimulatorJoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current joint position of a robot (only from the simulator, never from the real robot).</span>
<span class="sd">        This should be used only when RoboDK is connected to the real robot and only the simulated robot needs to be retrieved (for example, if we want to move the robot using a spacemouse).</span>

<span class="sd">        Note: Use robot.Joints() instead to retrieve the simulated and real robot position when connected.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Joints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Thetas_Sim&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints</span><span class="o">.</span><span class="n">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.JointPoses"><a class="viewcode-back" href="../../robolink/#robolink.Item.JointPoses">[docs]</a>    <span class="k">def</span> <span class="nf">JointPoses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joints</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the positions of the joint links for a provided robot configuration (joints). If no joints are provided it will return the poses for the current robot position.</span>
<span class="sd">        Out 1 : 4x4 x n -&gt; array of 4x4 homogeneous matrices. Index 0 is the base frame reference (it never moves when the joints move).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_LinkPoses&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">joints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>

        <span class="n">nlinks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">poses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlinks</span><span class="p">):</span>
            <span class="n">poses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">poses</span></div>

<div class="viewcode-block" id="Item.JointsHome"><a class="viewcode-back" href="../../robolink/#robolink.Item.JointsHome">[docs]</a>    <span class="k">def</span> <span class="nf">JointsHome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the home joints of a robot.</span>
<span class="sd">        The home joints can be manually set in the robot &quot;Parameters&quot; menu of the robot panel in RoboDK, then select &quot;Set home position&quot;.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Joints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Home&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints</span></div>

<div class="viewcode-block" id="Item.setJointsHome"><a class="viewcode-back" href="../../robolink/#robolink.Item.setJointsHome">[docs]</a>    <span class="k">def</span> <span class="nf">setJointsHome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the home position of the robot in the joint space.</span>

<span class="sd">        :param joints: robot joints</span>
<span class="sd">        :type joints: list of float or :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Home&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.ObjectLink"><a class="viewcode-back" href="../../robolink/#robolink.Item.ObjectLink">[docs]</a>    <span class="k">def</span> <span class="nf">ObjectLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an item pointer (:class:`.Item`) to a robot link. This is useful to show/hide certain robot links or alter their geometry.</span>

<span class="sd">        :param int link_id: link index (0 for the robot base, 1 for the first link, ...)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_LinkObjId&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">link_id</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="Item.getLink"><a class="viewcode-back" href="../../robolink/#robolink.Item.getLink">[docs]</a>    <span class="k">def</span> <span class="nf">getLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_linked</span><span class="o">=</span><span class="n">ITEM_TYPE_ROBOT</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an item pointer (:class:`.Item`) to a robot, object, tool or program. This is useful to retrieve the relationship between programs, robots, tools and other specific projects.</span>

<span class="sd">        :param int type_linked: type of linked object to retrieve</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_LinkType&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">type_linked</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="Item.setJoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.setJoints">[docs]</a>    <span class="k">def</span> <span class="nf">setJoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the current joints of a robot or a target. If robot joints are set, the robot position will be updated on the screen.</span>

<span class="sd">        :param joints: robot joints</span>
<span class="sd">        :type joints: list of float or :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Joints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Thetas&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.JointLimits"><a class="viewcode-back" href="../../robolink/#robolink.Item.JointLimits">[docs]</a>    <span class="k">def</span> <span class="nf">JointLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the joint limits of a robot. Returns (lower limits, upper limits, joint type).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setJointLimits`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_RobLimits&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">lim_inf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="n">lim_sup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="n">joints_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lim_inf</span><span class="p">,</span> <span class="n">lim_sup</span><span class="p">,</span> <span class="n">joints_type</span></div>

<div class="viewcode-block" id="Item.setJointLimits"><a class="viewcode-back" href="../../robolink/#robolink.Item.setJointLimits">[docs]</a>    <span class="k">def</span> <span class="nf">setJointLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the robot joint limits</span>

<span class="sd">        :param lower_limit: lower joint limits</span>
<span class="sd">        :type lower_limit: list of float</span>
<span class="sd">        :param upper_limit: upper joint limits</span>
<span class="sd">        :type upper_limit: list of float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.JointLimits`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_RobLimits&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">lower_limit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">upper_limit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setRobot"><a class="viewcode-back" href="../../robolink/#robolink.Item.setRobot">[docs]</a>    <span class="k">def</span> <span class="nf">setRobot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assigns a specific robot to a program, target or robot machining project.</span>

<span class="sd">        :param robot: robot to link</span>
<span class="sd">        :type robot: :class:`.Item`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">robot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">robot</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Robot&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setPoseFrame"><a class="viewcode-back" href="../../robolink/#robolink.Item.setPoseFrame">[docs]</a>    <span class="k">def</span> <span class="nf">setPoseFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the reference frame of a robot (user frame). The frame can be an item or a 4x4 Matrix</span>

<span class="sd">        :param frame: robot reference frame as an item, or a pose</span>
<span class="sd">        :type frame: :class:`robodk.Mat` or :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.PoseFrame`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setPoseTool`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Frame_ptr&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Frame&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setPoseTool"><a class="viewcode-back" href="../../robolink/#robolink.Item.setPoseTool">[docs]</a>    <span class="k">def</span> <span class="nf">setPoseTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the robot tool pose (TCP) with respect to the robot flange. The tool pose can be an item or a 4x4 Matrix</span>

<span class="sd">        :param tool: robot tool as an item, or a pose</span>
<span class="sd">        :type tool: :class:`robodk.Mat` or :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.PoseTool`, :func:`~robolink.Item.setPose`, :func:`~robolink.Item.setPoseFrame`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Tool_ptr&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Tool&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.PoseTool"><a class="viewcode-back" href="../../robolink/#robolink.Item.PoseTool">[docs]</a>    <span class="k">def</span> <span class="nf">PoseTool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the pose (:class:`robodk.Mat`) of the robot tool (TCP) with respect to the robot flange</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setPoseTool`, :func:`~robolink.Item.Pose`, :func:`~robolink.Item.PoseFrame`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Tool&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Item.PoseFrame"><a class="viewcode-back" href="../../robolink/#robolink.Item.PoseFrame">[docs]</a>    <span class="k">def</span> <span class="nf">PoseFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the pose (:class:`robodk.Mat`) of the robot reference frame with respect to the robot base</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setPoseFrame`, :func:`~robolink.Item.Pose`, :func:`~robolink.Item.PoseTool`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Frame&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose</span></div>

    <span class="c1"># Obsolete methods -----------------------</span>
<div class="viewcode-block" id="Item.Htool"><a class="viewcode-back" href="../../robolink/#robolink.Item.Htool">[docs]</a>    <span class="k">def</span> <span class="nf">Htool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.PoseTool` instead. Returns the pose (:class:`robodk.Mat`) of the robot tool (TCP) with respect to the robot flange&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PoseTool</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Tool"><a class="viewcode-back" href="../../robolink/#robolink.Item.Tool">[docs]</a>    <span class="k">def</span> <span class="nf">Tool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.PoseTool` instead. Returns the pose (:class:`robodk.Mat`) of the robot tool (TCP) with respect to the robot flange&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PoseTool</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Frame"><a class="viewcode-back" href="../../robolink/#robolink.Item.Frame">[docs]</a>    <span class="k">def</span> <span class="nf">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.PoseFrame` instead. Returns the pose (:class:`robodk.Mat`) of the robot reference frame with respect to the robot base&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PoseFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setHtool"><a class="viewcode-back" href="../../robolink/#robolink.Item.setHtool">[docs]</a>    <span class="k">def</span> <span class="nf">setHtool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. :func:`~robolink.Item.setPoseTool` instead. Sets the robot tool pose (TCP) with respect to the robot flange. The tool pose can be an item or a 4x4 Matrix&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPoseTool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.setTool"><a class="viewcode-back" href="../../robolink/#robolink.Item.setTool">[docs]</a>    <span class="k">def</span> <span class="nf">setTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.setPoseTool` instead. Sets the robot tool pose (TCP) with respect to the robot flange. The tool pose can be an item or a 4x4 Matrix&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPoseTool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.setFrame"><a class="viewcode-back" href="../../robolink/#robolink.Item.setFrame">[docs]</a>    <span class="k">def</span> <span class="nf">setFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.setPoseFrame` instead. Sets the reference frame of a robot (user frame). The frame can be an item or a 4x4 Matrix&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPoseFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span></div>

    <span class="c1"># -----------------------</span>

<div class="viewcode-block" id="Item.AddTool"><a class="viewcode-back" href="../../robolink/#robolink.Item.AddTool">[docs]</a>    <span class="k">def</span> <span class="nf">AddTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_pose</span><span class="p">,</span> <span class="n">tool_name</span><span class="o">=</span><span class="s2">&quot;New TCP&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a tool to a robot given the tool pose and the tool name. It returns the tool as an :class:`.Item`.</span>

<span class="sd">        :param tool_pose: Tool pose (TCP) of the tool with respect to the robot flange</span>
<span class="sd">        :type tool_pose: :class:`robodk.Mat`</span>
<span class="sd">        :param str tool_name: name of the tool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddFrame`, :func:`~robolink.Item.PoseTool`, :func:`~robolink.Item.setPoseTool`, :func:`~robolink.Robolink.AddFile`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;AddToolEmpty&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">tool_pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
        <span class="n">newtool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newtool</span></div>

<div class="viewcode-block" id="Item.SolveFK"><a class="viewcode-back" href="../../robolink/#robolink.Item.SolveFK">[docs]</a>    <span class="k">def</span> <span class="nf">SolveFK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="n">tool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the forward kinematics of the robot for the provided joints.</span>
<span class="sd">        Returns the pose of the robot flange with respect to the robot base reference (:class:`robodk.Mat`).</span>

<span class="sd">        :param joints: robot joints</span>
<span class="sd">        :type joints: list of float or :class:`robodk.Mat`</span>
<span class="sd">        :param tool: Optionally provide the tool used to calculate the forward kinematics. If this parameter is ignored it will use the robot flange.</span>
<span class="sd">        :type tool: :class:`robodk.Mat`</span>
<span class="sd">        :param reference: Optionally provide the reference frame used to calculate the forward kinematics. If this parameter is ignored it will use the robot base frame.</span>
<span class="sd">        :type reference: :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.SolveIK`, :func:`~robolink.Item.SolveIK_All`, :func:`~robolink.Item.JointsConfig`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API (RoboDK starts if it has not started</span>
<span class="sd">            robot  = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)  # Retrieve the robot</span>

<span class="sd">            # get the current robot joints</span>
<span class="sd">            robot_joints = robot.Joints()</span>

<span class="sd">            # get the robot position from the joints (calculate forward kinematics)</span>
<span class="sd">            robot_position = robot.SolveFK(robot_joints)</span>

<span class="sd">            # get the robot configuration (robot joint state)</span>
<span class="sd">            robot_config = robot.JointsConfig(robot_joints)</span>

<span class="sd">            # calculate the new robot position</span>
<span class="sd">            new_robot_position = transl([x_move,y_move,z_move])*robot_position</span>

<span class="sd">            # calculate the new robot joints</span>
<span class="sd">            new_robot_joints = robot.SolveIK(new_robot_position)</span>
<span class="sd">            if len(new_robot_joints.tolist()) &lt; 6:</span>
<span class="sd">                print(&quot;No robot solution!! The new position is too far, out of reach or close to a singularity&quot;)</span>
<span class="sd">                continue</span>

<span class="sd">            # calculate the robot configuration for the new joints</span>
<span class="sd">            new_robot_config = robot.JointsConfig(new_robot_joints)</span>

<span class="sd">            if robot_config[0] != new_robot_config[0] or robot_config[1] != new_robot_config[1] or robot_config[2] != new_robot_config[2]:</span>
<span class="sd">                print(&quot;Warning! Robot configuration changed: this may lead to unextected movements!&quot;)</span>
<span class="sd">                print(robot_config)</span>
<span class="sd">                print(new_robot_config)</span>

<span class="sd">            # move the robot to the new position</span>
<span class="sd">            robot.MoveJ(new_robot_joints)</span>
<span class="sd">            #robot.MoveL(new_robot_joints)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_FK&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">pose</span> <span class="o">*</span> <span class="n">tool</span>
        <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">invH</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span> <span class="o">*</span> <span class="n">pose</span>
        <span class="k">return</span> <span class="n">pose</span></div>

<div class="viewcode-block" id="Item.JointsConfig"><a class="viewcode-back" href="../../robolink/#robolink.Item.JointsConfig">[docs]</a>    <span class="k">def</span> <span class="nf">JointsConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the robot configuration state for a set of robot joints.</span>
<span class="sd">        The configuration state is defined as: [REAR, LOWERARM, FLIP, turns]. The turns are reserved for future use.</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Retrieve all solutions for a given pose:</span>
<span class="sd">            all_solutions = robot.SolveIK_All(pose, toolpose, framepose)</span>
<span class="sd">            joints = []</span>

<span class="sd">            # Iterate through each solution</span>
<span class="sd">            for j in all_solutions:</span>
<span class="sd">                # Retrieve flags as a list for each solution</span>
<span class="sd">                conf_RLF = robot.JointsConfig(j).list()</span>

<span class="sd">                # Breakdown of flags:</span>
<span class="sd">                rear  = conf_RLF[0] # 1 if Rear , 0 if Front</span>
<span class="sd">                lower = conf_RLF[1] # 1 if Lower, 0 if Upper (elbow)</span>
<span class="sd">                flip  = conf_RLF[2] # 1 if Flip , 0 if Non flip (Flip is usually when Joint 5 is negative)</span>

<span class="sd">                # Look for a solution with Front and Elbow up configuration</span>
<span class="sd">                #if conf_RLF[0:2] == [0,0]:</span>
<span class="sd">                if rear == 0 and lower == 0:</span>
<span class="sd">                    print(&quot;Solution found!&quot;)</span>
<span class="sd">                    joints = j</span>
<span class="sd">                    break</span>


<span class="sd">        :param joints: robot joints</span>
<span class="sd">        :type joints: list of float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.SolveFK`, :func:`~robolink.Item.SolveIK`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_Thetas_Config&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span></div>

<div class="viewcode-block" id="Item.SolveIK"><a class="viewcode-back" href="../../robolink/#robolink.Item.SolveIK">[docs]</a>    <span class="k">def</span> <span class="nf">SolveIK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">,</span> <span class="n">joints_approx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the inverse kinematics for a given specified pose. The pose must be robot flange with respect to the robot base unless you provide the tool and/or reference.</span>
<span class="sd">        It returns the joints solution as a Mat object (size 1xnDOFs). Use list() on a Mat to convert to a list. If there is no solution it returns an array of size 0.</span>
<span class="sd">        If there is no solution it returns an empty matrix.</span>

<span class="sd">        :param pose: pose of the robot flange with respect to the robot base frame</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>
<span class="sd">        :param joints_approx: Preferred joint solution or robot configuration. Leave blank to return the closest match to the current robot position.</span>
<span class="sd">        :type joints_approx: list of float</span>
<span class="sd">        :param joints_approx: Tool pose with respect to the robot flange (TCP)</span>
<span class="sd">        :type joints_approx: :class:`robodk.Mat`</span>
<span class="sd">        :param joints_approx: Reference pose (reference frame with respect to the robot base)</span>
<span class="sd">        :type joints_approx: :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.SolveFK`, :func:`~robolink.Item.SolveIK_All`, :func:`~robolink.Item.JointsConfig`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">pose</span> <span class="o">*</span> <span class="n">robodk</span><span class="o">.</span><span class="n">invH</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">reference</span> <span class="o">*</span> <span class="n">pose</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">joints_approx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_IK&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_IK_jnts&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints_approx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints</span></div>

<div class="viewcode-block" id="Item.SolveIK_All"><a class="viewcode-back" href="../../robolink/#robolink.Item.SolveIK_All">[docs]</a>    <span class="k">def</span> <span class="nf">SolveIK_All</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">,</span> <span class="n">tool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the inverse kinematics for the specified robot and pose. The function returns all available joint solutions as a 2D matrix.</span>
<span class="sd">        Returns a list of joints as a 2D matrix (float x n x m)</span>

<span class="sd">        :param pose: pose of the robot flange with respect to the robot base frame</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.SolveFK`, :func:`~robolink.Item.SolveIK`, :func:`~robolink.Item.JointsConfig`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">pose</span> <span class="o">*</span> <span class="n">robodk</span><span class="o">.</span><span class="n">invH</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">reference</span> <span class="o">*</span> <span class="n">pose</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_IK_cmpl&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">joints_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">joints_list</span></div>

<div class="viewcode-block" id="Item.FilterTarget"><a class="viewcode-back" href="../../robolink/#robolink.Item.FilterTarget">[docs]</a>    <span class="k">def</span> <span class="nf">FilterTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">,</span> <span class="n">joints_approx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filters a target to improve accuracy. This option requires a calibrated robot.</span>
<span class="sd">        :param pose: pose of the robot TCP with respect to the robot reference frame</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>
<span class="sd">        :param joints_approx: approximated desired joints to define the preferred configuration</span>
<span class="sd">        :type joints_approx: list of float or :class:`robodk.Mat`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;FilterTarget&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">joints_approx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">joints_approx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints_approx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pose_filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
        <span class="n">joints_filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pose_filtered</span><span class="p">,</span> <span class="n">joints_filtered</span></div>

<div class="viewcode-block" id="Item.Connect"><a class="viewcode-back" href="../../robolink/#robolink.Item.Connect">[docs]</a>    <span class="k">def</span> <span class="nf">Connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot_ip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect to a real robot and wait for a connection to succeed. Returns 1 if connection succeeded, or 0 if it failed.</span>

<span class="sd">        :param robot_ip: Robot IP. Leave blank to use the IP selected in the connection panel of the robot.</span>
<span class="sd">        :type robot_ip: str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.ConnectSafe`, :func:`~robolink.Item.ConnectedState`, :func:`~robolink.Item.Disconnect`, :func:`~robolink.Robolink.setRunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Connect2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">robot_ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">blocking</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">status</span></div>

<div class="viewcode-block" id="Item.ConnectSafe"><a class="viewcode-back" href="../../robolink/#robolink.Item.ConnectSafe">[docs]</a>    <span class="k">def</span> <span class="nf">ConnectSafe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">robot_ip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">wait_connection</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">callback_abort</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect to a real robot and wait for a connection to succeed. Returns the connected state returned by ConnectedState() (0 if connection succeeded and the robot is ready).</span>

<span class="sd">        :param robot_ip: Robot IP. Leave blank to use the IP selected in the connection panel of the robot.</span>
<span class="sd">        :type robot_ip: str</span>
<span class="sd">        :param max_attempts: maximum connection attemps before reporting an unsuccessful connection</span>
<span class="sd">        :type max_attempts: int</span>
<span class="sd">        :param wait_connection: time to wait in seconds between connection attempts</span>
<span class="sd">        :type wait_connection: float</span>
<span class="sd">        :param callback_abort: function pointer that returns true if we should abort the connection operation</span>
<span class="sd">        :type callback_abort: function</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Connect`, :func:`~robolink.Item.ConnectedState`, :func:`~robolink.Robolink.setRunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Never attempt to reconnect if we are already connected</span>
        <span class="n">con_status</span><span class="p">,</span> <span class="n">status_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConnectedState</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">status_msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">con_status</span> <span class="o">==</span> <span class="n">ROBOTCOM_READY</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">con_status</span>

        <span class="n">trycount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">refresh_rate</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Connect</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">robodk</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
        <span class="n">timer1</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>
        <span class="n">robodk</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="n">refresh_rate</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Wait up to 2 seconds to see the connected state</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">con_status</span><span class="p">,</span> <span class="n">status_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConnectedState</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">status_msg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">con_status</span> <span class="o">==</span> <span class="n">ROBOTCOM_READY</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">con_status</span>

                <span class="k">if</span> <span class="n">callback_abort</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callback_abort</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">con_status</span>

                <span class="n">robodk</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="n">refresh_rate</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">con_status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trying to reconnect...&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">callback_abort</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callback_abort</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">con_status</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">refresh_rate</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Connect</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">robodk</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span> <span class="o">-</span> <span class="n">timer1</span> <span class="o">&gt;</span> <span class="n">wait_connection</span><span class="p">:</span>
                <span class="n">timer1</span> <span class="o">=</span> <span class="n">robodk</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>
                <span class="n">trycount</span> <span class="o">=</span> <span class="n">trycount</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">trycount</span> <span class="o">&gt;=</span> <span class="n">max_attempts</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to connect: Timed out&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">callback_abort</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callback_abort</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">con_status</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">refresh_rate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">con_status</span></div>

<div class="viewcode-block" id="Item.ConnectionParams"><a class="viewcode-back" href="../../robolink/#robolink.Item.ConnectionParams">[docs]</a>    <span class="k">def</span> <span class="nf">ConnectionParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the robot connection parameters</span>
<span class="sd">        :return: [robotIP (str), port (int), remote_path (str), FTP_user (str), FTP_pass (str)]</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setConnectionParams`, :func:`~robolink.Item.Connect`, :func:`~robolink.Item.ConnectSafe`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ConnectParams&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">robot_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">remote_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">ftp_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">ftp_pass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span></div>

<div class="viewcode-block" id="Item.setConnectionParams"><a class="viewcode-back" href="../../robolink/#robolink.Item.setConnectionParams">[docs]</a>    <span class="k">def</span> <span class="nf">setConnectionParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the robot connection parameters</span>

<span class="sd">        :param robot_ip: robot IP</span>
<span class="sd">        :type robot_ip: str</span>
<span class="sd">        :param port: robot communication port</span>
<span class="sd">        :type port: int</span>
<span class="sd">        :param remote_path: path to transfer files on the robot controller</span>
<span class="sd">        :type remote_path: str</span>
<span class="sd">        :param ftp_user: user name for the FTP connection</span>
<span class="sd">        :type ftp_user: str</span>
<span class="sd">        :param ftp_pass: password credential for the FTP connection</span>
<span class="sd">        :type ftp_pass: str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.ConnectionParams`, :func:`~robolink.Item.Connect`, :func:`~robolink.Item.ConnectSafe`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;setConnectParams&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">robot_ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">ftp_user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">ftp_pass</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.ConnectedState"><a class="viewcode-back" href="../../robolink/#robolink.Item.ConnectedState">[docs]</a>    <span class="k">def</span> <span class="nf">ConnectedState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check connection status with a real robobt</span>
<span class="sd">        Out 1 : status code -&gt; (int) ROBOTCOM_READY if the robot is ready to move, otherwise, status message will provide more information about the issue</span>
<span class="sd">        Out 2 : status message -&gt; Message description of the robot status</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.ConnectionParams`, :func:`~robolink.Item.Connect`, :func:`~robolink.Item.ConnectSafe`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            robot = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)   # Get the first robot available</span>
<span class="sd">            state = robot.Connect()</span>
<span class="sd">            print(state)</span>

<span class="sd">            # Check the connection status and message</span>
<span class="sd">            state, msg = robot.ConnectedState()</span>
<span class="sd">            print(state)</span>
<span class="sd">            print(msg)</span>
<span class="sd">            if state != ROBOTCOM_READY:</span>
<span class="sd">                print(&#39;Problems connecting: &#39; + robot.Name() + &#39;: &#39; + msg)</span>
<span class="sd">                quit()</span>

<span class="sd">            # Move the robot (real robot if we are connected)</span>
<span class="sd">            robot.MoveJ(jnts, False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ConnectedState&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">robotcom_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">status_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">robotcom_status</span><span class="p">,</span> <span class="n">status_msg</span></div>

<div class="viewcode-block" id="Item.Disconnect"><a class="viewcode-back" href="../../robolink/#robolink.Item.Disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">Disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disconnect from a real robot (when the robot driver is used)</span>
<span class="sd">        Returns 1 if it disconnected successfully, 0 if it failed. It can fail if it was previously disconnected manually for example.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Connect`, :func:`~robolink.Item.ConnectedState`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Disconnect&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">status</span></div>

<div class="viewcode-block" id="Item.MoveJ"><a class="viewcode-back" href="../../robolink/#robolink.Item.MoveJ">[docs]</a>    <span class="k">def</span> <span class="nf">MoveJ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move a robot to a specific target (&quot;Move Joint&quot; mode). This function waits (blocks) until the robot finishes its movements.</span>
<span class="sd">        If this is used with a program item, a new joint movement instruction will be added to the program.</span>
<span class="sd">        Important note when adding new movement instructions to programs: only target items supported, not poses.</span>

<span class="sd">        :param target: Target to move to. It can be the robot joints (Nx1 or 1xN), the pose (4x4) or a target (item pointer)</span>
<span class="sd">        :type target: :class:`robodk.Mat`, list of joints or :class:`.Item`</span>
<span class="sd">        :param blocking: Set to True to wait until the robot finished the movement (default=True). Set to false to make it a non blocking call. Tip: If set to False, use robot.Busy() to check if the robot is still moving.</span>
<span class="sd">        :type blocking: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveL`, :func:`~robolink.Item.MoveC`, :func:`~robolink.Item.SearchL`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ITEM_TYPE_PROGRAM</span><span class="p">:</span>
            <span class="n">blocking</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">==</span> <span class="n">Item</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMoveJ</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_moveX</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">blocking</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.MoveL"><a class="viewcode-back" href="../../robolink/#robolink.Item.MoveL">[docs]</a>    <span class="k">def</span> <span class="nf">MoveL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moves a robot to a specific target (&quot;Move Linear&quot; mode). This function waits (blocks) until the robot finishes its movements. This function can also be called on Programs and a new movement instruction will be added at the end of the program.</span>
<span class="sd">        If this is used with a program item, a new linear movement instruction will be added to the program.</span>
<span class="sd">        Important note when adding new movement instructions to programs: only target items supported, not poses.</span>

<span class="sd">        :param target: Target to move to. It can be the robot joints (Nx1 or 1xN), the pose (4x4) or a target (item pointer)</span>
<span class="sd">        :type target: :class:`robodk.Mat`, list of joints or :class:`.Item`</span>
<span class="sd">        :param blocking: Set to True to wait until the robot finished the movement (default=True). Set to false to make it a non blocking call. Tip: If set to False, use robot.Busy() to check if the robot is still moving.</span>
<span class="sd">        :type blocking: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveJ`, :func:`~robolink.Item.MoveC`, :func:`~robolink.Item.SearchL`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ITEM_TYPE_PROGRAM</span><span class="p">:</span>
            <span class="n">blocking</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">==</span> <span class="n">Item</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMoveL</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_moveX</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">blocking</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.SearchL"><a class="viewcode-back" href="../../robolink/#robolink.Item.SearchL">[docs]</a>    <span class="k">def</span> <span class="nf">SearchL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moves a robot to a specific target and stops when a specific input switch is detected (&quot;Search Linear&quot; mode). This function waits (blocks) until the robot finishes its movements.</span>

<span class="sd">        :param target: Target to move to. It can be the robot joints (Nx1 or 1xN), the pose (4x4) or a target (item pointer)</span>
<span class="sd">        :type target: :class:`robodk.Mat`, list of joints or :class:`.Item`</span>
<span class="sd">        :param blocking: Set to True to wait until the robot finished the movement (default=True). Set to false to make it a non blocking call. Tip: If set to False, use robot.Busy() to check if the robot is still moving.</span>
<span class="sd">        :type blocking: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveJ`, :func:`~robolink.Item.MoveL`, :func:`~robolink.Item.MoveC`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_moveX</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">blocking</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SimulatorJoints</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.MoveC"><a class="viewcode-back" href="../../robolink/#robolink.Item.MoveC">[docs]</a>    <span class="k">def</span> <span class="nf">MoveC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target1</span><span class="p">,</span> <span class="n">target2</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move a robot to a specific target (&quot;Move Circular&quot; mode). By default, this procedure waits (blocks) until the robot finishes the movement.</span>

<span class="sd">        :param target1: pose along the cicle movement</span>
<span class="sd">        :type target1: :class:`robodk.Mat`, list of joints or :class:`.Item`</span>
<span class="sd">        :param target2: final circle target</span>
<span class="sd">        :type target2: :class:`robodk.Mat`, list of joints or :class:`.Item`</span>
<span class="sd">        :param blocking: True if the instruction should wait until the robot finished the movement (default=True)</span>
<span class="sd">        :type blocking: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveL`, :func:`~robolink.Item.MoveC`, :func:`~robolink.Item.SearchL`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ITEM_TYPE_PROGRAM</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">target1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Item</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">target2</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Item</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;Adding a movement instruction to a program given joints or a pose is not supported. Use a target item instead, for example, add a target as with RDK.AddTarget(...) and set the pose or joints.&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addMoveC</span><span class="p">(</span><span class="n">target1</span><span class="p">,</span> <span class="n">target2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">MoveC</span><span class="p">(</span><span class="n">target1</span><span class="p">,</span> <span class="n">target2</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">blocking</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.MoveJ_Test"><a class="viewcode-back" href="../../robolink/#robolink.Item.MoveJ_Test">[docs]</a>    <span class="k">def</span> <span class="nf">MoveJ_Test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span><span class="p">,</span> <span class="n">minstep_deg</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if a joint movement is feasible and free of collisions (if collision checking is activated). The robot will moved to the collision point if a collision is detected (use Joints to collect the collision joints) or it will be placed at the destination joints if a collision is not detected.</span>

<span class="sd">        :param j1: start joints</span>
<span class="sd">        :type j1: list of float</span>
<span class="sd">        :param j2: end joints</span>
<span class="sd">        :type j2: list of float</span>
<span class="sd">        :param float minstep_deg: joint step in degrees</span>
<span class="sd">        :return: returns 0 if the movement is free of collision or any other issues. Otherwise it returns the number of pairs of objects that collided if there was a collision.</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveL_Test`, :func:`~robolink.Robolink.setCollisionActive`, :func:`~robolink.Item.MoveJ`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CollisionMove&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">j1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">j2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">minstep_deg</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># wait up to 1 hour</span>
        <span class="n">collision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">collision</span></div>

<div class="viewcode-block" id="Item.MoveL_Test"><a class="viewcode-back" href="../../robolink/#robolink.Item.MoveL_Test">[docs]</a>    <span class="k">def</span> <span class="nf">MoveL_Test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j1</span><span class="p">,</span> <span class="n">pose</span><span class="p">,</span> <span class="n">minstep_mm</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if a linear movement is feasible and free of collisions (if collision checking is activated). The robot will moved to the collision point if a collision is detected (use Joints to collect the collision joints) or it will be placed at the destination pose if a collision is not detected.</span>

<span class="sd">        :param j1: start joints</span>
<span class="sd">        :type j1: list of float</span>
<span class="sd">        :param pose: end pose (position of the active tool with respect to the active reference frame)</span>
<span class="sd">        :type pose: :class:`robodk.Mat`</span>
<span class="sd">        :param float minstep_mm: linear step in mm</span>
<span class="sd">        :return: returns 0 if the movement is free of collision or any other issues.</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        If the robot can not reach the target pose it returns -2. If the robot can reach the target but it can not make a linear movement it returns -1.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.MoveJ_Test`, :func:`~robolink.Item.setPoseFrame`, :func:`~robolink.Item.setPoseTool`, :func:`~robolink.Robolink.setCollisionActive`, :func:`~robolink.Item.MoveL`, :func:`~robolink.Robolink.AddTarget`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;CollisionMoveL&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">j1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">minstep_mm</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># wait up to 1 hour</span>
        <span class="n">collision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">collision</span></div>

<div class="viewcode-block" id="Item.setSpeed"><a class="viewcode-back" href="../../robolink/#robolink.Item.setSpeed">[docs]</a>    <span class="k">def</span> <span class="nf">setSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed_linear</span><span class="p">,</span> <span class="n">speed_joints</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">accel_linear</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">accel_joints</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the linear speed of a robot. Additional arguments can be provided to set linear acceleration or joint speed and acceleration.</span>

<span class="sd">        :param float speed_linear: linear speed -&gt; speed in mm/s (-1 = no change)</span>
<span class="sd">        :param float speed_joints: joint speed (optional) -&gt; acceleration in mm/s2 (-1 = no change)</span>
<span class="sd">        :param float accel_linear: linear acceleration (optional) -&gt; acceleration in mm/s2 (-1 = no change)</span>
<span class="sd">        :param float accel_joints: joint acceleration (optional) -&gt; acceleration in deg/s2 (-1 = no change)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setAcceleration`, :func:`~robolink.Item.setSpeedJoints`, :func:`~robolink.Item.setAccelerationJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_Speed4&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">speed_linear</span><span class="p">),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">speed_joints</span><span class="p">),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">accel_linear</span><span class="p">),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">accel_joints</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setAcceleration"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAcceleration">[docs]</a>    <span class="k">def</span> <span class="nf">setAcceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accel_linear</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the linear acceleration of a robot in mm/s2</span>

<span class="sd">        :param float accel_linear: acceleration in mm/s2</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setSpeed`, :func:`~robolink.Item.setSpeedJoints`, :func:`~robolink.Item.setAccelerationJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpeed</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">accel_linear</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setSpeedJoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.setSpeedJoints">[docs]</a>    <span class="k">def</span> <span class="nf">setSpeedJoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed_joints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the joint speed of a robot in deg/s for rotary joints and mm/s for linear joints</span>

<span class="sd">        :param float speed_joints: speed in deg/s for rotary joints and mm/s for linear joints</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setSpeed`, :func:`~robolink.Item.setAcceleration`, :func:`~robolink.Item.setAccelerationJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpeed</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">speed_joints</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setAccelerationJoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAccelerationJoints">[docs]</a>    <span class="k">def</span> <span class="nf">setAccelerationJoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accel_joints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the joint acceleration of a robot</span>

<span class="sd">        :param float accel_joints: acceleration in deg/s2 for rotary joints and mm/s2 for linear joints</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setSpeed`, :func:`~robolink.Item.setAcceleration`, :func:`~robolink.Item.setSpeedJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpeed</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">accel_joints</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setRounding"><a class="viewcode-back" href="../../robolink/#robolink.Item.setRounding">[docs]</a>    <span class="k">def</span> <span class="nf">setRounding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rounding_mm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the rounding accuracy to smooth the edges of corners. In general, it is recommended to allow a small approximation near the corners to maintain a constant speed.</span>
<span class="sd">        Setting a rounding values greater than 0 helps avoiding jerky movements caused by constant acceleration and decelerations.</span>

<span class="sd">        :param float rounding_mm: rounding accuracy in mm. Set to -1 (default) for best accuracy and to have point to point movements (might have a jerky behavior)</span>

<span class="sd">        This rounding parameter is also known as ZoneData (ABB), CNT (Fanuc), C_DIS/ADVANCE (KUKA), cornering (Mecademic) or blending (Universal Robots)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setSpeed`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ZoneData&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">rounding_mm</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Item.setZoneData"><a class="viewcode-back" href="../../robolink/#robolink.Item.setZoneData">[docs]</a>    <span class="k">def</span> <span class="nf">setZoneData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zonedata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.setRounding` instead.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRounding</span><span class="p">(</span><span class="n">zonedata</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.ShowSequence"><a class="viewcode-back" href="../../robolink/#robolink.Item.ShowSequence">[docs]</a>    <span class="k">def</span> <span class="nf">ShowSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">display_type</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Displays a sequence of joints or poses in RoboDK.</span>

<span class="sd">        :param matrix: list of joints as a matrix or as a list of joint arrays. A sequence of instructions is also supported (same sequence that was supported with RoKiSim).</span>
<span class="sd">        :type matrix: list of list of float or a matrix of joints as a :class:`robodk.Mat`&quot;&quot;&quot;</span>
        <span class="n">display_ghost_joints</span> <span class="o">=</span> <span class="n">display_type</span> <span class="o">&amp;</span> <span class="mi">2048</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">robodk</span><span class="o">.</span><span class="n">Mat</span> <span class="ow">or</span> <span class="n">display_ghost_joints</span>
        <span class="p">):</span>
            <span class="c1"># poses assumed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Show_SeqPoses&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="n">display_type</span><span class="p">,</span> <span class="n">timeout</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">display_ghost_joints</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">jnts</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">jnts</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># list of joints as a Mat assumed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Show_Seq&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Busy"><a class="viewcode-back" href="../../robolink/#robolink.Item.Busy">[docs]</a>    <span class="k">def</span> <span class="nf">Busy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if a robot or program is currently running (busy or moving).</span>
<span class="sd">        Returns a busy status (1=moving, 0=stopped)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.WaitMove`, :func:`~robolink.Item.RunProgram`, :func:`~robolink.Item.RunCodeCustom`, :func:`~robolink.Item.RunInstruction`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *      # import the robolink library</span>
<span class="sd">            from robodk import *</span>
<span class="sd">            RDK = Robolink()            # Connect to the RoboDK API</span>
<span class="sd">            prog = RDK.Item(&#39;MainProgram&#39;, ITEM_TYPE_PROGRAM)</span>
<span class="sd">            prog.RunProgram()</span>
<span class="sd">            while prog.Busy():</span>
<span class="sd">                pause(0.1)</span>

<span class="sd">            print(&quot;Program done&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;IsBusy&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">busy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">busy</span></div>

<div class="viewcode-block" id="Item.Stop"><a class="viewcode-back" href="../../robolink/#robolink.Item.Stop">[docs]</a>    <span class="k">def</span> <span class="nf">Stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop a program or a robot</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.RunProgram`, :func:`~robolink.Item.MoveJ`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Stop&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.WaitMove"><a class="viewcode-back" href="../../robolink/#robolink.Item.WaitMove">[docs]</a>    <span class="k">def</span> <span class="nf">WaitMove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">360000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Waits (blocks) until the robot finishes its movement.</span>

<span class="sd">        :param float timeout: Maximum time to wait for robot to finish its movement (in seconds)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Busy`, :func:`~robolink.Item.MoveJ`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;WaitMove&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>  <span class="c1"># will wait here</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span></div>
        <span class="c1"># busy = self.link.Is_Busy(self.item)</span>
        <span class="c1"># while busy:</span>
        <span class="c1">#    busy = self.link.Is_Busy(self.item)</span>

<div class="viewcode-block" id="Item.WaitFinished"><a class="viewcode-back" href="../../robolink/#robolink.Item.WaitFinished">[docs]</a>    <span class="k">def</span> <span class="nf">WaitFinished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until a program finishes or a robot completes its movement</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.Busy`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">Busy</span><span class="p">():</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.ProgramStart"><a class="viewcode-back" href="../../robolink/#robolink.Item.ProgramStart">[docs]</a>    <span class="k">def</span> <span class="nf">ProgramStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">programname</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">postprocessor</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Defines the name of the program when a program must be generated.</span>
<span class="sd">        It is possible to specify the name of the post processor as well as the folder to save the program.</span>
<span class="sd">        This method must be called before any program output is generated (before any robot movement or other program instructions).</span>

<span class="sd">        :param str progname: name of the program</span>
<span class="sd">        :param str folder: folder to save the program, leave empty to use the default program folder</span>
<span class="sd">        :param str postprocessor: name of the post processor (for a post processor in C:/RoboDK/Posts/Fanuc_post.py it is possible to provide &quot;Fanuc_post.py&quot; or simply &quot;Fanuc_post&quot;)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">ProgramStart</span><span class="p">(</span><span class="n">programname</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">postprocessor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.setAccuracyActive"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAccuracyActive">[docs]</a>    <span class="k">def</span> <span class="nf">setAccuracyActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accurate</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the accuracy of the robot active or inactive. A robot must have been calibrated to properly use this option.</span>

<span class="sd">        :param int accurate: set to 1 to use the accurate model or 0 to use the nominal model</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.AccuracyActive`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_AbsAccOn&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">accurate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.AccuracyActive"><a class="viewcode-back" href="../../robolink/#robolink.Item.AccuracyActive">[docs]</a>    <span class="k">def</span> <span class="nf">AccuracyActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accurate</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the accurate kinematics are being used. Accurate kinematics are available after a robot calibration.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setAccuracyActive`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_AbsAccOn&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">isaccurate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">isaccurate</span> <span class="o">&gt;</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Item.setParamRobotTool"><a class="viewcode-back" href="../../robolink/#robolink.Item.setParamRobotTool">[docs]</a>    <span class="k">def</span> <span class="nf">setParamRobotTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_mass</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">tool_cog</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the tool mass and center of gravity. This is only used with accurate robots to improve accuracy.</span>

<span class="sd">        :param float tool_mass: tool weigth in Kg</span>
<span class="sd">        :param list tool_cog: tool center of gravity as [x,y,z] with respect to the robot flange</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ParamCalibTool&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_mass</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tool_cog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">+=</span> <span class="n">tool_cog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.FilterProgram"><a class="viewcode-back" href="../../robolink/#robolink.Item.FilterProgram">[docs]</a>    <span class="k">def</span> <span class="nf">FilterProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filestr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter a program file to improve accuracy for a specific robot. The robot must have been previously calibrated.</span>
<span class="sd">        It returns 0 if the filter succeeded, or a negative value if there are filtering problems. It also returns a summary of the filtering.</span>

<span class="sd">        :param str filestr: File path of the program. Formats supported include: JBI (Motoman), SRC (KUKA), MOD (ABB), PRG (ABB), LS (FANUC).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;FilterProg2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">filestr</span><span class="p">)</span>
        <span class="n">filter_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">filter_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">filter_status</span><span class="p">,</span> <span class="n">filter_msg</span></div>

    <span class="c1"># &quot;&quot;&quot;Program item calls&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Item.MakeProgram"><a class="viewcode-back" href="../../robolink/#robolink.Item.MakeProgram">[docs]</a>    <span class="k">def</span> <span class="nf">MakeProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="n">RUNMODE_MAKE_ROBOTPROG</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the program file. Returns True if the program was successfully generated.</span>

<span class="sd">        :param str pathstr: Folder to save the program (not including the file name and extension). Make sure the folder ends with a slash. You can use backslashes or forward slashes to define the path. In most cases, the file name is defined by the program name (visible in the RoboDK tree) and the extension is defined by the Post Processor (the file extension must match the extension supported by your robot controller). It can be left empty to use the default action (save to the default programs location)</span>
<span class="sd">        :param run_mode: RUNMODE_MAKE_ROBOTPROG to generate the program file. Alternatively, Use RUNMODE_MAKE_ROBOTPROG_AND_UPLOAD or RUNMODE_MAKE_ROBOTPROG_AND_START to transfer the program through FTP and execute the program.</span>
<span class="sd">        :return: [success (True or False), log (str), transfer_succeeded (True/False)]</span>

<span class="sd">        Transfer succeeded is True if there was a successful program transfer (if RUNMODE_MAKE_ROBOTPROG_AND_UPLOAD or RUNMODE_MAKE_ROBOTPROG_AND_START are used)</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">folder_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;MakeProg2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">run_mode</span><span class="p">)</span>
        <span class="c1"># wait up to 5 minutes for the program to generate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">prog_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="n">prog_log_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">transfer_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">prog_status</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">transfer_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">transfer_status</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">transfer_ok</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="n">prog_log_str</span>

        <span class="k">return</span> <span class="n">success</span><span class="p">,</span> <span class="n">prog_log_str</span><span class="p">,</span> <span class="n">transfer_ok</span></div>

<div class="viewcode-block" id="Item.setRunType"><a class="viewcode-back" href="../../robolink/#robolink.Item.setRunType">[docs]</a>    <span class="k">def</span> <span class="nf">setRunType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program_run_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Run Type of a program to specify if a program made using the GUI will be run in simulation mode or on the real robot (&quot;Run on robot&quot; option).</span>

<span class="sd">        :param int program_run_type: Use &quot;PROGRAM_RUN_ON_SIMULATOR&quot; to set the program to run on the simulator only or &quot;PROGRAM_RUN_ON_ROBOT&quot; to force the program to run on the robot</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode` :func:`~robolink.Item.RunType`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ProgRunType&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">program_run_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.RunType"><a class="viewcode-back" href="../../robolink/#robolink.Item.RunType">[docs]</a>    <span class="k">def</span> <span class="nf">RunType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the Run Type of a program to specify if a program made using the GUI will be run in simulation mode or on the real robot (&quot;Run on robot&quot; option).</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.setRunMode` :func:`~robolink.Item.setRunType`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ProgRunType&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">program_run_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">program_run_type</span></div>

<div class="viewcode-block" id="Item.RunProgram"><a class="viewcode-back" href="../../robolink/#robolink.Item.RunProgram">[docs]</a>    <span class="k">def</span> <span class="nf">RunProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete. Use :func:`~robolink.Item.RunCode` instead. RunProgram is available for backwards compatibility.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RunCode</span><span class="p">(</span><span class="n">prog_parameters</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.RunCode"><a class="viewcode-back" href="../../robolink/#robolink.Item.RunCode">[docs]</a>    <span class="k">def</span> <span class="nf">RunCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run a program. It returns the number of instructions that can be executed successfully (a quick program check is performed before the program starts)</span>
<span class="sd">        This is a non-blocking call. Use program.Busy() to check if the program execution finished, or program.WaitFinished() to wait until the program finishes.</span>

<span class="sd">        :param prog_parameters: Program parameters can be provided for Python programs as a string</span>
<span class="sd">        :type prog_parameters: list of str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.RunCodeCustom`, :func:`~robolink.Item.Busy`, :func:`~robolink.Robolink.AddProgram`</span>

<span class="sd">        If setRunMode(RUNMODE_SIMULATE) is used: the program will be simulated (default run mode)</span>

<span class="sd">        If setRunMode(RUNMODE_RUN_ROBOT) is used: the program will run on the robot (default when RUNMODE_RUN_ROBOT is used)</span>

<span class="sd">        If setRunMode(RUNMODE_RUN_ROBOT) is used together with program.setRunType(PROGRAM_RUN_ON_ROBOT) -&gt; the program will run sequentially on the robot the same way as if we right clicked the program and selected &quot;Run on robot&quot; in the RoboDK GUI</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">prog_parameters</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunProgParam&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">prog_parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">param_i</span> <span class="ow">in</span> <span class="n">prog_parameters</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prog_parameters</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunProg&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">prog_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">prog_status</span></div>

<div class="viewcode-block" id="Item.RunCodeCustom"><a class="viewcode-back" href="../../robolink/#robolink.Item.RunCodeCustom">[docs]</a>    <span class="k">def</span> <span class="nf">RunCodeCustom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">run_type</span><span class="o">=</span><span class="n">INSTRUCTION_CALL_PROGRAM</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obsolete, use RunInstruction instead. Adds a program call, code, message or comment to the program. Returns 0 if succeeded.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.RunInstruction`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RunInstruction</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">run_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.RunInstruction"><a class="viewcode-back" href="../../robolink/#robolink.Item.RunInstruction">[docs]</a>    <span class="k">def</span> <span class="nf">RunInstruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">run_type</span><span class="o">=</span><span class="n">INSTRUCTION_CALL_PROGRAM</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a program call, code, message or comment to the program. Returns 0 if succeeded.</span>

<span class="sd">        :param str code: The code to insert, program to run, or comment to add.</span>
<span class="sd">        :param int run_type: Use INSTRUCTION_* variable to specify if the code is a program call or just a raw code insert. For example, to add a line of customized code use:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Available Instruction Types</span>

<span class="sd">            INSTRUCTION_CALL_PROGRAM = 0        # Program call</span>
<span class="sd">            INSTRUCTION_INSERT_CODE = 1         # Insert raw code in the generated program</span>
<span class="sd">            INSTRUCTION_START_THREAD = 2        # Start a new process</span>
<span class="sd">            INSTRUCTION_COMMENT = 3             # Add a comment in the code</span>
<span class="sd">            INSTRUCTION_SHOW_MESSAGE = 4        # Add a message</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.RunCode`, :func:`~robolink.Robolink.AddProgram`</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            program.RunInstruction(&#39;Setting the spindle speed&#39;, INSTRUCTION_COMMENT)</span>
<span class="sd">            program.RunInstruction(&#39;SetRPM(25000)&#39;, INSTRUCTION_INSERT_CODE)</span>
<span class="sd">            program.RunInstruction(&#39;Done setting the spindle speed. Ready to start!&#39;, INSTRUCTION_SHOW_MESSAGE)</span>
<span class="sd">            program.RunInstruction(&#39;Program1&#39;, INSTRUCTION_CALL_PROGRAM)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunCode2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;br&gt;&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">run_type</span><span class="p">)</span>
        <span class="n">prog_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">prog_status</span></div>

<div class="viewcode-block" id="Item.Pause"><a class="viewcode-back" href="../../robolink/#robolink.Item.Pause">[docs]</a>    <span class="k">def</span> <span class="nf">Pause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_ms</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pause instruction for a robot or insert a pause instruction to a program (when generating code offline -offline programming- or when connected to the robot -online programming-).</span>

<span class="sd">        :param float time_ms: time in miliseconds. Do not provide a value (leave the default -1) to pause until the user desires to resume the execution of a program.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;RunPause&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">time_ms</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setDO"><a class="viewcode-back" href="../../robolink/#robolink.Item.setDO">[docs]</a>    <span class="k">def</span> <span class="nf">setDO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_var</span><span class="p">,</span> <span class="n">io_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a Digital Output (DO). This command can also be used to set any generic variables to a desired value.</span>

<span class="sd">        :param io_var: Digital Output (string or number)</span>
<span class="sd">        :type io_var: str or int</span>
<span class="sd">        :param io_value: value</span>
<span class="sd">        :type io_value: str, int or float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.setAO`, :func:`~robolink.Item.getDI`, :func:`~robolink.Item.getAI`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;setDO&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_var</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.setAO"><a class="viewcode-back" href="../../robolink/#robolink.Item.setAO">[docs]</a>    <span class="k">def</span> <span class="nf">setAO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_var</span><span class="p">,</span> <span class="n">io_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set an Analog Output (AO).</span>

<span class="sd">        :param io_var: Analog Output (string or number)</span>
<span class="sd">        :type io_var: str or int</span>
<span class="sd">        :param io_value: value</span>
<span class="sd">        :type io_value: str, int or float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.setDO`, :func:`~robolink.Item.getDI`, :func:`~robolink.Item.getAI`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;setAO&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_var</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.getDI"><a class="viewcode-back" href="../../robolink/#robolink.Item.getDI">[docs]</a>    <span class="k">def</span> <span class="nf">getDI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_var</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a Digital Input (DI). This function is only useful when connected to a real robot using the robot driver. It returns a string related to the state of the Digital Input (1=True, 0=False). This function returns an empty string if the script is not executed on the robot.</span>

<span class="sd">        :param io_var: Digital Input (string or number)</span>
<span class="sd">        :type io_var: str or int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.getAI`, :func:`~robolink.Item.setDO`, :func:`~robolink.Item.setAO`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;getDI&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_var</span><span class="p">))</span>
        <span class="n">io_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">io_value</span></div>

<div class="viewcode-block" id="Item.getAI"><a class="viewcode-back" href="../../robolink/#robolink.Item.getAI">[docs]</a>    <span class="k">def</span> <span class="nf">getAI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_var</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an Analog Input (AI). This function is only useful when connected to a real robot using the robot driver. It returns a string related to the state of the Digital Input (0-1 or other range depending on the robot driver). This function returns an empty string if the script is not executed on the robot.</span>

<span class="sd">        :param io_var: Analog Input (string or number)</span>
<span class="sd">        :type io_var: str or int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.getDI`, :func:`~robolink.Item.setDO`, :func:`~robolink.Item.setAO`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;getAI&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_var</span><span class="p">))</span>
        <span class="n">io_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">io_value</span></div>

<div class="viewcode-block" id="Item.waitDI"><a class="viewcode-back" href="../../robolink/#robolink.Item.waitDI">[docs]</a>    <span class="k">def</span> <span class="nf">waitDI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_var</span><span class="p">,</span> <span class="n">io_value</span><span class="p">,</span> <span class="n">timeout_ms</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait for an digital input io_var to attain a given value io_value. Optionally, a timeout can be provided.</span>

<span class="sd">        :param io_var: digital input (string or number)</span>
<span class="sd">        :type io_var: str or int</span>
<span class="sd">        :param io_value: value</span>
<span class="sd">        :type io_value: str, int or float</span>
<span class="sd">        :param timeout_ms: timeout in milliseconds</span>
<span class="sd">        :type timeout_ms: int or float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;waitDI&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_var</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">io_value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">timeout_ms</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span>  <span class="c1"># wait up to 1 week</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span></div>

<div class="viewcode-block" id="Item.customInstruction"><a class="viewcode-back" href="../../robolink/#robolink.Item.customInstruction">[docs]</a>    <span class="k">def</span> <span class="nf">customInstruction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path_run</span><span class="p">,</span> <span class="n">path_icon</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmd_run_on_robot</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a custom instruction. This instruction will execute a Python file or an executable file.</span>

<span class="sd">        :param name: digital input (string or number)</span>
<span class="sd">        :type name: str or int</span>
<span class="sd">        :param path_run: path to run (relative to RoboDK/bin folder or absolute path)</span>
<span class="sd">        :type path_run: str</span>
<span class="sd">        :param path_icon: icon path (relative to RoboDK/bin folder or absolute path)</span>
<span class="sd">        :type path_icon: str</span>
<span class="sd">        :param blocking: 1 if blocking, 0 if it is a non blocking executable trigger</span>
<span class="sd">        :type blocking: int</span>
<span class="sd">        :param cmd_run_on_robot: Command to run through the driver when connected to the robot</span>
<span class="sd">        :type cmd_run_on_robot: str</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;InsCustom2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">path_run</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">path_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">cmd_run_on_robot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">blocking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.addMoveJ"><a class="viewcode-back" href="../../robolink/#robolink.Item.addMoveJ">[docs]</a>    <span class="k">def</span> <span class="nf">addMoveJ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemtarget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new robot joint move instruction to a program. This function is obsolete. Use MoveJ instead.</span>

<span class="sd">        :param itemtarget: target item to move to</span>
<span class="sd">        :type itemtarget: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.MoveJ`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_INSMOVE&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemtarget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.addMoveL"><a class="viewcode-back" href="../../robolink/#robolink.Item.addMoveL">[docs]</a>    <span class="k">def</span> <span class="nf">addMoveL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemtarget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new linear move instruction to a program. This function is obsolete. Use MoveL instead.</span>

<span class="sd">        :param itemtarget: target item to move to</span>
<span class="sd">        :type itemtarget: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.MoveL`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_INSMOVE&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemtarget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.addMoveC"><a class="viewcode-back" href="../../robolink/#robolink.Item.addMoveC">[docs]</a>    <span class="k">def</span> <span class="nf">addMoveC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemtarget1</span><span class="p">,</span> <span class="n">itemtarget2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new circular move instruction to a program (This function is obsolete. Use MoveL instead.)</span>

<span class="sd">        :param itemtarget: target item to move to</span>
<span class="sd">        :type itemtarget: :class:`.Item`</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.MoveL`, :func:`~robolink.Item.MoveC`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Add_INSMOVEC&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemtarget1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="n">itemtarget2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.ShowInstructions"><a class="viewcode-back" href="../../robolink/#robolink.Item.ShowInstructions">[docs]</a>    <span class="k">def</span> <span class="nf">ShowInstructions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show or hide instruction items of a program in the RoboDK tree</span>

<span class="sd">        :param show: Set to True to show the instruction nodes, otherwise, set to False</span>
<span class="sd">        :type show: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.ShowTargets`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_ShowIns&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">show</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.ShowTargets"><a class="viewcode-back" href="../../robolink/#robolink.Item.ShowTargets">[docs]</a>    <span class="k">def</span> <span class="nf">ShowTargets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show or hide targets of a program in the RoboDK tree</span>

<span class="sd">        :param show: Set to False to remove the target item (the target is not deleted as it remains inside the program), otherwise, set to True to show the targets</span>
<span class="sd">        :type show: bool</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.ShowInstructions`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_ShowTargets&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">show</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.InstructionCount"><a class="viewcode-back" href="../../robolink/#robolink.Item.InstructionCount">[docs]</a>    <span class="k">def</span> <span class="nf">InstructionCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of instructions of a program.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_Nins&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">nins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nins</span></div>

<div class="viewcode-block" id="Item.InstructionSelect"><a class="viewcode-back" href="../../robolink/#robolink.Item.InstructionSelect">[docs]</a>    <span class="k">def</span> <span class="nf">InstructionSelect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Select an instruction in the program as a reference to add new instructions. New instructions will be added after the selected instruction. If no instruction ID is specified, the active instruction will be selected and returned.</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_SelIns&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">ins_id</span><span class="p">)</span>
        <span class="n">ins_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ins_id</span></div>

<div class="viewcode-block" id="Item.InstructionDelete"><a class="viewcode-back" href="../../robolink/#robolink.Item.InstructionDelete">[docs]</a>    <span class="k">def</span> <span class="nf">InstructionDelete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete an instruction of a program</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_DelIns&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">ins_id</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">success</span></div>

<div class="viewcode-block" id="Item.Instruction"><a class="viewcode-back" href="../../robolink/#robolink.Item.Instruction">[docs]</a>    <span class="k">def</span> <span class="nf">Instruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current program instruction or the instruction given the instruction id (if provided).</span>
<span class="sd">        It returns the following information about an instruction:</span>

<span class="sd">        * name: name of the instruction (displayed in the RoboDK tree)</span>
<span class="sd">        * instype: instruction type (INS_TYPE_*). For example, INS_TYPE_MOVE for a movement instruction.</span>
<span class="sd">        * movetype: type of movement for INS_TYPE_MOVE instructions: MOVE_TYPE_JOINT for joint moves, or MOVE_TYPE_LINEAR for linear moves</span>
<span class="sd">        * isjointtarget: 1 if the target is specified in the joint space, otherwise, the target is specified in the cartesian space (by the pose)</span>
<span class="sd">        * target: pose of the target as :class:`.Item`</span>
<span class="sd">        * joints: robot joints for that target</span>

<span class="sd">        :param ins_id: instruction id to return</span>
<span class="sd">        :type ins_id: int</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Robolink.setInstruction`, :func:`~robolink.Robolink.InstructionDelete`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_GIns&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">ins_id</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="n">instype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="n">movetype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">isjointtarget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">joints</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">instype</span> <span class="o">==</span> <span class="n">INS_TYPE_MOVE</span><span class="p">:</span>
            <span class="n">movetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="n">isjointtarget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_pose</span><span class="p">()</span>
            <span class="n">joints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">instype</span><span class="p">,</span> <span class="n">movetype</span><span class="p">,</span> <span class="n">isjointtarget</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">joints</span></div>

<div class="viewcode-block" id="Item.setInstruction"><a class="viewcode-back" href="../../robolink/#robolink.Item.setInstruction">[docs]</a>    <span class="k">def</span> <span class="nf">setInstruction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ins_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">instype</span><span class="p">,</span> <span class="n">movetype</span><span class="p">,</span> <span class="n">isjointtarget</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">joints</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a program instruction.</span>

<span class="sd">        :param ins_id: index of the instruction (0 for the first instruction, 1 for the second, and so on)</span>
<span class="sd">        :type ins_id: int</span>
<span class="sd">        :param name: Name of the instruction (displayed in the RoboDK tree)</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param instype: Type of instruction. INS_TYPE_*</span>
<span class="sd">        :type instype: int</span>
<span class="sd">        :param movetype: Type of movement if the instruction is a movement (MOVE_TYPE_JOINT or MOVE_TYPE_LINEAR)</span>
<span class="sd">        :type movetype: int</span>
<span class="sd">        :param isjointtarget: 1 if the target is defined in the joint space, otherwise it means it is defined in the cartesian space (by the pose)</span>
<span class="sd">        :type isjointtarget: int</span>
<span class="sd">        :param target: target pose</span>
<span class="sd">        :type target: :class:`robodk.Mat`</span>
<span class="sd">        :param joints: robot joints for the target</span>
<span class="sd">        :type joints: list of float</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`, :func:`~robolink.Item.Instruction`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Prog_SIns&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">ins_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">instype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">instype</span> <span class="o">==</span> <span class="n">INS_TYPE_MOVE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">movetype</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_int</span><span class="p">(</span><span class="n">isjointtarget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_pose</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span></div>

<div class="viewcode-block" id="Item.Update"><a class="viewcode-back" href="../../robolink/#robolink.Item.Update">[docs]</a>    <span class="k">def</span> <span class="nf">Update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">check_collisions</span><span class="o">=</span><span class="n">COLLISION_OFF</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">mm_step</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">deg_step</span><span class="o">=-</span><span class="mi">1</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates a program and returns the estimated time and the number of valid instructions.</span>
<span class="sd">        An update can also be applied to a robot machining project. The update is performed on the generated program.</span>

<span class="sd">        :param int check_collisions: Check collisions (COLLISION_ON -yes- or COLLISION_OFF -no-)</span>
<span class="sd">        :param int timeout_sec: Maximum time to wait for the update to complete (in seconds)</span>
<span class="sd">        :param float mm_step: Step in mm to split the program (-1 means default, as specified in Tools-Options-Motion)</span>
<span class="sd">        :param float deg_step: Step in deg to split the program (-1 means default, as specified in Tools-Options-Motion)</span>

<span class="sd">        :return: [valid_instructions, program_time, program_distance, valid_ratio, readable_msg]</span>

<span class="sd">        valid_instructions: The number of valid instructions</span>

<span class="sd">        program_time: Estimated cycle time (in seconds)</span>

<span class="sd">        program_distance: Estimated distance that the robot TCP will travel (in mm)</span>

<span class="sd">        valid_ratio: This is a ratio from [0.00 to 1.00] showing if the path can be fully completed without any problems (1.0 means the path 100% feasible) or</span>
<span class="sd">        valid_ratio is &lt;1.0 if there were problems along the path.</span>

<span class="sd">        valid_ratio will be &lt; 0 if Update is called on a machining project and the machining project can&#39;t be achieved successfully.</span>

<span class="sd">        readable_msg: a readable message as a string</span>

<span class="sd">        .. seealso:: :func:`~robolink.Robolink.AddProgram`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;Update2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">([</span><span class="n">check_collisions</span><span class="p">,</span> <span class="n">mm_step</span><span class="p">,</span> <span class="n">deg_step</span><span class="p">])</span>
        <span class="c1"># wait up to 1 hour user to hit OK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout_sec</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_array</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="n">readable_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="n">valid_instructions</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">program_time</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">program_distance</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">valid_program</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LAST_STATUS_MESSAGE</span> <span class="o">=</span> <span class="n">readable_msg</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">valid_instructions</span><span class="p">,</span>
            <span class="n">program_time</span><span class="p">,</span>
            <span class="n">program_distance</span><span class="p">,</span>
            <span class="n">valid_program</span><span class="p">,</span>
            <span class="n">readable_msg</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Item.InstructionList"><a class="viewcode-back" href="../../robolink/#robolink.Item.InstructionList">[docs]</a>    <span class="k">def</span> <span class="nf">InstructionList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of program instructions as an MxN matrix, where N is the number of instructions and M equals to 1 plus the number of robot axes. This is the equivalent sequence that used to be supported by RoKiSim.</span>
<span class="sd">        Tip: Use RDK.ShowSequence(matrix) to dipslay a joint list or a RoKiSim sequence of instructions.</span>

<span class="sd">        Out 1: Returns the matrix</span>

<span class="sd">        Out 2: Returns 0 if the program has no issues</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.ShowSequence`, :func:`~robolink.Item.InstructionListJoints`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ProgInsList&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">insmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">insmat</span><span class="p">,</span> <span class="n">errors</span></div>

<div class="viewcode-block" id="Item.InstructionListJoints"><a class="viewcode-back" href="../../robolink/#robolink.Item.InstructionListJoints">[docs]</a>    <span class="k">def</span> <span class="nf">InstructionListJoints</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mm_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">deg_step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">save_to_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">collision_check</span><span class="o">=</span><span class="n">COLLISION_OFF</span><span class="p">,</span>
        <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">time_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of joints an MxN matrix, where M is the number of robot axes plus 4 columns. Linear moves are rounded according to the smoothing parameter set inside the program.</span>

<span class="sd">        :param float mm_step: step in mm to split the linear movements</span>
<span class="sd">        :param float deg_step: step in deg to split the joint movements</span>
<span class="sd">        :param str save_to_file: (optional) save the result to a file as Comma Separated Values (CSV). If the file name is not provided it will return the matrix. If step values are very small, the returned matrix can be very large.</span>
<span class="sd">        :param int collision_check: (optional) check for collisions</span>
<span class="sd">        :param int flags: (optional) set to 1 to include the timings between movements, set to 2 to also include the joint speeds (deg/s), set to 3 to also include the accelerations, set to 4 to include all previous information and make the splitting time-based.</span>
<span class="sd">        :param float time_step: (optional) set the time step in seconds for time based calculation</span>
<span class="sd">        :return: [message (str), joint_list (:class:`~robodk.Mat`), status (int)]</span>

<span class="sd">        Outputs:</span>

<span class="sd">        * message (str): Returns a human readable error message (if any).</span>
<span class="sd">        * joint_list (:class:`~robodk.Mat`): 2D matrix with all the joint information and corresponding information such as step, time stamp and speeds. Each entry is one column.</span>
<span class="sd">        It also returns the list of joints as [J1, J2, ..., Jn, ERROR, MM_STEP, DEG_STEP, MOVE_ID, TIME, X,Y,Z] or the file name if a file path is provided to save the result. Default units are MM and DEG.</span>
<span class="sd">        Use list(:class:`~robodk.Mat`) to extract each column in a list. The ERROR is returned as an int but it needs to be interpreted as a binary number.</span>

<span class="sd">        * status (int): Status is negative if there are program issues (singularity, axis limit, targets not properly defined or collision if activated). Otherwise it returns the number of instructions that can be successfully executed.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Error bit masks</span>

<span class="sd">            # If error is not 0, check the binary error using the following bit masks</span>
<span class="sd">            error_bin = int(str(ERROR),2)</span>
<span class="sd">            ERROR_KINEMATIC = 0b001             # One or more points in the path is not reachable</span>
<span class="sd">            ERROR_PATH_LIMIT = 0b010            # The path reached a joint axis limit</span>
<span class="sd">            ERROR_PATH_NEARSINGULARITY = 0b1000 # The robot is too close to a wrist singularity (J5). Lower the singularity tolerance to allow the robot to continue.</span>
<span class="sd">            ERROR_PATH_SINGULARITY = 0b100      # The robot reached a singularity point</span>
<span class="sd">            ERROR_COLLISION = 0b100000          # Collision detected</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.ShowSequence`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ProgJointList&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">mm_step</span><span class="p">,</span> <span class="n">deg_step</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">collision_check</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">time_step</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">joint_list</span> <span class="o">=</span> <span class="n">save_to_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_to_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">joint_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_matrix</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">save_to_file</span><span class="p">)</span>

        <span class="n">error_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">,</span> <span class="n">joint_list</span><span class="p">,</span> <span class="n">error_code</span></div>

<div class="viewcode-block" id="Item.getParam"><a class="viewcode-back" href="../../robolink/#robolink.Item.getParam">[docs]</a>    <span class="k">def</span> <span class="nf">getParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get custom binary data from this item. Use setParam to set the data.</span>

<span class="sd">        :param str param: Parameter name</span>

<span class="sd">        .. seealso:: :func:`~robolink.Item.setParam`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Setting custom binary data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;G_ItmDataParam&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_bytes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="Item.setParam"><a class="viewcode-back" href="../../robolink/#robolink.Item.setParam">[docs]</a>    <span class="k">def</span> <span class="nf">setParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a specific item parameter.</span>

<span class="sd">        Select **Tools-Run Script-Show Commands** to see all available commands for items and the station.</span>

<span class="sd">        Note: For parameters (commands) that require a JSON string value you can also provide a dict.</span>

<span class="sd">        :param str param: Parameter/command name</span>
<span class="sd">        :param str value: Parameter value (optional, not all commands require a value). If value is bytes it will store customized data to an item given the param name.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to expand or collapse an item in the tree</span>

<span class="sd">            from robolink import *</span>
<span class="sd">            import time</span>
<span class="sd">            RDK = Robolink()      # Start the RoboDK API</span>

<span class="sd">            # How to expand or collapse an item in the tree</span>
<span class="sd">            item = RDK.ItemUserPick(&quot;Select an item&quot;)</span>

<span class="sd">            item.setParam(&quot;Tree&quot;, &quot;Expand&quot;)</span>
<span class="sd">            time.sleep(2)</span>
<span class="sd">            item.setParam(&quot;Tree&quot;, &quot;Collapse&quot;)</span>


<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to change the post processor</span>

<span class="sd">            robot = RDK.ItemUserPick(&quot;Select a robot&quot;, ITEM_TYPE_ROBOT)</span>

<span class="sd">            # Set the robot post processor (name of the py file in the posts folder)</span>
<span class="sd">            robot.setParam(&quot;PostProcessor&quot;, &quot;Fanuc_RJ3&quot;)</span>


<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example to change display style</span>

<span class="sd">            # How to change the display style of an object (color as AARRGGBB):</span>
<span class="sd">            obj = RDK.ItemUserPick(&#39;Select an object to change the style&#39;, ITEM_TYPE_OBJECT)</span>

<span class="sd">            # Display points as simple dots given a certain size (suitable for fast rendering or large point clouds)</span>
<span class="sd">            # Color is defined as AARRGGBB</span>
<span class="sd">            obj.setValue(&#39;Display&#39;, &#39;POINTSIZE=4 COLOR=#FF771111&#39;)</span>

<span class="sd">            # Display each point as a cube of a given size in mm</span>
<span class="sd">            obj.setValue(&#39;Display&#39;,&#39;PARTICLE=CUBE(0.2,0.2,0.2) COLOR=#FF771111&#39;)</span>

<span class="sd">            # Another way to change display style of points to display as a sphere (size,rings):</span>
<span class="sd">            obj.setValue(&#39;Display&#39;,&#39;PARTICLE=SPHERE(4,8) COLOR=red&#39;)</span>

<span class="sd">            # Example to change the size of displayed curves:</span>
<span class="sd">            obj.setValue(&#39;Display&#39;,&#39;LINEW=4&#39;)</span>

<span class="sd">            # More examples to change the appearance of points and curves available here:</span>
<span class="sd">            https://github.com/RoboDK/Plug-In-Interface/tree/master/PluginAppLoader/Apps/SetStyle</span>


<span class="sd">        .. seealso:: :func:`~robolink.Item.getParam`, :func:`~robolink.Robolink.Command` (Robolink), :func:`~robolink.Robolink.setParam` (Robolink: station parameter)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">json</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="c1"># return dict if we provided a dict</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bytes</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># Setting custom binary data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;S_ItmDataParam&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_connection</span><span class="p">()</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;ICMD&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_item</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_send_line</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_rec_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">_check_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">line</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">TestGenericITem</span><span class="p">():</span>
        <span class="n">RDK</span> <span class="o">=</span> <span class="n">Robolink</span><span class="p">()</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">Command</span><span class="p">(</span><span class="s2">&quot;AddItem&quot;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="n">RDK</span><span class="p">,</span> <span class="n">ptr</span><span class="p">)</span>
        <span class="n">i</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s2">&quot;My Name&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">TestCamera</span><span class="p">():</span>
        <span class="n">RDK</span> <span class="o">=</span> <span class="n">Robolink</span><span class="p">()</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">AddFrame</span><span class="p">(</span><span class="s2">&quot;Ref&quot;</span><span class="p">)</span>
        <span class="n">prm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">Cam2D_Add</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">prm</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">TestCollision</span><span class="p">():</span>
        <span class="n">RDK</span> <span class="o">=</span> <span class="n">Robolink</span><span class="p">()</span>
        <span class="n">home</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">&quot;Home&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>

        <span class="n">cost</span> <span class="o">=</span> <span class="n">RDK</span><span class="o">.</span><span class="n">PluginCommand</span><span class="p">(</span>
            <span class="s2">&quot;CollisionFreePlanner&quot;</span><span class="p">,</span> <span class="s2">&quot;CostPtr&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">home</span><span class="o">.</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># in the future</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

    <span class="c1"># TestCamera()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Big Hero Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>