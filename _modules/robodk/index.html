<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>robodk &mdash; Roboticarm  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../" class="icon icon-home"> Roboticarm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/">main module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/">modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Roboticarm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../">Module code</a> &raquo;</li>
      <li>robodk</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for robodk</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2015-2020 - RoboDK Inc. - https://robodk.com/</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;)</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1"># http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="c1"># --------------------------------------------</span>
<span class="c1"># --------------- DESCRIPTION ----------------</span>
<span class="c1">#</span>
<span class="c1"># This is a robotics toolbox for RoboDK robot post processors and RoboDK API for Python</span>
<span class="c1"># This toolbox includes a simple matrix class for pose transofmrations (Mat)</span>
<span class="c1"># This toolbox has been inspired from Peter Corke&#39;s Robotics Toolbox:</span>
<span class="c1"># http://petercorke.com/wordpress/toolboxes/robotics-toolbox</span>
<span class="c1">#</span>
<span class="c1"># In this document: pose = transformation matrix = homogeneous matrix = 4x4 matrix</span>
<span class="c1">#</span>
<span class="c1"># More information about the RoboDK API for Python here:</span>
<span class="c1">#     https://robodk.com/doc/en/RoboDK-API.html</span>
<span class="c1">#     https://robodk.com/doc/en/PythonAPI/index.html</span>
<span class="c1">#</span>
<span class="c1"># More information about RoboDK post processors here:</span>
<span class="c1">#     https://robodk.com/help#PostProcessor</span>
<span class="c1">#</span>
<span class="c1"># Visit the Matrix and Quaternions FAQ for more information about pose/homogeneous transformations</span>
<span class="c1">#     http://www.j3d.org/matrix_faq/matrfaq_latest.html</span>
<span class="c1"># --------------------------------------------</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># --------      Generic file usage     ---------------</span>

<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">time</span>


<div class="viewcode-block" id="searchfiles"><a class="viewcode-back" href="../../robodk/#robodk.searchfiles">[docs]</a><span class="k">def</span> <span class="nf">searchfiles</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">RoboDK</span><span class="se">\\</span><span class="s2">Library</span><span class="se">\\</span><span class="s2">*.rdk&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List the files in a directory with a given extension&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="k">return</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span></div>


<span class="c1"># def CurrentFile(file = __file__):</span>
<span class="c1">#    &quot;&quot;&quot;Returns the current Python file being executed&quot;&quot;&quot;</span>
<span class="c1">#    return os.path.realpath(file)</span>


<div class="viewcode-block" id="getFileDir"><a class="viewcode-back" href="../../robodk/#robodk.getFileDir">[docs]</a><span class="k">def</span> <span class="nf">getFileDir</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the directory of a file path&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></div>


<div class="viewcode-block" id="getBaseName"><a class="viewcode-back" href="../../robodk/#robodk.getBaseName">[docs]</a><span class="k">def</span> <span class="nf">getBaseName</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the file name and extension of a file path&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></div>


<div class="viewcode-block" id="getFileName"><a class="viewcode-back" href="../../robodk/#robodk.getFileName">[docs]</a><span class="k">def</span> <span class="nf">getFileName</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the file name (with no extension) of a file path&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="DateModified"><a class="viewcode-back" href="../../robodk/#robodk.DateModified">[docs]</a><span class="k">def</span> <span class="nf">DateModified</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">stringformat</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the time that a file was modified&quot;&quot;&quot;</span>
    <span class="n">time_in_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stringformat</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">time_in_s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">time_in_s</span></div>


<div class="viewcode-block" id="DateCreated"><a class="viewcode-back" href="../../robodk/#robodk.DateCreated">[docs]</a><span class="k">def</span> <span class="nf">DateCreated</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">stringformat</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the time that a file was modified&quot;&quot;&quot;</span>
    <span class="n">time_in_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stringformat</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">time_in_s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">time_in_s</span></div>


<div class="viewcode-block" id="DirExists"><a class="viewcode-back" href="../../robodk/#robodk.DirExists">[docs]</a><span class="k">def</span> <span class="nf">DirExists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns true if the folder exists&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span></div>


<div class="viewcode-block" id="FileExists"><a class="viewcode-back" href="../../robodk/#robodk.FileExists">[docs]</a><span class="k">def</span> <span class="nf">FileExists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns true if the file exists&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>


<div class="viewcode-block" id="FilterName"><a class="viewcode-back" href="../../robodk/#robodk.FilterName">[docs]</a><span class="k">def</span> <span class="nf">FilterName</span><span class="p">(</span><span class="n">namefilter</span><span class="p">,</span> <span class="n">safechar</span><span class="o">=</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">reserved_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a safe program or variable name that can be used for robot programming&quot;&quot;&quot;</span>
    <span class="c1"># remove non accepted characters</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sa">r</span><span class="s2">&quot; -[]/\;,&gt;&lt;&amp;*:%=+@!#^|?^&quot;</span><span class="p">:</span>
        <span class="n">namefilter</span> <span class="o">=</span> <span class="n">namefilter</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># remove non english characters</span>
    <span class="n">char_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">namefilter</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">127</span><span class="p">)</span>
    <span class="n">namefilter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char_list</span><span class="p">)</span>

    <span class="c1"># Make sure we have a non empty string</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">namefilter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">namefilter</span> <span class="o">=</span> <span class="n">safechar</span>

    <span class="c1"># Make sure we don&#39;t start with a number</span>
    <span class="k">if</span> <span class="n">namefilter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">namefilter</span><span class="p">)</span>
        <span class="n">namefilter</span> <span class="o">=</span> <span class="n">safechar</span> <span class="o">+</span> <span class="n">namefilter</span>

    <span class="c1"># Make sure we are not using a reserved name</span>
    <span class="k">if</span> <span class="n">reserved_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">namefilter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">reserved_names</span><span class="p">:</span>
            <span class="n">namefilter</span> <span class="o">=</span> <span class="n">safechar</span> <span class="o">+</span> <span class="n">namefilter</span>

        <span class="c1"># Add the name to reserved names</span>
        <span class="n">reserved_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">namefilter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">namefilter</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># --------      Generic math usage     ---------------</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>


<div class="viewcode-block" id="pause"><a class="viewcode-back" href="../../robodk/#robodk.pause">[docs]</a><span class="k">def</span> <span class="nf">pause</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pause in seconds</span>

<span class="sd">    :param pause: time in seconds</span>
<span class="sd">    :type pause: float&quot;&quot;&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span></div>


<div class="viewcode-block" id="atan2"><a class="viewcode-back" href="../../robodk/#robodk.atan2">[docs]</a><span class="k">def</span> <span class="nf">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns angle of a 2D coordinate in the XY plane&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="sqrt"><a class="viewcode-back" href="../../robodk/#robodk.sqrt">[docs]</a><span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the square root of a value&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="sin"><a class="viewcode-back" href="../../robodk/#robodk.sin">[docs]</a><span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the sinus of an angle in radians&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="cos"><a class="viewcode-back" href="../../robodk/#robodk.cos">[docs]</a><span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the cosinus of an angle in radians&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="asin"><a class="viewcode-back" href="../../robodk/#robodk.asin">[docs]</a><span class="k">def</span> <span class="nf">asin</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the arc sinus in radians&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="acos"><a class="viewcode-back" href="../../robodk/#robodk.acos">[docs]</a><span class="k">def</span> <span class="nf">acos</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the arc cosinus in radians&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="name_2_id"><a class="viewcode-back" href="../../robodk/#robodk.name_2_id">[docs]</a><span class="k">def</span> <span class="nf">name_2_id</span><span class="p">(</span><span class="n">str_name_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the number of a numbered object. For example: &quot;Frame 3&quot; returns 3&quot;&quot;&quot;</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">str_name_id</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">number</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># --------     Generic matrix usage    ---------------</span>


<div class="viewcode-block" id="rotx"><a class="viewcode-back" href="../../robodk/#robodk.rotx">[docs]</a><span class="k">def</span> <span class="nf">rotx</span><span class="p">(</span><span class="n">rx</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a rotation matrix around the X axis (radians)</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        R_x(\theta) = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\</span>
<span class="sd">        0 &amp; c_\theta &amp; -s_\theta &amp; 0 \\</span>
<span class="sd">        0 &amp; s_\theta &amp; c_\theta &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 0 &amp; 1</span>
<span class="sd">        \end{bmatrix}</span>
<span class="sd">    </span>
<span class="sd">    :param float rx: rotation around X axis in radians</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :func:`~robodk.transl`, :func:`~robodk.roty`, :func:`~robodk.roty`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="o">-</span><span class="n">st</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="roty"><a class="viewcode-back" href="../../robodk/#robodk.roty">[docs]</a><span class="k">def</span> <span class="nf">roty</span><span class="p">(</span><span class="n">ry</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a rotation matrix around the Y axis (radians)</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        R_y(\theta) = \begin{bmatrix} c_\theta &amp; 0 &amp; s_\theta &amp; 0 \\</span>
<span class="sd">        0 &amp; 1 &amp; 0 &amp; 0 \\</span>
<span class="sd">        -s_\theta &amp; 0 &amp; c_\theta &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 0 &amp; 1</span>
<span class="sd">        \end{bmatrix}</span>
<span class="sd">    </span>
<span class="sd">    :param float ry: rotation around Y axis in radians</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ry</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ry</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">([[</span><span class="n">ct</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">st</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="rotz"><a class="viewcode-back" href="../../robodk/#robodk.rotz">[docs]</a><span class="k">def</span> <span class="nf">rotz</span><span class="p">(</span><span class="n">rz</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a rotation matrix around the Z axis (radians)</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        R_x(\theta) = \begin{bmatrix} c_\theta &amp; -s_\theta &amp; 0 &amp; 0 \\</span>
<span class="sd">        s_\theta &amp; c_\theta &amp; 0 &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 1 &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 0 &amp; 1</span>
<span class="sd">        \end{bmatrix}</span>
<span class="sd">    </span>
<span class="sd">    :param float ry: rotation around Y axis in radians</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.roty`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">([[</span><span class="n">ct</span><span class="p">,</span> <span class="o">-</span><span class="n">st</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">st</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="transl"><a class="viewcode-back" href="../../robodk/#robodk.transl">[docs]</a><span class="k">def</span> <span class="nf">transl</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a translation matrix (mm)</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        T(t_x, t_y, t_z) = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; t_x \\</span>
<span class="sd">        0 &amp; 1 &amp; 0 &amp; t_y \\</span>
<span class="sd">        0 &amp; 0 &amp; 1 &amp; t_z \\</span>
<span class="sd">        0 &amp; 0 &amp; 0 &amp; 1</span>
<span class="sd">        \end{bmatrix}</span>
<span class="sd">    </span>
<span class="sd">    :param float tx: translation along the X axis</span>
<span class="sd">    :param float ty: translation along the Y axis</span>
<span class="sd">    :param float tz: translation along the Z axis</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :func:`~robodk.rotx`, :func:`~robodk.roty`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zz</span> <span class="o">=</span> <span class="n">tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">tx</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">ty</span>
        <span class="n">zz</span> <span class="o">=</span> <span class="n">tz</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xx</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">yy</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">zz</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="RelTool"><a class="viewcode-back" href="../../robodk/#robodk.RelTool">[docs]</a><span class="k">def</span> <span class="nf">RelTool</span><span class="p">(</span><span class="n">target_pose</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates a relative target with respect to the tool coordinates. This procedure has exactly the same behavior as ABB&#39;s RelTool instruction.</span>
<span class="sd">    X,Y,Z are in mm, W,P,R are in degrees.</span>

<span class="sd">    :param float x: translation along the Tool X axis (mm)</span>
<span class="sd">    :param float y: translation along the Tool Y axis (mm)</span>
<span class="sd">    :param float z: translation along the Tool Z axis (mm)</span>
<span class="sd">    :param float rx: rotation around the Tool X axis (deg) (optional)</span>
<span class="sd">    :param float ry: rotation around the Tool Y axis (deg) (optional)</span>
<span class="sd">    :param float rz: rotation around the Tool Z axis (deg) (optional)</span>

<span class="sd">    .. seealso:: :func:`~robodk.Offset`, :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.roty`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">target_pose</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Mat</span><span class="p">:</span>
        <span class="n">target_pose</span> <span class="o">=</span> <span class="n">target_pose</span><span class="o">.</span><span class="n">Pose</span><span class="p">()</span>
    <span class="n">new_target</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">target_pose</span>
        <span class="o">*</span> <span class="n">transl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">rotx</span><span class="p">(</span><span class="n">rx</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">roty</span><span class="p">(</span><span class="n">ry</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">rotz</span><span class="p">(</span><span class="n">rz</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">new_target</span></div>


<div class="viewcode-block" id="Offset"><a class="viewcode-back" href="../../robodk/#robodk.Offset">[docs]</a><span class="k">def</span> <span class="nf">Offset</span><span class="p">(</span><span class="n">target_pose</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates a relative target with respect to the reference frame coordinates.</span>
<span class="sd">    X,Y,Z are in mm, RX,RY,RZ are in degrees.</span>

<span class="sd">    :param float x: translation along the Reference X axis (mm)</span>
<span class="sd">    :param float y: translation along the Reference Y axis (mm)</span>
<span class="sd">    :param float z: translation along the Reference Z axis (mm)</span>
<span class="sd">    :param float rx: rotation around the Reference X axis (deg) (optional)</span>
<span class="sd">    :param float ry: rotation around the Reference Y axis (deg) (optional)</span>
<span class="sd">    :param float rz: rotation around the Reference Z axis (deg) (optional)</span>

<span class="sd">    .. seealso:: :func:`~robodk.RelTool`, :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.roty`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">target_pose</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Mat</span><span class="p">:</span>
        <span class="c1"># item object assumed:</span>
        <span class="n">target_pose</span> <span class="o">=</span> <span class="n">target_pose</span><span class="o">.</span><span class="n">Pose</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_pose</span><span class="o">.</span><span class="n">isHomogeneous</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Pose matrix is not homogeneous!&quot;</span><span class="p">)</span>
    <span class="n">new_target</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">transl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">rotx</span><span class="p">(</span><span class="n">rx</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">roty</span><span class="p">(</span><span class="n">ry</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">rotz</span><span class="p">(</span><span class="n">rz</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">target_pose</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">new_target</span></div>


<div class="viewcode-block" id="point_Zaxis_2_pose"><a class="viewcode-back" href="../../robodk/#robodk.point_Zaxis_2_pose">[docs]</a><span class="k">def</span> <span class="nf">point_Zaxis_2_pose</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">,</span> <span class="n">yaxis_hint1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">yaxis_hint2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Returns a pose given the origin as a point, a Z axis and a preferred orientation for the Y axis&quot;&quot;&quot;</span>
    <span class="n">pose</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">pose</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="n">pose</span><span class="o">.</span><span class="n">setVZ</span><span class="p">(</span><span class="n">zaxis</span><span class="p">)</span>
    <span class="n">yaprox</span> <span class="o">=</span> <span class="n">yaxis_hint1</span>
    <span class="k">if</span> <span class="n">angle3</span><span class="p">(</span><span class="n">zaxis</span><span class="p">,</span> <span class="n">yaprox</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">yaprox</span> <span class="o">=</span> <span class="n">yaxis_hint2</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">cross</span><span class="p">(</span><span class="n">yaprox</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">))</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">zaxis</span><span class="p">,</span> <span class="n">xaxis</span><span class="p">)</span>
    <span class="n">pose</span><span class="o">.</span><span class="n">setVX</span><span class="p">(</span><span class="n">xaxis</span><span class="p">)</span>
    <span class="n">pose</span><span class="o">.</span><span class="n">setVY</span><span class="p">(</span><span class="n">yaxis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pose</span></div>


<div class="viewcode-block" id="eye"><a class="viewcode-back" href="../../robodk/#robodk.eye">[docs]</a><span class="k">def</span> <span class="nf">eye</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns the identity matrix</span>
<span class="sd">        </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        T(t_x, t_y, t_z) = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\</span>
<span class="sd">        0 &amp; 1 &amp; 0 &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 1 &amp; 0 \\</span>
<span class="sd">        0 &amp; 0 &amp; 0 &amp; 1</span>
<span class="sd">        \end{bmatrix}</span>
<span class="sd">        </span>
<span class="sd">    :param int size: square matrix size (4x4 Identity matrix by default, otherwise it is initialized to 0)</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.roty`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Mat</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">newmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">newmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">newmat</span></div>


<div class="viewcode-block" id="size"><a class="viewcode-back" href="../../robodk/#robodk.size">[docs]</a><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the size of a matrix (m,n).</span>
<span class="sd">    Dim can be set to 0 to return m (rows) or 1 to return n (columns)</span>

<span class="sd">    :param matrix: pose</span>
<span class="sd">    :type matrix: :class:`.Mat`</span>
<span class="sd">    :param dim: dimension</span>
<span class="sd">    :type dim: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span></div>


<div class="viewcode-block" id="tr"><a class="viewcode-back" href="../../robodk/#robodk.tr">[docs]</a><span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the transpose of the matrix</span>

<span class="sd">    :param matrix: pose</span>
<span class="sd">    :type matrix: :class:`.Mat`&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span></div>


<div class="viewcode-block" id="invH"><a class="viewcode-back" href="../../robodk/#robodk.invH">[docs]</a><span class="k">def</span> <span class="nf">invH</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the inverse of a homogeneous matrix</span>

<span class="sd">    :param matrix: pose</span>
<span class="sd">    :type matrix: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :func:`~robodk.transl`, :func:`~robodk.rotx`, :func:`~robodk.roty`, :func:`~robodk.rotz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">invH</span><span class="p">()</span></div>


<div class="viewcode-block" id="catV"><a class="viewcode-back" href="../../robodk/#robodk.catV">[docs]</a><span class="k">def</span> <span class="nf">catV</span><span class="p">(</span><span class="n">mat1</span><span class="p">,</span> <span class="n">mat2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Concatenate 2 matrices (vertical concatenation)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">mat1</span><span class="o">.</span><span class="n">catV</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span></div>


<div class="viewcode-block" id="catH"><a class="viewcode-back" href="../../robodk/#robodk.catH">[docs]</a><span class="k">def</span> <span class="nf">catH</span><span class="p">(</span><span class="n">mat1</span><span class="p">,</span> <span class="n">mat2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Concatenate 2 matrices (horizontal concatenation)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">mat1</span><span class="o">.</span><span class="n">catH</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span></div>


<div class="viewcode-block" id="tic"><a class="viewcode-back" href="../../robodk/#robodk.tic">[docs]</a><span class="k">def</span> <span class="nf">tic</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Start a stopwatch timer&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="k">global</span> <span class="n">TICTOC_START_TIME</span>
    <span class="n">TICTOC_START_TIME</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div>


<div class="viewcode-block" id="toc"><a class="viewcode-back" href="../../robodk/#robodk.toc">[docs]</a><span class="k">def</span> <span class="nf">toc</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Read the stopwatch timer&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="k">if</span> <span class="s2">&quot;TICTOC_START_TIME&quot;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">TICTOC_START_TIME</span>
        <span class="c1"># print(&quot;Elapsed time is &quot; + str(elapsed) + &quot; seconds.&quot;)</span>
        <span class="k">return</span> <span class="n">elapsed</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Toc: start time not set&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="LoadList"><a class="viewcode-back" href="../../robodk/#robodk.LoadList">[docs]</a><span class="k">def</span> <span class="nf">LoadList</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load data from a CSV file or a TXT file to a Python list (list of list of numbers)</span>

<span class="sd">    .. seealso:: :func:`~robodk.SaveList`, :func:`~robodk.LoadMat`</span>

<span class="sd">    Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            csvdata = LoadList(strfile, &#39;,&#39;)</span>
<span class="sd">            values = []</span>
<span class="sd">            for i in range(len(csvdata)):</span>
<span class="sd">                print(csvdata[i])</span>
<span class="sd">                values.append(csvdata[i])</span>

<span class="sd">            # We can also save the list back to a CSV file</span>
<span class="sd">            # SaveList(csvdata, strfile, &#39;,&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">todecimal</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="kn">import</span> <span class="nn">csv</span>
    <span class="kn">import</span> <span class="nn">codecs</span>

    <span class="c1"># Read all CSV data:</span>
    <span class="n">csvdata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># with open(strfile) as csvfile:</span>
    <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">csvread</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csvread</span><span class="p">:</span>
            <span class="n">row_nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">todecimal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
            <span class="n">csvdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_nums</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">csvdata</span></div>


<div class="viewcode-block" id="SaveList"><a class="viewcode-back" href="../../robodk/#robodk.SaveList">[docs]</a><span class="k">def</span> <span class="nf">SaveList</span><span class="p">(</span><span class="n">list_variable</span><span class="p">,</span> <span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a list or a list of lists as a CSV or TXT file.</span>

<span class="sd">    .. seealso:: :func:`~robodk.LoadList`, :func:`~robodk.LoadMat`&quot;&quot;&quot;</span>

    <span class="n">Mat</span><span class="p">(</span><span class="n">list_variable</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">SaveMat</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span></div>


<div class="viewcode-block" id="LoadMat"><a class="viewcode-back" href="../../robodk/#robodk.LoadMat">[docs]</a><span class="k">def</span> <span class="nf">LoadMat</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load data from a CSV file or a TXT file to a :class:`.Mat` Matrix</span>

<span class="sd">    .. seealso:: :func:`~robodk.LoadList`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span><span class="n">LoadList</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="p">))</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># ------ Pose to xyzrpw and xyzrpw to pose------------</span>
<div class="viewcode-block" id="pose_2_xyzrpw"><a class="viewcode-back" href="../../robodk/#robodk.pose_2_xyzrpw">[docs]</a><span class="k">def</span> <span class="nf">pose_2_xyzrpw</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the equivalent position (mm) and Euler angles (deg) as an [x,y,z,r,p,w] array, given a pose.</span>
<span class="sd">    It returns the values that correspond to the following operation:</span>
<span class="sd">    transl(x,y,z)*rotz(w*pi/180)*roty(p*pi/180)*rotx(r*pi/180)</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>
<span class="sd">    :return: [x,y,z,w,p,r] in mm and deg</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">]</span></div>


<div class="viewcode-block" id="xyzrpw_2_pose"><a class="viewcode-back" href="../../robodk/#robodk.xyzrpw_2_pose">[docs]</a><span class="k">def</span> <span class="nf">xyzrpw_2_pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the pose from the position (mm) and Euler angles (deg), given a [x,y,z,r,p,w] array.</span>
<span class="sd">    The result is the same as calling: H = transl(x,y,z)*rotz(w*pi/180)*roty(p*pi/180)*rotx(r*pi/180)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzrpw</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="n">ca</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">cb</span> <span class="o">*</span> <span class="n">cc</span><span class="p">,</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">-</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sc</span> <span class="o">+</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sb</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
            <span class="p">[</span><span class="n">cb</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">+</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">*</span> <span class="n">sc</span> <span class="o">-</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="n">sb</span><span class="p">,</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cb</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">H</span></div>


<div class="viewcode-block" id="Pose"><a class="viewcode-back" href="../../robodk/#robodk.Pose">[docs]</a><span class="k">def</span> <span class="nf">Pose</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the pose (:class:`.Mat`) given the position (mm) and Euler angles (deg) as an array [x,y,z,rx,ry,rz].</span>
<span class="sd">    The result is the same as calling: H = transl(x,y,z)*rotx(rx*pi/180)*roty(ry*pi/180)*rotz(rz*pi/180)</span>
<span class="sd">    This pose format is printed for homogeneous poses automatically. This Pose is the same representation used by Mecademic or Staubli robot controllers.</span>

<span class="sd">    :param float tx: position (X coordinate)</span>
<span class="sd">    :param float ty: position (Y coordinate)</span>
<span class="sd">    :param float tz: position (Z coordinate)</span>
<span class="sd">    :param float rx: first rotation (X coordinate)</span>
<span class="sd">    :param float ry: first rotation (Y coordinate)</span>
<span class="sd">    :param float rz: first rotation (Z coordinate)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TxyzRxyz_2_Pose</span><span class="p">([</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">rz</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">])</span></div>


<div class="viewcode-block" id="TxyzRxyz_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.TxyzRxyz_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">TxyzRxyz_2_Pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the pose given the position (mm) and Euler angles (rad) as an array [x,y,z,rx,ry,rz].</span>
<span class="sd">    The result is the same as calling: H = transl(x,y,z)*rotx(rx)*roty(ry)*rotz(rz)</span>

<span class="sd">    :param xyzrpw: [x,y,z,rx,ry,rz] in mm and radians</span>
<span class="sd">    :type xyzrpw: list of float</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzrpw</span>
    <span class="n">srx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">crx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">sry</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ry</span><span class="p">)</span>
    <span class="n">cry</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ry</span><span class="p">)</span>
    <span class="n">srz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">crz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">cry</span> <span class="o">*</span> <span class="n">crz</span><span class="p">,</span> <span class="o">-</span><span class="n">cry</span> <span class="o">*</span> <span class="n">srz</span><span class="p">,</span> <span class="n">sry</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
            <span class="p">[</span><span class="n">crx</span> <span class="o">*</span> <span class="n">srz</span> <span class="o">+</span> <span class="n">crz</span> <span class="o">*</span> <span class="n">srx</span> <span class="o">*</span> <span class="n">sry</span><span class="p">,</span> <span class="n">crx</span> <span class="o">*</span> <span class="n">crz</span> <span class="o">-</span> <span class="n">srx</span> <span class="o">*</span> <span class="n">sry</span> <span class="o">*</span> <span class="n">srz</span><span class="p">,</span> <span class="o">-</span><span class="n">cry</span> <span class="o">*</span> <span class="n">srx</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
            <span class="p">[</span><span class="n">srx</span> <span class="o">*</span> <span class="n">srz</span> <span class="o">-</span> <span class="n">crx</span> <span class="o">*</span> <span class="n">crz</span> <span class="o">*</span> <span class="n">sry</span><span class="p">,</span> <span class="n">crz</span> <span class="o">*</span> <span class="n">srx</span> <span class="o">+</span> <span class="n">crx</span> <span class="o">*</span> <span class="n">sry</span> <span class="o">*</span> <span class="n">srz</span><span class="p">,</span> <span class="n">crx</span> <span class="o">*</span> <span class="n">cry</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">H</span></div>


<div class="viewcode-block" id="Pose_2_TxyzRxyz"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_TxyzRxyz">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_TxyzRxyz</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve the position (mm) and Euler angles (rad) as an array [x,y,z,rx,ry,rz] given a pose.</span>
<span class="sd">    It returns the values that correspond to the following operation:</span>
<span class="sd">    H = transl(x,y,z)*rotx(rx)*roty(ry)*rotz(rz).</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">ry1</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">rx1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rz1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">ry1</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">rx1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rz1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sy</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">cy1</span> <span class="o">=</span> <span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sy</span> <span class="o">*</span> <span class="n">sy</span><span class="p">)</span>
        <span class="n">sx1</span> <span class="o">=</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span> <span class="n">cy1</span>
        <span class="n">cx1</span> <span class="o">=</span> <span class="n">e</span> <span class="o">/</span> <span class="n">cy1</span>
        <span class="n">sz1</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="n">cy1</span>
        <span class="n">cz1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">cy1</span>
        <span class="n">rx1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sx1</span><span class="p">,</span> <span class="n">cx1</span><span class="p">)</span>
        <span class="n">ry1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sy</span><span class="p">,</span> <span class="n">cy1</span><span class="p">)</span>
        <span class="n">rz1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sz1</span><span class="p">,</span> <span class="n">cz1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx1</span><span class="p">,</span> <span class="n">ry1</span><span class="p">,</span> <span class="n">rz1</span><span class="p">]</span></div>


<div class="viewcode-block" id="Pose_2_Staubli"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Staubli">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Staubli</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose (4x4 matrix) to a Staubli XYZWPR target</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyzwpr</span> <span class="o">=</span> <span class="n">Pose_2_TxyzRxyz</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzwpr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="k">return</span> <span class="n">xyzwpr</span></div>


<div class="viewcode-block" id="Pose_2_Motoman"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Motoman">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Motoman</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose (4x4 matrix) to a Motoman XYZWPR target (mm and deg)</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyzwpr</span> <span class="o">=</span> <span class="n">pose_2_xyzrpw</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xyzwpr</span></div>


<div class="viewcode-block" id="Pose_2_Fanuc"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Fanuc">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Fanuc</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose (4x4 matrix) to a Fanuc XYZWPR target (mm and deg)</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyzwpr</span> <span class="o">=</span> <span class="n">pose_2_xyzrpw</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xyzwpr</span></div>


<div class="viewcode-block" id="Pose_2_Techman"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Techman">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Techman</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose (4x4 matrix) to a Techman XYZWPR target (mm and deg)</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyzwpr</span> <span class="o">=</span> <span class="n">pose_2_xyzrpw</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xyzwpr</span></div>


<div class="viewcode-block" id="Motoman_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Motoman_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Motoman_2_Pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a Motoman target to a pose (4x4 matrix)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xyzrpw_2_pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">)</span></div>


<div class="viewcode-block" id="Fanuc_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Fanuc_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Fanuc_2_Pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a Motoman target to a pose (4x4 matrix)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xyzrpw_2_pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">)</span></div>


<div class="viewcode-block" id="Techman_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Techman_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Techman_2_Pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a Techman target to a pose (4x4 matrix)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xyzrpw_2_pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pose_2_KUKA"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_KUKA">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_KUKA</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose (4x4 matrix) to an XYZABC KUKA target (Euler angles), required by KUKA KRC controllers.</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">]</span></div>


<div class="viewcode-block" id="KUKA_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.KUKA_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">KUKA_2_Pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a KUKA XYZABC target to a pose (4x4 matrix), required by KUKA KRC controllers.</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzrpw</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">ca</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">cb</span> <span class="o">*</span> <span class="n">ca</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sc</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">-</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">sc</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">+</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sb</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
            <span class="p">[</span><span class="n">cb</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">+</span> <span class="n">sc</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sb</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">-</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="n">sb</span><span class="p">,</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">cb</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="Adept_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Adept_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Adept_2_Pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts an Adept XYZRPW target to a pose (4x4 matrix)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzrpw</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">ca</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">ca</span> <span class="o">*</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">-</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="o">-</span><span class="n">cc</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">-</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sb</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
            <span class="p">[</span><span class="n">ca</span> <span class="o">*</span> <span class="n">sc</span> <span class="o">+</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">sa</span><span class="p">,</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">-</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sb</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="n">cc</span> <span class="o">*</span> <span class="n">sb</span><span class="p">,</span> <span class="n">sb</span> <span class="o">*</span> <span class="n">sc</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="Pose_2_Adept"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Adept">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Adept</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose to an Adept target</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pi</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">sb</span> <span class="o">=</span> <span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cb</span> <span class="o">*</span> <span class="n">cb</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">sb</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">sb</span>
        <span class="n">sa</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">sb</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">sb</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span> <span class="n">ca</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">]</span></div>


<div class="viewcode-block" id="Comau_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Comau_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Comau_2_Pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a Comau XYZRPW target to a pose (4x4 matrix), the same representation required by PDL Comau programs.</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Adept_2_Pose</span><span class="p">(</span><span class="n">xyzrpw</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pose_2_Comau"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Comau">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Comau</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose to a Comau target, the same representation required by PDL Comau programs.</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Pose_2_Adept</span><span class="p">(</span><span class="n">H</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pose_2_Nachi"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_Nachi">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_Nachi</span><span class="p">(</span><span class="n">pose</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose to a Nachi XYZRPW target</span>

<span class="sd">    :param pose: pose</span>
<span class="sd">    :type pose: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">pose_2_xyzrpw</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span></div>


<div class="viewcode-block" id="Nachi_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.Nachi_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">Nachi_2_Pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a Nachi XYZRPW target to a pose (4x4 matrix)</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xyzrpw_2_pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">)</span></div>


<div class="viewcode-block" id="pose_2_quaternion"><a class="viewcode-back" href="../../robodk/#robodk.pose_2_quaternion">[docs]</a><span class="k">def</span> <span class="nf">pose_2_quaternion</span><span class="p">(</span><span class="n">Ti</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the quaternion orientation vector of a pose (4x4 matrix)</span>

<span class="sd">    :param Ti: pose</span>
<span class="sd">    :type Ti: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">sign2</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sign3</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sign4</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Ti</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sign2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Ti</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sign3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Ti</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ti</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sign4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="n">sign2</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">-</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">q3</span> <span class="o">=</span> <span class="n">sign3</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">q4</span> <span class="o">=</span> <span class="n">sign4</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">q4</span><span class="p">]</span></div>


<div class="viewcode-block" id="quaternion_2_pose"><a class="viewcode-back" href="../../robodk/#robodk.quaternion_2_pose">[docs]</a><span class="k">def</span> <span class="nf">quaternion_2_pose</span><span class="p">(</span><span class="n">qin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the pose orientation matrix (4x4 matrix) given a quaternion orientation vector</span>

<span class="sd">    :param list qin: quaternions as 4 float values</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">qnorm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">qin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">qin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">qin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">qin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">qin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">qin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">qin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">qin</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">qin</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">qnorm</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">qnorm</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">qnorm</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">qnorm</span>
    <span class="n">pose</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">pose</span></div>


<div class="viewcode-block" id="Pose_2_ABB"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_ABB">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_ABB</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a pose to an ABB target (using quaternion representation).</span>

<span class="sd">    :param H: pose</span>
<span class="sd">    :type H: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">pose_2_quaternion</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span></div>


<div class="viewcode-block" id="print_pose_ABB"><a class="viewcode-back" href="../../robodk/#robodk.print_pose_ABB">[docs]</a><span class="k">def</span> <span class="nf">print_pose_ABB</span><span class="p">(</span><span class="n">pose</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays an ABB RAPID target (the same way it is displayed in IRC5 controllers).</span>

<span class="sd">    :param pose: pose</span>
<span class="sd">    :type pose: :class:`.Mat`</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">pose_2_quaternion</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;[[</span><span class="si">%.3f</span><span class="s2">,</span><span class="si">%.3f</span><span class="s2">,</span><span class="si">%.3f</span><span class="s2">],[</span><span class="si">%.6f</span><span class="s2">,</span><span class="si">%.6f</span><span class="s2">,</span><span class="si">%.6f</span><span class="s2">,</span><span class="si">%.6f</span><span class="s2">]]&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="Pose_2_UR"><a class="viewcode-back" href="../../robodk/#robodk.Pose_2_UR">[docs]</a><span class="k">def</span> <span class="nf">Pose_2_UR</span><span class="p">(</span><span class="n">pose</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the p[x,y,z,u,v,w] position with rotation vector for a pose target. This is the same format required by Universal Robot controllers.</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">NUMERIC_TOLERANCE</span> <span class="o">=</span> <span class="mf">1e-8</span>

    <span class="k">def</span> <span class="nf">saturate_1</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="n">angle</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="n">saturate_1</span><span class="p">((</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="n">NUMERIC_TOLERANCE</span><span class="p">:</span>
        <span class="n">rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sin_angle</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sin_angle</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">NUMERIC_TOLERANCE</span><span class="p">:</span>
            <span class="n">d3</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
            <span class="n">mx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d3</span><span class="p">)</span>
            <span class="n">mx_id</span> <span class="o">=</span> <span class="n">d3</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mx_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="n">mx_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

            <span class="n">rxyz</span> <span class="o">=</span> <span class="n">mult3</span><span class="p">(</span><span class="n">rxyz</span><span class="p">,</span> <span class="n">angle</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">mx</span><span class="p">)))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rxyz</span> <span class="o">=</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">rxyz</span><span class="p">)</span>
            <span class="n">rxyz</span> <span class="o">=</span> <span class="n">mult3</span><span class="p">(</span><span class="n">rxyz</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">rxyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rxyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rxyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span></div>


<div class="viewcode-block" id="UR_2_Pose"><a class="viewcode-back" href="../../robodk/#robodk.UR_2_Pose">[docs]</a><span class="k">def</span> <span class="nf">UR_2_Pose</span><span class="p">(</span><span class="n">xyzwpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the pose target given a p[x,y,z,u,v,w] cartesian target with rotation vector. This is the same format required by Universal Robot controllers.</span>

<span class="sd">    .. seealso:: :class:`.Mat`, :func:`~robodk.TxyzRxyz_2_Pose`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">xyzwpr</span>
    <span class="n">wpr</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">wpr</span><span class="p">)</span>
    <span class="n">cosang</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">q234</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span> <span class="o">/</span> <span class="n">angle</span>
        <span class="n">q234</span> <span class="o">=</span> <span class="n">mult3</span><span class="p">(</span><span class="n">wpr</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span>

    <span class="n">q1234</span> <span class="o">=</span> <span class="p">[</span><span class="n">cosang</span><span class="p">,</span> <span class="n">q234</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q234</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q234</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">pose</span> <span class="o">=</span> <span class="n">quaternion_2_pose</span><span class="p">(</span><span class="n">q1234</span><span class="p">)</span>
    <span class="n">pose</span><span class="o">.</span><span class="n">setPos</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pose</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># -------- ROBOT MODEL (D-H and D-H M) ---------------</span>


<div class="viewcode-block" id="dh"><a class="viewcode-back" href="../../robodk/#robodk.dh">[docs]</a><span class="k">def</span> <span class="nf">dh</span><span class="p">(</span><span class="n">rz</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the Denavit-Hartenberg 4x4 matrix for a robot link.</span>
<span class="sd">    calling dh(rz,tx,tz,rx) is the same as using rotz(rz)*transl(tx,0,tx)*rotx(rx)</span>
<span class="sd">    calling dh(rz,tx,tz,rx) is the same as calling dh([rz,tx,tz,rx])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="p">[</span><span class="n">rz</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rz</span>

    <span class="n">crx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">srx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">crz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">srz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">crz</span><span class="p">,</span> <span class="o">-</span><span class="n">srz</span> <span class="o">*</span> <span class="n">crx</span><span class="p">,</span> <span class="n">srz</span> <span class="o">*</span> <span class="n">srx</span><span class="p">,</span> <span class="n">tx</span> <span class="o">*</span> <span class="n">crz</span><span class="p">],</span>
            <span class="p">[</span><span class="n">srz</span><span class="p">,</span> <span class="n">crz</span> <span class="o">*</span> <span class="n">crx</span><span class="p">,</span> <span class="o">-</span><span class="n">crz</span> <span class="o">*</span> <span class="n">srx</span><span class="p">,</span> <span class="n">tx</span> <span class="o">*</span> <span class="n">srz</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">srx</span><span class="p">,</span> <span class="n">crx</span><span class="p">,</span> <span class="n">tz</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="dhm"><a class="viewcode-back" href="../../robodk/#robodk.dhm">[docs]</a><span class="k">def</span> <span class="nf">dhm</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the Denavit-Hartenberg Modified 4x4 matrix for a robot link (Craig 1986).</span>

<span class="sd">    calling dhm(rx,tx,tz,rz) is the same as using rotx(rx)*transl(tx,0,tx)*rotz(rz)</span>

<span class="sd">    calling dhm(rx,tx,tz,rz) is the same as calling dhm([rx,tx,tz,rz])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="p">[</span><span class="n">rx</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rz</span><span class="p">]</span> <span class="o">=</span> <span class="n">rx</span>

    <span class="n">crx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">srx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="n">crz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">srz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">crz</span><span class="p">,</span> <span class="o">-</span><span class="n">srz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tx</span><span class="p">],</span>
            <span class="p">[</span><span class="n">crx</span> <span class="o">*</span> <span class="n">srz</span><span class="p">,</span> <span class="n">crx</span> <span class="o">*</span> <span class="n">crz</span><span class="p">,</span> <span class="o">-</span><span class="n">srx</span><span class="p">,</span> <span class="o">-</span><span class="n">tz</span> <span class="o">*</span> <span class="n">srx</span><span class="p">],</span>
            <span class="p">[</span><span class="n">srx</span> <span class="o">*</span> <span class="n">srz</span><span class="p">,</span> <span class="n">crz</span> <span class="o">*</span> <span class="n">srx</span><span class="p">,</span> <span class="n">crx</span><span class="p">,</span> <span class="n">tz</span> <span class="o">*</span> <span class="n">crx</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="joints_2_angles"><a class="viewcode-back" href="../../robodk/#robodk.joints_2_angles">[docs]</a><span class="k">def</span> <span class="nf">joints_2_angles</span><span class="p">(</span><span class="n">jin</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts the robot encoders into angles between links depending on the type of the robot.&quot;&quot;&quot;</span>
    <span class="n">jout</span> <span class="o">=</span> <span class="n">jin</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="n">jin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">jout</span></div>


<div class="viewcode-block" id="angles_2_joints"><a class="viewcode-back" href="../../robodk/#robodk.angles_2_joints">[docs]</a><span class="k">def</span> <span class="nf">angles_2_joints</span><span class="p">(</span><span class="n">jin</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts the angles between links into the robot motor space depending on the type of the robot.&quot;&quot;&quot;</span>
    <span class="n">jout</span> <span class="o">=</span> <span class="n">jin</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">jin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">jout</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">jin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">jout</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># -------- Useful geometric tools ---------------</span>


<div class="viewcode-block" id="norm"><a class="viewcode-back" href="../../robodk/#robodk.norm">[docs]</a><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the norm of a 3D vector&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></div>


<div class="viewcode-block" id="normalize3"><a class="viewcode-back" href="../../robodk/#robodk.normalize3">[docs]</a><span class="k">def</span> <span class="nf">normalize3</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the unitary vector&quot;&quot;&quot;</span>
    <span class="n">norminv</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">norminv</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">norminv</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">norminv</span><span class="p">]</span></div>


<div class="viewcode-block" id="cross"><a class="viewcode-back" href="../../robodk/#robodk.cross">[docs]</a><span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the cross product of two 3D vectors&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">c</span></div>


<div class="viewcode-block" id="dot"><a class="viewcode-back" href="../../robodk/#robodk.dot">[docs]</a><span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the dot product of two 3D vectors&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>


<div class="viewcode-block" id="angle3"><a class="viewcode-back" href="../../robodk/#robodk.angle3">[docs]</a><span class="k">def</span> <span class="nf">angle3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the angle in radians of two 3D vectors&quot;&quot;&quot;</span>
    <span class="n">cos_angle</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">normalize3</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="n">cos_angle</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cos_angle</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">cos_angle</span><span class="p">)</span></div>


<div class="viewcode-block" id="pose_angle"><a class="viewcode-back" href="../../robodk/#robodk.pose_angle">[docs]</a><span class="k">def</span> <span class="nf">pose_angle</span><span class="p">(</span><span class="n">pose</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the angle in radians of a 4x4 matrix pose</span>

<span class="sd">    :param pose: pose</span>
<span class="sd">    :type pose: :class:`.Mat`&quot;&quot;&quot;</span>
    <span class="n">cos_ang</span> <span class="o">=</span> <span class="p">(</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pose</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">cos_ang</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">cos_ang</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">cos_ang</span><span class="p">)</span></div>


<div class="viewcode-block" id="pose_angle_between"><a class="viewcode-back" href="../../robodk/#robodk.pose_angle_between">[docs]</a><span class="k">def</span> <span class="nf">pose_angle_between</span><span class="p">(</span><span class="n">pose1</span><span class="p">,</span> <span class="n">pose2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the angle in radians between two poses (4x4 matrix pose)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pose_angle</span><span class="p">(</span><span class="n">invH</span><span class="p">(</span><span class="n">pose1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pose2</span><span class="p">)</span></div>


<div class="viewcode-block" id="mult3"><a class="viewcode-back" href="../../robodk/#robodk.mult3">[docs]</a><span class="k">def</span> <span class="nf">mult3</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiplies a 3D vector to a scalar&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">]</span></div>


<div class="viewcode-block" id="subs3"><a class="viewcode-back" href="../../robodk/#robodk.subs3">[docs]</a><span class="k">def</span> <span class="nf">subs3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subtracts two 3D vectors c=a-b&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span></div>


<div class="viewcode-block" id="add3"><a class="viewcode-back" href="../../robodk/#robodk.add3">[docs]</a><span class="k">def</span> <span class="nf">add3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds two 3D vectors c=a+b&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span></div>


<div class="viewcode-block" id="distance"><a class="viewcode-back" href="../../robodk/#robodk.distance">[docs]</a><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the distance between two points&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">norm</span><span class="p">(</span><span class="n">subs3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="pose_is_similar"><a class="viewcode-back" href="../../robodk/#robodk.pose_is_similar">[docs]</a><span class="k">def</span> <span class="nf">pose_is_similar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the pose is similar. Returns True if both poses are less than 0.1 mm or 0.1 deg appart. Optionally provide the tolerance in mm+deg&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">distance</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Pos</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">Pos</span><span class="p">())</span> <span class="o">+</span> <span class="n">pose_angle_between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="intersect_line_2_plane"><a class="viewcode-back" href="../../robodk/#robodk.intersect_line_2_plane">[docs]</a><span class="k">def</span> <span class="nf">intersect_line_2_plane</span><span class="p">(</span><span class="n">pline</span><span class="p">,</span> <span class="n">vline</span><span class="p">,</span> <span class="n">pplane</span><span class="p">,</span> <span class="n">vplane</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the intersection betweeen a line and a plane&quot;&quot;&quot;</span>
    <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">dot</span><span class="p">(</span><span class="n">vplane</span><span class="p">,</span> <span class="n">pplane</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">vplane</span><span class="p">,</span> <span class="n">pline</span><span class="p">))</span> <span class="o">/</span> <span class="n">dot</span><span class="p">(</span><span class="n">vplane</span><span class="p">,</span> <span class="n">vline</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">add3</span><span class="p">(</span><span class="n">pline</span><span class="p">,</span> <span class="n">mult3</span><span class="p">(</span><span class="n">vline</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p</span></div>


<div class="viewcode-block" id="proj_pt_2_plane"><a class="viewcode-back" href="../../robodk/#robodk.proj_pt_2_plane">[docs]</a><span class="k">def</span> <span class="nf">proj_pt_2_plane</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">planepoint</span><span class="p">,</span> <span class="n">planeABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Projects a point to a plane&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">intersect_line_2_plane</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">planeABC</span><span class="p">,</span> <span class="n">planepoint</span><span class="p">,</span> <span class="n">planeABC</span><span class="p">)</span></div>


<div class="viewcode-block" id="proj_pt_2_line"><a class="viewcode-back" href="../../robodk/#robodk.proj_pt_2_line">[docs]</a><span class="k">def</span> <span class="nf">proj_pt_2_line</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">paxe</span><span class="p">,</span> <span class="n">vaxe</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Projects a point to a line&quot;&quot;&quot;</span>
    <span class="n">vpaxe2point</span> <span class="o">=</span> <span class="n">subs3</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">paxe</span><span class="p">)</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">vaxe</span><span class="p">,</span> <span class="n">vpaxe2point</span><span class="p">)</span> <span class="o">/</span> <span class="n">dot</span><span class="p">(</span><span class="n">vaxe</span><span class="p">,</span> <span class="n">vaxe</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add3</span><span class="p">(</span><span class="n">paxe</span><span class="p">,</span> <span class="n">mult3</span><span class="p">(</span><span class="n">vaxe</span><span class="p">,</span> <span class="n">dist</span><span class="p">))</span></div>


<div class="viewcode-block" id="fitPlane"><a class="viewcode-back" href="../../robodk/#robodk.fitPlane">[docs]</a><span class="k">def</span> <span class="nf">fitPlane</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Best fits a plane to a cloud of points&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">XYZ</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Set up constraint equations of the form  AB = 0,</span>
    <span class="c1"># where B is a column vector of the plane coefficients</span>
    <span class="c1"># in the form b(1)*X + b(2)*Y +b(3)*Z + b(4) = 0.</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">AB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">p</span><span class="p">])</span>
    <span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">AB</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># Solution is last column of v.</span>
    <span class="n">nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">nn</span>
    <span class="n">pplane</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
    <span class="n">vplane</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pplane</span><span class="p">,</span> <span class="n">vplane</span></div>


<span class="c1"># ----------------------------------------------------</span>
<span class="c1"># --------       Mat matrix class      ---------------</span>


<div class="viewcode-block" id="MatrixError"><a class="viewcode-back" href="../../robodk/#robodk.MatrixError">[docs]</a><span class="k">class</span> <span class="nc">MatrixError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exception class for Matrix&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="Mat"><a class="viewcode-back" href="../../robodk/#robodk.Mat">[docs]</a><span class="k">class</span> <span class="nc">Mat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mat is a matrix object. The main purpose of this object is to represent a pose in the 3D space (position and orientation).</span>

<span class="sd">    A pose is a 4x4 matrix that represents the position and orientation of one reference frame with respect to another one, in the 3D space.</span>

<span class="sd">    Poses are commonly used in robotics to place objects, reference frames and targets with respect to each other.</span>

<span class="sd">    .. seealso:: :func:`~robodk.TxyzRxyz_2_Pose`, :func:`~robodk.Pose_2_TxyzRxyz`, :func:`~robodk.Pose_2_ABB`, :func:`~robodk.Pose_2_Adept`, :func:`~robodk.Adept_2_Pose`, :func:`~robodk.Pose_2_Comau`, :func:`~robodk.Pose_2_Fanuc`, :func:`~robodk.Pose_2_KUKA`, :func:`~robodk.KUKA_2_Pose`, :func:`~robodk.Pose_2_Motoman`, :func:`~robodk.Pose_2_Nachi`, :func:`~robodk.Pose_2_Staubli`, :func:`~robodk.Pose_2_UR`, :func:`~robodk.quaternion_2_pose`</span>

<span class="sd">    Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from robolink import *                  # import the robolink library</span>
<span class="sd">            from robodk import *                    # import the robodk library</span>

<span class="sd">            RDK = Robolink()                        # connect to the RoboDK API</span>
<span class="sd">            robot  = RDK.Item(&#39;&#39;, ITEM_TYPE_ROBOT)  # Retrieve a robot available in RoboDK</span>
<span class="sd">            #target  = RDK.Item(&#39;Target 1&#39;)         # Retrieve a target (example)</span>


<span class="sd">            pose = robot.Pose()                     # retrieve the current robot position as a pose (position of the active tool with respect to the active reference frame)</span>
<span class="sd">            # target = target.Pose()                # the same can be applied to targets (taught position)</span>

<span class="sd">            # Read the 4x4 pose matrix as [X,Y,Z , A,B,C] Euler representation (mm and deg): same representation as KUKA robots</span>
<span class="sd">            XYZABC = Pose_2_KUKA(pose)</span>
<span class="sd">            print(XYZABC)</span>

<span class="sd">            # Read the 4x4 pose matrix as [X,Y,Z, q1,q2,q3,q4] quaternion representation (position in mm and orientation in quaternion): same representation as ABB robots (RAPID programming)</span>
<span class="sd">            xyzq1234 = Pose_2_ABB(pose)</span>
<span class="sd">            print(xyzq1234)</span>

<span class="sd">            # Read the 4x4 pose matrix as [X,Y,Z, u,v,w] representation (position in mm and orientation vector in radians): same representation as Universal Robots</span>
<span class="sd">            xyzuvw = Pose_2_UR(pose)</span>
<span class="sd">            print(xyzuvw)</span>

<span class="sd">            x,y,z,a,b,c = XYZABC                    # Use the KUKA representation (for example) and calculate a new pose based on the previous pose</span>
<span class="sd">            XYZABC2 = [x,y,z+50,a,b,c+45]</span>
<span class="sd">            pose2 = KUKA_2_Pose(XYZABC2)            # Convert the XYZABC array to a pose (4x4 matrix)</span>

<span class="sd">            robot.MoveJ(pose2)                      # Make a joint move to the new position</span>
<span class="sd">            # target.setPose(pose2)                  # We can also update the pose to targets, tools, reference frames, objects, ...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">Mat</span><span class="p">):</span>
                    <span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">rows</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
                <span class="n">transpose</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Check empty matrix</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[]]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">]</span>
                    <span class="n">transpose</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]):</span>  <span class="c1"># Validity check</span>
                    <span class="c1"># raise Exception(MatrixError, &quot;inconsistent row length&quot;)</span>
                    <span class="c1"># make the size uniform (fill blanks with zeros)</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                        <span class="n">row</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
                <span class="k">if</span> <span class="n">transpose</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>

<div class="viewcode-block" id="Mat.copy"><a class="viewcode-back" href="../../robodk/#robodk.Mat.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">newmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">newmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">newmat</span></div>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of columns&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<div class="viewcode-block" id="Mat.ColsCount"><a class="viewcode-back" href="../../robodk/#robodk.Mat.ColsCount">[docs]</a>    <span class="k">def</span> <span class="nf">ColsCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of coumns. Same as len().</span>

<span class="sd">        .. seealso:: :func:`~Mat.Cols`, :func:`~Mat.Rows`, :func:`~Mat.RowsCount`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Mat.RowsCount"><a class="viewcode-back" href="../../robodk/#robodk.Mat.RowsCount">[docs]</a>    <span class="k">def</span> <span class="nf">RowsCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of rows</span>

<span class="sd">        .. seealso:: :func:`~Mat.Cols`, :func:`~Mat.Rows`, :func:`~Mat.ColsCount`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Mat.Cols"><a class="viewcode-back" href="../../robodk/#robodk.Mat.Cols">[docs]</a>    <span class="k">def</span> <span class="nf">Cols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the matrix as a list of columns (list of list of float).</span>

<span class="sd">        .. seealso:: :func:`~Mat.Rows`, :func:`~Mat.ColsCount`, :func:`~Mat.RowsCount`</span>

<span class="sd">        Example:</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">                &gt;&gt;&gt; transl(10,20,30).Rows()</span>
<span class="sd">                [[1, 0, 0, 10], [0, 1, 0, 20], [0, 0, 1, 30], [0, 0, 0, 1]]</span>

<span class="sd">                &gt;&gt;&gt; transl(10,20,30).Cols()</span>
<span class="sd">                [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [10, 20, 30, 1]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">rows</span></div>

<div class="viewcode-block" id="Mat.Rows"><a class="viewcode-back" href="../../robodk/#robodk.Mat.Rows">[docs]</a>    <span class="k">def</span> <span class="nf">Rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the matrix as a list of lists</span>

<span class="sd">        .. seealso:: :func:`~Mat.Cols`, :func:`~Mat.ColsCount`, :func:`~Mat.RowsCount`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># integer A[1]</span>
            <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="c1"># one slice: A[1:3]</span>
            <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># two slices: A[1:3,1:3]</span>
            <span class="n">idx1</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">idx1</span><span class="p">][</span><span class="n">idx2</span><span class="p">]</span>
            <span class="n">matsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="n">indices1</span> <span class="o">=</span> <span class="n">idx1</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">matsize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">rg1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">indices1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># is int</span>
                <span class="n">rg1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="n">indices2</span> <span class="o">=</span> <span class="n">idx2</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">matsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">rg2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">indices2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># is int</span>
                <span class="n">rg2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># newm = int(abs((rg1.stop-rg1.start)/rg1.step))</span>
            <span class="c1"># newn = int(abs((rg2.stop-rg2.start)/rg2.step))</span>
            <span class="n">newm</span> <span class="o">=</span> <span class="n">rg1</span>
            <span class="n">newn</span> <span class="o">=</span> <span class="n">rg2</span>
            <span class="n">newmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">newm</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">newn</span><span class="p">))</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rg1</span><span class="p">:</span>
                <span class="n">cn</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">rg2</span><span class="p">:</span>
                    <span class="n">newmat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">cm</span><span class="p">][</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">newmat</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">([[</span><span class="n">item</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="n">matsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># integer A[1]</span>
            <span class="n">idx1</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># raise Exception(MatrixError, &quot;Cannot set item. Use [i,:] instead.&quot;)</span>
            <span class="c1"># self.rows[idx] = item</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="c1"># one slice: A[1:3]</span>
            <span class="c1"># raise Exception(MatrixError, &quot;Cannot set item. Use [a:b,:] instead.&quot;)</span>
            <span class="n">idx1</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx1</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># at this point we have two slices: example A[1:3,1:3]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">indices1</span> <span class="o">=</span> <span class="n">idx1</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">matsize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">rg1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">indices1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># is int</span>
            <span class="n">rg1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">indices2</span> <span class="o">=</span> <span class="n">idx2</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">matsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">rg2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">indices2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># is int</span>
            <span class="n">rg2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># newm = int(abs((rg1.stop-rg1.start)/rg1.step))</span>
        <span class="c1"># newn = int(abs((rg2.stop-rg2.start)/rg2.step))</span>
        <span class="n">newm</span> <span class="o">=</span> <span class="n">rg1</span>
        <span class="n">newn</span> <span class="o">=</span> <span class="n">rg2</span>
        <span class="n">itmsz</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">newm</span><span class="p">)</span> <span class="o">!=</span> <span class="n">itmsz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">newn</span><span class="p">)</span> <span class="o">!=</span> <span class="n">itmsz</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="n">MatrixError</span><span class="p">,</span>
                <span class="s2">&quot;Submatrix indices does not match the new matrix sizes&quot;</span><span class="p">,</span>
                <span class="n">itmsz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="n">itmsz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;&lt;-&quot;</span><span class="p">,</span>
                <span class="n">newm</span><span class="p">,</span>
                <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="n">newn</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1"># newmat = Mat(newm,newn)</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rg1</span><span class="p">:</span>
            <span class="n">cn</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">rg2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">cm</span><span class="p">][</span><span class="n">cn</span><span class="p">]</span>
                <span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># s=&#39;\n [ &#39;.join([(&#39;, &#39;.join([str(item) for item in row])+&#39; ],&#39;) for row in self.rows])</span>
        <span class="n">str_add</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isHomogeneous</span><span class="p">():</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span> <span class="o">=</span> <span class="n">Pose_2_TxyzRxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">str_add</span> <span class="o">=</span> <span class="s2">&quot;Pose(</span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">,  </span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">):</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="p">,</span>
                <span class="n">z</span><span class="p">,</span>
                <span class="n">rx</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>
                <span class="n">ry</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>
                <span class="n">rz</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> [ &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">item</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot; ],&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_add</span> <span class="o">+</span> <span class="s2">&quot;[[ &quot;</span> <span class="o">+</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;]</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="s2">&quot;Matrix: </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rep</span>

<div class="viewcode-block" id="Mat.tr"><a class="viewcode-back" href="../../robodk/#robodk.Mat.tr">[docs]</a>    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the transpose of the matrix&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">mat</span></div>

<div class="viewcode-block" id="Mat.size"><a class="viewcode-back" href="../../robodk/#robodk.Mat.size">[docs]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the size of a matrix (m,n).</span>
<span class="sd">        Dim can be set to 0 to return m (rows) or 1 to return n (columns)&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">dim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Invalid dimension!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.catV"><a class="viewcode-back" href="../../robodk/#robodk.Mat.catV">[docs]</a>    <span class="k">def</span> <span class="nf">catV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Concatenate with another matrix (vertical concatenation)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">Mat</span><span class="p">):</span>
            <span class="c1"># raise Exception(MatrixError, &quot;Concatenation must be performed with 2 matrices&quot;)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">catH</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">())</span>

        <span class="n">sz1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">sz2</span> <span class="o">=</span> <span class="n">mat2</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sz2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Horizontal size of matrices does not match&quot;</span><span class="p">)</span>

        <span class="n">newmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">sz1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sz2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">newmat</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">newmat</span><span class="p">[</span><span class="n">sz1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mat2</span>
        <span class="k">return</span> <span class="n">newmat</span></div>

<div class="viewcode-block" id="Mat.catH"><a class="viewcode-back" href="../../robodk/#robodk.Mat.catH">[docs]</a>    <span class="k">def</span> <span class="nf">catH</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Concatenate with another matrix (horizontal concatenation)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">Mat</span><span class="p">):</span>
            <span class="c1"># raise Exception(MatrixError, &quot;Concatenation must be performed with 2 matrices&quot;)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">catH</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="n">mat2</span><span class="p">))</span>

        <span class="n">sz1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">sz2</span> <span class="o">=</span> <span class="n">mat2</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sz2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Horizontal size of matrices does not match&quot;</span><span class="p">)</span>

        <span class="n">newmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">sz1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sz2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">newmat</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">newmat</span><span class="p">[:,</span> <span class="n">sz1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mat2</span>
        <span class="k">return</span> <span class="n">newmat</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test equality&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># return (other.rows == self.rows)</span>
        <span class="k">return</span> <span class="n">pose_is_similar</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a matrix to this matrix and</span>
<span class="sd">        return the new matrix. It doesn&#39;t modify</span>
<span class="sd">        the current matrix&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">mat</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sz</span> <span class="o">!=</span> <span class="n">mat</span><span class="o">.</span><span class="n">size</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Can not add matrices of sifferent sizes!&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">mat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">])]</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subtract a matrix from this matrix and</span>
<span class="sd">        return the new matrix. It doesn&#39;t modify</span>
<span class="sd">        the current matrix&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">mat</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sz</span> <span class="o">!=</span> <span class="n">mat</span><span class="o">.</span><span class="n">size</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Can not subtract matrices of sifferent sizes!&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">mat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">])]</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Multiply a matrix with this matrix and</span>
<span class="sd">        return the new matrix. It doesn&#39;t modify</span>
<span class="sd">        the current matrix&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">mulmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">mulmat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">mat</span>
            <span class="k">return</span> <span class="n">mulmat</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># case of a matrix times a vector</span>
            <span class="n">szvect</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">matvect</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">szvect</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">vectok</span> <span class="o">=</span> <span class="n">catV</span><span class="p">(</span><span class="n">matvect</span><span class="p">,</span> <span class="n">Mat</span><span class="p">([[</span><span class="mi">1</span><span class="p">]]))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">vectok</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">szvect</span> <span class="o">==</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">Mat</span><span class="p">(</span><span class="n">matvect</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Invalid product&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matm</span><span class="p">,</span> <span class="n">matn</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">matm</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="n">MatrixError</span><span class="p">,</span> <span class="s2">&quot;Matrices cannot be multipled (unexpected size)!&quot;</span>
                <span class="p">)</span>
            <span class="n">mat_t</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
            <span class="n">mulmat</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">matn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mat_t</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
                    <span class="n">mulmat</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">mat_t</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">y</span><span class="p">])]</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="n">mulmat</span>

<div class="viewcode-block" id="Mat.eye"><a class="viewcode-back" href="../../robodk/#robodk.Mat.eye">[docs]</a>    <span class="k">def</span> <span class="nf">eye</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make identity matrix of size (mxm)&quot;&quot;&quot;</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">Mat</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.isHomogeneous"><a class="viewcode-back" href="../../robodk/#robodk.Mat.isHomogeneous">[docs]</a>    <span class="k">def</span> <span class="nf">isHomogeneous</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns 1 if it is a Homogeneous matrix&quot;&quot;&quot;</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># if self[3,:] != Mat([[0.0,0.0,0.0,1.0]]):</span>
        <span class="c1">#    return False</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">test</span> <span class="o">*</span> <span class="n">test</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
        <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="n">test</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="n">zero</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">zero</span> <span class="o">=</span> <span class="n">zero</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">zero</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Mat.RelTool"><a class="viewcode-back" href="../../robodk/#robodk.Mat.RelTool">[docs]</a>    <span class="k">def</span> <span class="nf">RelTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates a target relative with respect to the tool coordinates.</span>
<span class="sd">        X,Y,Z are in mm, W,P,R are in degrees. The behavior of this function is the same as ABB&#39;s RAPID RelTool command.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RelTool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.Offset"><a class="viewcode-back" href="../../robodk/#robodk.Mat.Offset">[docs]</a>    <span class="k">def</span> <span class="nf">Offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates a relative target with respect to the reference frame coordinates.</span>
<span class="sd">        X,Y,Z are in mm, W,P,R are in degrees.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.invH"><a class="viewcode-back" href="../../robodk/#robodk.Mat.invH">[docs]</a>    <span class="k">def</span> <span class="nf">invH</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the inverse of this pose (homogeneous matrix assumed)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isHomogeneous</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="n">MatrixError</span><span class="p">,</span>
                <span class="s2">&quot;Pose matrix is not homogeneous. invH() can only compute the inverse of a homogeneous matrix&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">Hout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
        <span class="n">Hout</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="n">Hout</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Hout</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Hout</span></div>

<div class="viewcode-block" id="Mat.inv"><a class="viewcode-back" href="../../robodk/#robodk.Mat.inv">[docs]</a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the inverse of this pose (homogeneous matrix assumed)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">invH</span><span class="p">()</span></div>

<div class="viewcode-block" id="Mat.tolist"><a class="viewcode-back" href="../../robodk/#robodk.Mat.tolist">[docs]</a>    <span class="k">def</span> <span class="nf">tolist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first column of the matrix as a list&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Mat.list"><a class="viewcode-back" href="../../robodk/#robodk.Mat.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first column of the matrix as a list&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Mat.list2"><a class="viewcode-back" href="../../robodk/#robodk.Mat.list2">[docs]</a>    <span class="k">def</span> <span class="nf">list2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the matrix as list of lists (one list per column)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span></div>

<div class="viewcode-block" id="Mat.Pos"><a class="viewcode-back" href="../../robodk/#robodk.Mat.Pos">[docs]</a>    <span class="k">def</span> <span class="nf">Pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the position of a pose (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Mat.VX"><a class="viewcode-back" href="../../robodk/#robodk.Mat.VX">[docs]</a>    <span class="k">def</span> <span class="nf">VX</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the X vector of a pose (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Mat.VY"><a class="viewcode-back" href="../../robodk/#robodk.Mat.VY">[docs]</a>    <span class="k">def</span> <span class="nf">VY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Y vector of a pose (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Mat.VZ"><a class="viewcode-back" href="../../robodk/#robodk.Mat.VZ">[docs]</a>    <span class="k">def</span> <span class="nf">VZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Z vector of a pose (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Mat.Rot33"><a class="viewcode-back" href="../../robodk/#robodk.Mat.Rot33">[docs]</a>    <span class="k">def</span> <span class="nf">Rot33</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the sub 3x3 rotation matrix&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span></div>

<div class="viewcode-block" id="Mat.setPos"><a class="viewcode-back" href="../../robodk/#robodk.Mat.setPos">[docs]</a>    <span class="k">def</span> <span class="nf">setPos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newpos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the XYZ position of a pose (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">newpos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">newpos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">newpos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Mat.setVX"><a class="viewcode-back" href="../../robodk/#robodk.Mat.setVX">[docs]</a>    <span class="k">def</span> <span class="nf">setVX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_xyz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the VX vector of a pose, which is the first column of a homogeneous matrix (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="n">v_xyz</span> <span class="o">=</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">v_xyz</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Mat.setVY"><a class="viewcode-back" href="../../robodk/#robodk.Mat.setVY">[docs]</a>    <span class="k">def</span> <span class="nf">setVY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_xyz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the VY vector of a pose, which is the first column of a homogeneous matrix (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="n">v_xyz</span> <span class="o">=</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">v_xyz</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Mat.setVZ"><a class="viewcode-back" href="../../robodk/#robodk.Mat.setVZ">[docs]</a>    <span class="k">def</span> <span class="nf">setVZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_xyz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the VZ vector of a pose, which is the first column of a homogeneous matrix (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="n">v_xyz</span> <span class="o">=</span> <span class="n">normalize3</span><span class="p">(</span><span class="n">v_xyz</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Mat.translationPose"><a class="viewcode-back" href="../../robodk/#robodk.Mat.translationPose">[docs]</a>    <span class="k">def</span> <span class="nf">translationPose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the translation pose of this matrix. The rotation returned is set to identity (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">transl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Pos</span><span class="p">())</span></div>

<div class="viewcode-block" id="Mat.rotationPose"><a class="viewcode-back" href="../../robodk/#robodk.Mat.rotationPose">[docs]</a>    <span class="k">def</span> <span class="nf">rotationPose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the rotation pose of this matrix. The position returned is set to [0,0,0] (assumes that a 4x4 homogeneous matrix is being used)&quot;&quot;&quot;</span>
        <span class="n">mat_rotation</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">mat_rotation</span><span class="o">.</span><span class="n">setPos</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">mat_rotation</span></div>

<div class="viewcode-block" id="Mat.SaveCSV"><a class="viewcode-back" href="../../robodk/#robodk.Mat.SaveCSV">[docs]</a>    <span class="k">def</span> <span class="nf">SaveCSV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strfile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the :class:`.Mat` Matrix to a CSV (Comma Separated Values) file. The file can be easily opened as a spreadsheet such as Excel.</span>

<span class="sd">        .. seealso:: :func:`~Mat.SaveMat`, :func:`~robodk.SaveList`, :func:`~robodk.LoadList`, :func:`~robodk.LoadMat`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">.</span><span class="n">SaveMat</span><span class="p">(</span><span class="n">strfile</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.SaveMat"><a class="viewcode-back" href="../../robodk/#robodk.Mat.SaveMat">[docs]</a>    <span class="k">def</span> <span class="nf">SaveMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strfile</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the :class:`.Mat` Matrix to a CSV or TXT file</span>

<span class="sd">        .. seealso:: :func:`~Mat.SaveCSV`, :func:`~robodk.SaveList`, :func:`~robodk.LoadList`, :func:`~robodk.LoadMat`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">strfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%.6f</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">separator</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>


<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># FTP TRANSFER Tools</span>
<div class="viewcode-block" id="RemoveFileFTP"><a class="viewcode-back" href="../../robodk/#robodk.RemoveFileFTP">[docs]</a><span class="k">def</span> <span class="nf">RemoveFileFTP</span><span class="p">(</span><span class="n">ftp</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete a file on a remote server.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ftplib</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ftp</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">all_errors</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">sys</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Could not remove file </span><span class="si">{0}</span><span class="s2">: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<div class="viewcode-block" id="RemoveDirFTP"><a class="viewcode-back" href="../../robodk/#robodk.RemoveDirFTP">[docs]</a><span class="k">def</span> <span class="nf">RemoveDirFTP</span><span class="p">(</span><span class="n">ftp</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Recursively delete a directory tree on a remote server.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ftplib</span>

    <span class="n">wd</span> <span class="o">=</span> <span class="n">ftp</span><span class="o">.</span><span class="n">pwd</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">ftp</span><span class="o">.</span><span class="n">nlst</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">all_errors</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># some FTP servers complain when you try and list non-existent paths</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RemoveDirFTP: Could not remove folder </span><span class="si">{0}</span><span class="s2">: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RemoveDirFTP: Checking </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ftp</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># if we can cwd to it, it&#39;s a folder</span>
            <span class="n">ftp</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">wd</span><span class="p">)</span>  <span class="c1"># don&#39;t try a nuke a folder we&#39;re in</span>
            <span class="n">RemoveDirFTP</span><span class="p">(</span><span class="n">ftp</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">all_errors</span><span class="p">:</span>
            <span class="n">ftp</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
            <span class="c1"># RemoveFileFTP(ftp, name)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ftp</span><span class="o">.</span><span class="n">rmd</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">all_errors</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RemoveDirFTP: Could not remove </span><span class="si">{0}</span><span class="s2">: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span></div>


<div class="viewcode-block" id="UploadDirFTP"><a class="viewcode-back" href="../../robodk/#robodk.UploadDirFTP">[docs]</a><span class="k">def</span> <span class="nf">UploadDirFTP</span><span class="p">(</span><span class="n">localpath</span><span class="p">,</span> <span class="n">server_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upload a folder to a robot through FTP recursively&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ftplib</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="n">main_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">localpath</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;POPUP: &lt;p&gt;Connecting to &lt;strong&gt;</span><span class="si">%s</span><span class="s2">&lt;/strong&gt; using user name &lt;strong&gt;</span><span class="si">%s</span><span class="s2">&lt;/strong&gt; and password ****&lt;/p&gt;&lt;p&gt;Please wait...&lt;/p&gt;&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myFTP</span> <span class="o">=</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">FTP</span><span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connection established&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">error_str</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;POPUP: &lt;font color=&quot;red&quot;&gt;Connection to </span><span class="si">%s</span><span class="s1"> failed: &lt;p&gt;</span><span class="si">%s</span><span class="s1">&lt;/p&gt;&lt;/font&gt;&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">error_str</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">pause</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">remote_path_prog</span> <span class="o">=</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">main_folder</span>
    <span class="n">myPath</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">localpath</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Connected. Deleting existing files on </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">remote_path_prog</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">RemoveDirFTP</span><span class="p">(</span><span class="n">myFTP</span><span class="p">,</span> <span class="n">remote_path_prog</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Connected. Uploading program to </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">server_ip</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">mkd</span><span class="p">(</span><span class="n">main_folder</span><span class="p">)</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">remote_path_prog</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">error_str</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;POPUP: &lt;font color=&quot;red&quot;&gt;Remote path not found or can</span><span class="se">\&#39;</span><span class="s1">t be created: </span><span class="si">%s</span><span class="s1">&lt;/font&gt;&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">pause</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c1"># contin = mbox(&quot;Remote path\n%s\nnot found or can&#39;t create folder.\n\nChange path and permissions and retry.&quot; % remote_path)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">uploadThis</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Sending file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Sending file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
                <span class="n">myFTP</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s2">&quot;STOR </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
                <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Sending folder: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">myFTP</span><span class="o">.</span><span class="n">mkd</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">myFTP</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">uploadThis</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>

    <span class="n">uploadThis</span><span class="p">(</span><span class="n">myPath</span><span class="p">)</span>  <span class="c1"># now call the recursive function</span>
    <span class="n">myFTP</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;POPUP: Folder trasfer completed: &lt;font color=&quot;blue&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/font&gt;&#39;</span> <span class="o">%</span> <span class="n">remote_path</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="UploadFileFTP"><a class="viewcode-back" href="../../robodk/#robodk.UploadFileFTP">[docs]</a><span class="k">def</span> <span class="nf">UploadFileFTP</span><span class="p">(</span><span class="n">file_path_name</span><span class="p">,</span> <span class="n">server_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upload a file to a robot through FTP&quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">getFileDir</span><span class="p">(</span><span class="n">file_path_name</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">getBaseName</span><span class="p">(</span><span class="n">file_path_name</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">ftplib</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;POPUP: &lt;p&gt;Connecting to &lt;strong&gt;</span><span class="si">%s</span><span class="s2">&lt;/strong&gt; using user name &lt;strong&gt;</span><span class="si">%s</span><span class="s2">&lt;/strong&gt; and password ****&lt;/p&gt;&lt;p&gt;Please wait...&lt;/p&gt;&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myFTP</span> <span class="o">=</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">FTP</span><span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">error_str</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;POPUP: &lt;font color=&quot;red&quot;&gt;Connection to </span><span class="si">%s</span><span class="s1"> failed: &lt;p&gt;</span><span class="si">%s</span><span class="s1">&lt;/p&gt;&lt;/font&gt;&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">server_ip</span><span class="p">,</span> <span class="n">error_str</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">pause</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">remote_path_prog</span> <span class="o">=</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">filename</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Connected. Deleting remote file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">remote_path_prog</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">RemoveFileFTP</span><span class="p">(</span><span class="n">myFTP</span><span class="p">,</span> <span class="n">remote_path_prog</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Connected. Uploading program to </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">server_ip</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">error_str</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;POPUP: &lt;font color=&quot;red&quot;&gt;Remote path not found or can</span><span class="se">\&#39;</span><span class="s1">t be created: </span><span class="si">%s</span><span class="s1">&lt;/font&gt;&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">pause</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c1"># contin = mbox(&quot;Remote path\n%s\nnot found or can&#39;t create folder.\n\nChange path and permissions and retry.&quot; % remote_path)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">uploadThis</span><span class="p">(</span><span class="n">localfile</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Sending file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">localfile</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Sending file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">localfile</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">myFTP</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s2">&quot;STOR </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">uploadThis</span><span class="p">(</span><span class="n">file_path_name</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">myFTP</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s1">&#39;POPUP: File trasfer completed: &lt;font color=&quot;blue&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/font&gt;&#39;</span> <span class="o">%</span> <span class="n">remote_path_prog</span>
    <span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="UploadFTP"><a class="viewcode-back" href="../../robodk/#robodk.UploadFTP">[docs]</a><span class="k">def</span> <span class="nf">UploadFTP</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span><span class="p">,</span> <span class="n">pause_sec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upload a program or a list of programs to the robot through FTP provided the connection parameters&quot;&quot;&quot;</span>
    <span class="c1"># Iterate through program list if it is a list of files</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">program</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Nothing to transfer&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">pause</span><span class="p">(</span><span class="n">pause_sec</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">prog</span> <span class="ow">in</span> <span class="n">program</span><span class="p">:</span>
            <span class="n">UploadFTP</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;POPUP: &lt;font color=&quot;blue&quot;&gt;Done: </span><span class="si">%i</span><span class="s1"> files and folders successfully transferred&lt;/font&gt;&#39;</span>
            <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">pause</span><span class="p">(</span><span class="n">pause_sec</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Done&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="kn">import</span> <span class="nn">os</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sending program file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">program</span><span class="p">)</span>
        <span class="n">UploadFileFTP</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sending program folder </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">program</span><span class="p">)</span>
        <span class="n">UploadDirFTP</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">robot_ip</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">ftp_user</span><span class="p">,</span> <span class="n">ftp_pass</span><span class="p">)</span>

    <span class="n">pause</span><span class="p">(</span><span class="n">pause_sec</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POPUP: Done&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<span class="c1"># ------------------------------------------------------</span>
<span class="c1"># --------       TKinter dependencies    ---------------</span>
<span class="n">_tkinter_available</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="c1"># Python 2.X only:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">Tkinter</span> <span class="k">as</span> <span class="nn">tkinter</span>
        <span class="kn">import</span> <span class="nn">tkFileDialog</span> <span class="k">as</span> <span class="nn">filedialog</span>
        <span class="kn">import</span> <span class="nn">tkMessageBox</span> <span class="k">as</span> <span class="nn">messagebox</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">_tkinter_available</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Python 3.x only</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">tkinter</span>
        <span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span>
        <span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
    <span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
        <span class="n">_tkinter_available</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># ------------------</span>

<span class="c1"># ------------------</span>
<span class="k">if</span> <span class="n">_tkinter_available</span><span class="p">:</span>

<div class="viewcode-block" id="getOpenFile"><a class="viewcode-back" href="../../robodk/#robodk.getOpenFile">[docs]</a>    <span class="k">def</span> <span class="nf">getOpenFile</span><span class="p">(</span>
        <span class="n">path_preference</span><span class="o">=</span><span class="s2">&quot;C:/RoboDK/Library/&quot;</span><span class="p">,</span>
        <span class="n">strfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">strtitle</span><span class="o">=</span><span class="s2">&quot;Open file ...&quot;</span><span class="p">,</span>
        <span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
        <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Text files&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pop up a file dialog window to select a file to open. Returns a file object opened in read-only mode. Use returned value.name to retrieve the file path.&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialdir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_preference</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strtitle</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;defaultextension&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultextension</span>  <span class="c1">#&#39;.txt&#39;</span>
        <span class="n">options</span><span class="p">[</span>
            <span class="s2">&quot;filetypes&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">filetypes</span>  <span class="c1"># [(&#39;all files&#39;, &#39;.*&#39;), (&#39;text files&#39;, &#39;.txt&#39;)]</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strfile</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="c1"># same as: file_path = tkinter.filedialog.askopenfilename()</span>
        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="getSaveFile"><a class="viewcode-back" href="../../robodk/#robodk.getSaveFile">[docs]</a>    <span class="k">def</span> <span class="nf">getSaveFile</span><span class="p">(</span>
        <span class="n">path_preference</span><span class="o">=</span><span class="s2">&quot;C:/RoboDK/Library/&quot;</span><span class="p">,</span>
        <span class="n">strfile</span><span class="o">=</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span>
        <span class="n">strtitle</span><span class="o">=</span><span class="s2">&quot;Save file as ...&quot;</span><span class="p">,</span>
        <span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
        <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Text files&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pop up a file dialog window to select a file to save. Returns a file object opened in write-only mode. Use returned value.name to retrieve the file path.&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialdir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_preference</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strtitle</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;defaultextension&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultextension</span>  <span class="c1">#&#39;.txt&#39;</span>
        <span class="n">options</span><span class="p">[</span>
            <span class="s2">&quot;filetypes&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">filetypes</span>  <span class="c1"># [(&#39;all files&#39;, &#39;.*&#39;), (&#39;text files&#39;, &#39;.txt&#39;)]</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strfile</span>
        <span class="c1"># options[&#39;parent&#39;] = root</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfile</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="c1"># same as: file_path = tkinter.filedialog.asksaveasfile(**options)</span>
        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="getOpenFileName"><a class="viewcode-back" href="../../robodk/#robodk.getOpenFileName">[docs]</a>    <span class="k">def</span> <span class="nf">getOpenFileName</span><span class="p">(</span>
        <span class="n">path_preference</span><span class="o">=</span><span class="s2">&quot;C:/RoboDK/Library/&quot;</span><span class="p">,</span>
        <span class="n">strfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">strtitle</span><span class="o">=</span><span class="s2">&quot;Open file ...&quot;</span><span class="p">,</span>
        <span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
        <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Text files&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pop up a file dialog window to select a file to open. Returns the file path as a string.&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialdir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_preference</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strtitle</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;defaultextension&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultextension</span>  <span class="c1">#&#39;.txt&#39;</span>
        <span class="n">options</span><span class="p">[</span>
            <span class="s2">&quot;filetypes&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">filetypes</span>  <span class="c1"># [(&#39;all files&#39;, &#39;.*&#39;), (&#39;text files&#39;, &#39;.txt&#39;)]</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strfile</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="c1"># same as: file_path = tkinter.filedialog.askopenfilename()</span>
        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="getSaveFileName"><a class="viewcode-back" href="../../robodk/#robodk.getSaveFileName">[docs]</a>    <span class="k">def</span> <span class="nf">getSaveFileName</span><span class="p">(</span>
        <span class="n">path_preference</span><span class="o">=</span><span class="s2">&quot;C:/RoboDK/Library/&quot;</span><span class="p">,</span>
        <span class="n">strfile</span><span class="o">=</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span>
        <span class="n">strtitle</span><span class="o">=</span><span class="s2">&quot;Save file as ...&quot;</span><span class="p">,</span>
        <span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
        <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Text files&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pop up a file dialog window to select a file to save. Returns the file path as a string.&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialdir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_preference</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strtitle</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;defaultextension&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultextension</span>  <span class="c1">#&#39;.txt&#39;</span>
        <span class="n">options</span><span class="p">[</span>
            <span class="s2">&quot;filetypes&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">filetypes</span>  <span class="c1"># [(&#39;all files&#39;, &#39;.*&#39;), (&#39;text files&#39;, &#39;.txt&#39;)]</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strfile</span>
        <span class="c1"># options[&#39;parent&#39;] = root</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="c1"># same as: file_path = tkinter.filedialog.asksaveasfile(**options)</span>
        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="getSaveFolder"><a class="viewcode-back" href="../../robodk/#robodk.getSaveFolder">[docs]</a>    <span class="k">def</span> <span class="nf">getSaveFolder</span><span class="p">(</span>
        <span class="n">path_programs</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">popup_msg</span><span class="o">=</span><span class="s2">&quot;Select a directory to save your program&quot;</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ask the user to select a folder to save a program or other file. Returns the path of the folder as a string.&quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">(</span><span class="n">initialdir</span><span class="o">=</span><span class="n">path_programs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">popup_msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dirname</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">dirname</span></div>

<div class="viewcode-block" id="getOpenFolder"><a class="viewcode-back" href="../../robodk/#robodk.getOpenFolder">[docs]</a>    <span class="k">def</span> <span class="nf">getOpenFolder</span><span class="p">(</span><span class="n">path_preference</span><span class="o">=</span><span class="s2">&quot;C:/RoboDK/Library/&quot;</span><span class="p">,</span> <span class="n">strtitle</span><span class="o">=</span><span class="s2">&quot;Open folder ...&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pop up a folder dialog window to select a folder to open. Returns the path of the folder as a string.&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strtitle</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;initialdir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_preference</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="ShowMessage"><a class="viewcode-back" href="../../robodk/#robodk.ShowMessage">[docs]</a>    <span class="k">def</span> <span class="nf">ShowMessage</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show a blocking message&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">overrideredirect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>  <span class="c1"># , icon=&#39;warning&#39;)#, parent=texto)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="ShowMessageYesNo"><a class="viewcode-back" href="../../robodk/#robodk.ShowMessageYesNo">[docs]</a>    <span class="k">def</span> <span class="nf">ShowMessageYesNo</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show a blocking message and let the user answer Yes or No&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">overrideredirect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askyesno</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>  <span class="c1"># , icon=&#39;warning&#39;)#, parent=texto)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="ShowMessageYesNoCancel"><a class="viewcode-back" href="../../robodk/#robodk.ShowMessageYesNoCancel">[docs]</a>    <span class="k">def</span> <span class="nf">ShowMessageYesNoCancel</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show a blocking message and let the user answer Yes, No or Cancel&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">overrideredirect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askyesnocancel</span><span class="p">(</span>
            <span class="n">title</span><span class="p">,</span> <span class="n">msg</span>
        <span class="p">)</span>  <span class="c1"># , icon=&#39;warning&#39;)#, parent=texto)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="MessageBox"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox">[docs]</a>    <span class="k">class</span> <span class="nc">MessageBox</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>

            <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
            <span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Input&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="c1"># ctrl+c to copy self.msg</span>
            <span class="n">root</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Control-c&gt;&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_clip</span><span class="p">)</span>
            <span class="c1"># remove the outer frame if frame=False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">frame</span><span class="p">:</span>
                <span class="n">root</span><span class="o">.</span><span class="n">overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># default values for the buttons to return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b1_return</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b2_return</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># if b1 or b2 is a tuple unpack into the button text &amp; return value</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">b1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1_return</span> <span class="o">=</span> <span class="n">b1</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">b2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2_return</span> <span class="o">=</span> <span class="n">b2</span>
            <span class="c1"># main frame</span>
            <span class="n">frm_1</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
            <span class="n">frm_1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">ipadx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ipady</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># the message</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frm_1</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">message</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
            <span class="c1"># if entry=True create and set focus</span>
            <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frm_1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>
            <span class="c1"># button frame</span>
            <span class="n">frm_2</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frm_1</span><span class="p">)</span>
            <span class="n">frm_2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="c1"># buttons</span>
            <span class="n">btn_1</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frm_2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">b1</span><span class="p">)</span>
            <span class="n">btn_1</span><span class="p">[</span><span class="s2">&quot;command&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1_action</span>
            <span class="n">btn_1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">:</span>
                <span class="n">btn_1</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>
            <span class="n">btn_2</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frm_2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">b2</span><span class="p">)</span>
            <span class="n">btn_2</span><span class="p">[</span><span class="s2">&quot;command&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2_action</span>
            <span class="n">btn_2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="c1"># the enter button will trigger the focused button&#39;s action</span>
            <span class="n">btn_1</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyPress-Return&gt;&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b1_action</span><span class="p">)</span>
            <span class="n">btn_2</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;KeyPress-Return&gt;&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b2_action</span><span class="p">)</span>
            <span class="c1"># roughly center the box on screen</span>
            <span class="c1"># for accuracy see: http://stackoverflow.com/a/10018670/1217270</span>
            <span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
            <span class="n">xp</span> <span class="o">=</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">yp</span> <span class="o">=</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">(),</span> <span class="n">root</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">(),</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
            <span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">x</span><span class="si">{1}</span><span class="s2">+</span><span class="si">{2}</span><span class="s2">+</span><span class="si">{3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">geom</span><span class="p">))</span>
            <span class="c1"># call self.close_mod when the close button is pressed</span>
            <span class="n">root</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_mod</span><span class="p">)</span>
            <span class="c1"># a trick to activate the window (on windows 7)</span>
            <span class="c1"># root.deiconify()</span>
            <span class="c1"># if t is specified: call time_out after t seconds</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">:</span>
                <span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_out</span><span class="p">)</span>

<div class="viewcode-block" id="MessageBox.b1_action"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox.b1_action">[docs]</a>        <span class="k">def</span> <span class="nf">b1_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">returning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1_return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">returning</span> <span class="o">=</span> <span class="n">x</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

<div class="viewcode-block" id="MessageBox.b2_action"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox.b2_action">[docs]</a>        <span class="k">def</span> <span class="nf">b2_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">returning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2_return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

        <span class="c1"># remove this function and the call to protocol</span>
        <span class="c1"># then the close button will act normally</span>
<div class="viewcode-block" id="MessageBox.close_mod"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox.close_mod">[docs]</a>        <span class="k">def</span> <span class="nf">close_mod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="MessageBox.time_out"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox.time_out">[docs]</a>        <span class="k">def</span> <span class="nf">time_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">returning</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">returning</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

<div class="viewcode-block" id="MessageBox.to_clip"><a class="viewcode-back" href="../../robodk/#robodk.MessageBox.to_clip">[docs]</a>        <span class="k">def</span> <span class="nf">to_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">clipboard_clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">clipboard_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="mbox"><a class="viewcode-back" href="../../robodk/#robodk.mbox">[docs]</a>    <span class="k">def</span> <span class="nf">mbox</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">b1</span><span class="o">=</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">entry</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an instance of MessageBox, and get data back from the user.</span>

<span class="sd">        :param msg: string to be displayed</span>
<span class="sd">        :type msg: str</span>
<span class="sd">        :param b1: left button text, or a tuple (&lt;text for button&gt;, &lt;to return on press&gt;)</span>
<span class="sd">        :type b1: str, tuple</span>
<span class="sd">        :param b2: right button text, or a tuple (&lt;text for button&gt;, &lt;to return on press&gt;)</span>
<span class="sd">        :type b2: str, tuple</span>
<span class="sd">        :param frame: include a standard outerframe: True or False</span>
<span class="sd">        :type frame: bool</span>
<span class="sd">        :param t: time in seconds (int or float) until the msgbox automatically closes</span>
<span class="sd">        :type t: int, float</span>
<span class="sd">        :param entry: include an entry widget that will provide its contents returned. Provide text to fill the box</span>
<span class="sd">        :type entry: None, bool, str</span>

<span class="sd">        Example:</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">                name = mbox(&#39;Enter your name&#39;, entry=True)</span>
<span class="sd">                name = mbox(&#39;Enter your name&#39;, entry=&#39;default&#39;)</span>
<span class="sd">                if name:</span>
<span class="sd">                    print(&quot;Value: &quot; + name)</span>

<span class="sd">                value = mbox(&#39;Male or female?&#39;, (&#39;male&#39;, &#39;m&#39;), (&#39;female&#39;, &#39;f&#39;))</span>
<span class="sd">                mbox(&#39;Process done&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msgbox</span> <span class="o">=</span> <span class="n">MessageBox</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">robolink</span> <span class="kn">import</span> <span class="n">getPathIcon</span>

            <span class="n">iconpath</span> <span class="o">=</span> <span class="n">getPathIcon</span><span class="p">()</span>
            <span class="n">msgbox</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="n">iconpath</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RoboDK&#39;s Robolink module not found&quot;</span><span class="p">)</span>

        <span class="n">msgbox</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s2">&quot;-topmost&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">msgbox</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
        <span class="c1"># the function pauses here until the mainloop is quit</span>
        <span class="n">msgbox</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">msgbox</span><span class="o">.</span><span class="n">returning</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Big Hero Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>